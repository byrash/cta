{"ast":null,"code":"import Ids from 'ids';\nimport { isString, get, isNil, isObject, some, isNumber, set, findIndex, isArray, isDefined, values, uniqueBy, isFunction, bind, assign, groupBy, isUndefined } from 'min-dash';\nimport Big from 'big.js';\nimport classNames from 'classnames';\nimport { jsx, jsxs, Fragment } from 'preact/jsx-runtime';\nimport { useContext, useMemo, useRef, useCallback, useEffect, useState, useLayoutEffect } from 'preact/hooks';\nimport { createContext, createElement, Fragment as Fragment$1, render } from 'preact';\nimport isEqual from 'lodash/isEqual';\nimport flatpickr from 'flatpickr';\nimport * as React from 'preact/compat';\nimport { createPortal } from 'preact/compat';\nimport DOMPurify from 'dompurify';\nimport { Injector } from 'didi';\nimport { parseExpression, parseUnaryTests, evaluate, unaryTest } from 'feelin';\nimport { evaluate as evaluate$1, parser, buildSimpleTree } from 'feelers';\nimport showdown from 'showdown';\nconst getFlavouredFeelVariableNames = (feelString, feelFlavour = 'expression', options = {}) => {\n  const {\n    depth = 0,\n    specialDepthAccessors = {}\n  } = options;\n  if (!['expression', 'unaryTest'].includes(feelFlavour)) return [];\n  const tree = feelFlavour === 'expression' ? parseExpression(feelString) : parseUnaryTests(feelString);\n  const simpleExpressionTree = _buildSimpleFeelStructureTree(tree, feelString);\n  const variables = function _unfoldVariables(node) {\n    if (node.name === 'PathExpression') {\n      // if the path is built on top of a context, we process that context and\n      // ignore the rest of the path expression, as it is not relevant for variable extraction\n      const pathRoot = _linearizePathExpression(node)[0];\n      if (pathRoot.name === 'Context') {\n        return _unfoldVariables(pathRoot);\n      }\n      if (Object.keys(specialDepthAccessors).length === 0) {\n        return depth === 0 ? [_getVariableNameAtPathIndex(node, 0)] : [];\n      }\n\n      // if using special depth accessors, use a more complex extraction\n      return Array.from(_smartExtractVariableNames(node, depth, specialDepthAccessors));\n    }\n    if (depth === 0 && node.name === 'VariableName') return [node.variableName];\n\n    // for any other kind of node, traverse its children and flatten the result\n    if (node.children) {\n      const variables = node.children.reduce((acc, child) => {\n        return acc.concat(_unfoldVariables(child));\n      }, []);\n\n      // if we are within a filter context, we need to remove the item variable as it is used for iteration there\n      return node.name === 'FilterContext' ? variables.filter(name => name !== 'item') : variables;\n    }\n    return [];\n  }(simpleExpressionTree);\n  return [...new Set(variables)];\n};\n\n/**\n * Get the variable name at the specified index in a given path expression.\n *\n * @param {Object} root - The root node of the path expression tree.\n * @param {number} index - The index of the variable name to retrieve.\n * @returns {string|null} The variable name at the specified index or null if index is out of bounds.\n */\nconst _getVariableNameAtPathIndex = (root, index) => {\n  const nodes = _linearizePathExpression(root);\n  return nodes[index].variableName || null;\n};\n\n/**\n * Extracts the variables which are required of the external context for a given path expression.\n * This is done by traversing the path expression tree and keeping track of the current depth relative to the external context.\n *\n * @param {Object} node - The root node of the path expression tree.\n * @param {number} initialDepth - The depth at which the root node is located in the outer context.\n * @param {Object} specialDepthAccessors - Definitions of special keywords which represent more complex accesses of the outer context.\n * @returns {Set} - A set containing the extracted variable names.\n */\nconst _smartExtractVariableNames = (node, initialDepth, specialDepthAccessors) => {\n  // depth info represents the previous (initialised as null) and current depth of the current accessor in the path expression\n  // we track multiple of these to account for the fact that a path expression may be ambiguous due to special keywords\n  let accessorDepthInfos = [{\n    previous: null,\n    current: initialDepth - 1\n  }];\n  const extractedVariables = new Set();\n  const pathNodes = _linearizePathExpression(node);\n  for (let i = 0; i < pathNodes.length; i++) {\n    const currentAccessor = pathNodes[i].variableName;\n    if (currentAccessor in specialDepthAccessors) {\n      const depthOffsets = specialDepthAccessors[currentAccessor];\n\n      // if the current accessor is a special keyword, we need to expand the current depth info set\n      // this is done to account for the ambiguity of keywords like parent, which may be used to access\n      // the parent of the current node, or a child variable of the same name\n      accessorDepthInfos = depthOffsets.reduce((accumulator, offset) => {\n        return [...accumulator, ...accessorDepthInfos.map(depthInfo => ({\n          previous: depthInfo.current,\n          current: depthInfo.current + offset\n        }))];\n      }, []).filter(depthInfo => depthInfo.current >= -1); // discard all depth infos which are out of bounds\n    } else {\n      // if the current accessor is not a special keyword, we know it's simply accessing a child\n      // hence we are now one level deeper in the tree and simply increment\n      accessorDepthInfos = accessorDepthInfos.map(depthInfo => ({\n        previous: depthInfo.current,\n        current: depthInfo.current + 1\n      }));\n    }\n\n    // finally, we check if for the current accessor, there is a scenario where:\n    // previous it was at depth -1 (i.e. the root context), and is now at depth 0 (i.e. a variable)\n    // these are the variables we need to request, so we add them to the set\n    if (accessorDepthInfos.some(depthInfo => depthInfo.previous === -1 && depthInfo.current === 0)) {\n      extractedVariables.add(currentAccessor);\n    }\n  }\n\n  // we return a set to avoid duplicates\n  return new Set(extractedVariables);\n};\n\n/**\n * Deconstructs a path expression tree into an array of components.\n *\n * @param {Object} root - The root node of the path expression tree.\n * @returns {Array<object>} An array of components in the path expression, in the correct order.\n */\nconst _linearizePathExpression = root => {\n  let node = root;\n  let parts = [];\n\n  // Traverse the tree and collect path components\n  while (node.name === 'PathExpression') {\n    parts.push(node.children[1]);\n    node = node.children[0];\n  }\n\n  // Add the last component to the array\n  parts.push(node);\n\n  // Reverse and return the array to get the correct order\n  return parts.reverse();\n};\n\n/**\n * Builds a simplified feel structure tree from the given parse tree and feel string.\n * The nodes follow this structure: `{ name: string, children: Array, variableName?: string }`\n *\n * @param {Object} parseTree - The parse tree generated by a parser.\n * @param {string} feelString - The feel string used for parsing.\n * @returns {Object} The simplified feel structure tree.\n */\nconst _buildSimpleFeelStructureTree = (parseTree, feelString) => {\n  const stack = [{\n    children: []\n  }];\n  parseTree.iterate({\n    enter: node => {\n      const nodeRepresentation = {\n        name: node.type.name,\n        children: []\n      };\n      if (node.type.name === 'VariableName') {\n        nodeRepresentation.variableName = feelString.slice(node.from, node.to);\n      }\n      stack.push(nodeRepresentation);\n    },\n    leave: () => {\n      const result = stack.pop();\n      const parent = stack[stack.length - 1];\n      parent.children.push(result);\n    }\n  });\n  return _extractFilterExpressions(stack[0].children[0]);\n};\n\n/**\n * Restructure the tree in such a way to bring filters (which create new contexts) to the root of the tree.\n * This is done to simplify the extraction of variables and match the context hierarchy.\n */\nconst _extractFilterExpressions = tree => {\n  const flattenedExpressionTree = {\n    name: 'Root',\n    children: [tree]\n  };\n  const iterate = node => {\n    if (node.children) {\n      for (let x = 0; x < node.children.length; x++) {\n        if (node.children[x].name === 'FilterExpression') {\n          const filterTarget = node.children[x].children[0];\n          const filterExpression = node.children[x].children[2];\n\n          // bypass the filter expression\n          node.children[x] = filterTarget;\n          const taggedFilterExpression = {\n            name: 'FilterContext',\n            children: [filterExpression]\n          };\n\n          // append the filter expression to the root\n          flattenedExpressionTree.children.push(taggedFilterExpression);\n\n          // recursively iterate the expression\n          iterate(filterExpression);\n        } else {\n          iterate(node.children[x]);\n        }\n      }\n    }\n  };\n  iterate(tree);\n  return flattenedExpressionTree;\n};\nclass FeelExpressionLanguage {\n  constructor(eventBus) {\n    this._eventBus = eventBus;\n  }\n\n  /**\n   * Determines if the given value is a FEEL expression.\n   *\n   * @param {any} value\n   * @returns {boolean}\n   *\n   */\n  isExpression(value) {\n    return isString(value) && value.startsWith('=');\n  }\n\n  /**\n   * Retrieve variable names from a given FEEL expression.\n   *\n   * @param {string} expression\n   * @param {object} [options]\n   * @param {string} [options.type]\n   *\n   * @returns {string[]}\n   */\n  getVariableNames(expression, options = {}) {\n    const {\n      type = 'expression'\n    } = options;\n    if (!this.isExpression(expression)) {\n      return [];\n    }\n    if (!['unaryTest', 'expression'].includes(type)) {\n      throw new Error('Unknown expression type: ' + type);\n    }\n    return getFlavouredFeelVariableNames(expression, type);\n  }\n\n  /**\n   * Evaluate an expression.\n   *\n   * @param {string} expression\n   * @param {import('../../types').Data} [data]\n   *\n   * @returns {any}\n   */\n  evaluate(expression, data = {}) {\n    if (!expression) {\n      return null;\n    }\n    if (!isString(expression) || !expression.startsWith('=')) {\n      return null;\n    }\n    try {\n      const result = evaluate(expression.slice(1), data);\n      return result;\n    } catch (error) {\n      this._eventBus.fire('error', {\n        error\n      });\n      return null;\n    }\n  }\n}\nFeelExpressionLanguage.$inject = ['eventBus'];\nclass FeelersTemplating {\n  constructor() {}\n\n  /**\n   * Determines if the given value is a feelers template.\n   *\n   * @param {any} value\n   * @returns {boolean}\n   *\n   */\n  isTemplate(value) {\n    return isString(value) && (value.startsWith('=') || /{{.*?}}/.test(value));\n  }\n\n  /**\n   * Retrieve variable names from a given feelers template.\n   *\n   * @param {string} template\n   *\n   * @returns {string[]}\n   */\n  getVariableNames(template) {\n    if (!this.isTemplate(template)) {\n      return [];\n    }\n    const expressions = this._extractExpressionsWithDepth(template);\n\n    // defines special accessors, and the change(s) in depth they could imply (e.g. parent can be used to access the parent context (depth - 1) or a child variable named parent (depth + 1)\n    const specialDepthAccessors = {\n      parent: [-1, 1],\n      _parent_: [-1],\n      this: [0, 1],\n      _this_: [0]\n    };\n    return expressions.reduce((variables, {\n      expression,\n      depth\n    }) => {\n      return variables.concat(getFlavouredFeelVariableNames(expression, 'expression', {\n        depth,\n        specialDepthAccessors\n      }));\n    }, []);\n  }\n\n  /**\n   * Evaluate a template.\n   *\n   * @param {string} template\n   * @param {Object<string, any>} context\n   * @param {Object} options\n   * @param {boolean} [options.debug = false]\n   * @param {boolean} [options.strict = false]\n   * @param {Function} [options.buildDebugString]\n   * @param {Function} [options.sanitizer]\n   *\n   * @returns\n   */\n  evaluate(template, context = {}, options = {}) {\n    const {\n      debug = false,\n      strict = false,\n      buildDebugString = err => ' {{⚠}} ',\n      sanitizer = value => value\n    } = options;\n    return evaluate$1(template, context, {\n      debug,\n      strict,\n      buildDebugString,\n      sanitizer\n    });\n  }\n\n  /**\n  * @typedef {Object} ExpressionWithDepth\n  * @property {number} depth - The depth of the expression in the syntax tree.\n  * @property {string} expression - The extracted expression\n  */\n\n  /**\n  * Extracts all feel expressions in the template along with their depth in the syntax tree.\n  * The depth is incremented for child expressions of loops to account for context drilling.\n  * @name extractExpressionsWithDepth\n  * @param {string} template - A feelers template string.\n  * @returns {Array<ExpressionWithDepth>} An array of objects, each containing the depth and the extracted expression.\n  *\n  * @example\n  * const template = \"Hello {{user}}, you have:{{#loop items}}\\n- {{amount}} {{name}}{{/loop}}.\";\n  * const extractedExpressions = _extractExpressionsWithDepth(template);\n  */\n  _extractExpressionsWithDepth(template) {\n    // build simplified feelers syntax tree\n    const parseTree = parser.parse(template);\n    const tree = buildSimpleTree(parseTree, template);\n    return function _traverse(n, depth = 0) {\n      if (['Feel', 'FeelBlock'].includes(n.name)) {\n        return [{\n          depth,\n          expression: n.content\n        }];\n      }\n      if (n.name === 'LoopSpanner') {\n        const loopExpression = n.children[0].content;\n        const childResults = n.children.slice(1).reduce((acc, child) => {\n          return acc.concat(_traverse(child, depth + 1));\n        }, []);\n        return [{\n          depth,\n          expression: loopExpression\n        }, ...childResults];\n      }\n      return n.children.reduce((acc, child) => {\n        return acc.concat(_traverse(child, depth));\n      }, []);\n    }(tree);\n  }\n}\nFeelersTemplating.$inject = [];\n\n// config  ///////////////////\n\nconst MINUTES_IN_DAY = 60 * 24;\nconst DATETIME_SUBTYPES = {\n  DATE: 'date',\n  TIME: 'time',\n  DATETIME: 'datetime'\n};\nconst TIME_SERIALISING_FORMATS = {\n  UTC_OFFSET: 'utc_offset',\n  UTC_NORMALIZED: 'utc_normalized',\n  NO_TIMEZONE: 'no_timezone'\n};\nconst DATETIME_SUBTYPES_LABELS = {\n  [DATETIME_SUBTYPES.DATE]: 'Date',\n  [DATETIME_SUBTYPES.TIME]: 'Time',\n  [DATETIME_SUBTYPES.DATETIME]: 'Date & Time'\n};\nconst TIME_SERIALISINGFORMAT_LABELS = {\n  [TIME_SERIALISING_FORMATS.UTC_OFFSET]: 'UTC offset',\n  [TIME_SERIALISING_FORMATS.UTC_NORMALIZED]: 'UTC normalized',\n  [TIME_SERIALISING_FORMATS.NO_TIMEZONE]: 'No timezone'\n};\nconst DATETIME_SUBTYPE_PATH = ['subtype'];\nconst DATE_LABEL_PATH = ['dateLabel'];\nconst DATE_DISALLOW_PAST_PATH = ['disallowPassedDates'];\nconst TIME_LABEL_PATH = ['timeLabel'];\nconst TIME_USE24H_PATH = ['use24h'];\nconst TIME_INTERVAL_PATH = ['timeInterval'];\nconst TIME_SERIALISING_FORMAT_PATH = ['timeSerializingFormat'];\n\n// config  ///////////////////\n\nconst OPTIONS_SOURCES = {\n  STATIC: 'static',\n  INPUT: 'input',\n  EXPRESSION: 'expression'\n};\nconst OPTIONS_SOURCE_DEFAULT = OPTIONS_SOURCES.STATIC;\nconst OPTIONS_SOURCES_LABELS = {\n  [OPTIONS_SOURCES.STATIC]: 'Static',\n  [OPTIONS_SOURCES.INPUT]: 'Input data',\n  [OPTIONS_SOURCES.EXPRESSION]: 'Expression'\n};\nconst OPTIONS_SOURCES_PATHS = {\n  [OPTIONS_SOURCES.STATIC]: ['values'],\n  [OPTIONS_SOURCES.INPUT]: ['valuesKey'],\n  [OPTIONS_SOURCES.EXPRESSION]: ['valuesExpression']\n};\nconst OPTIONS_SOURCES_DEFAULTS = {\n  [OPTIONS_SOURCES.STATIC]: [{\n    label: 'Value',\n    value: 'value'\n  }],\n  [OPTIONS_SOURCES.INPUT]: '',\n  [OPTIONS_SOURCES.EXPRESSION]: '='\n};\n\n// helpers ///////////////////\n\nfunction getOptionsSource(field) {\n  for (const source of Object.values(OPTIONS_SOURCES)) {\n    if (get(field, OPTIONS_SOURCES_PATHS[source]) !== undefined) {\n      return source;\n    }\n  }\n  return OPTIONS_SOURCE_DEFAULT;\n}\nconst SANDBOX_ATTRIBUTE = 'sandbox';\nconst ALLOW_ATTRIBUTE = 'allow';\n\n// Cf. https://developer.mozilla.org/en-US/docs/Web/HTTP/Permissions_Policy#iframe_syntax\nconst SECURITY_ATTRIBUTES_DEFINITIONS = [{\n  attribute: SANDBOX_ATTRIBUTE,\n  directive: 'allow-scripts',\n  property: 'allowScripts',\n  label: 'Script execution'\n}, {\n  attribute: SANDBOX_ATTRIBUTE,\n  directive: 'allow-same-origin',\n  property: 'allowSameOrigin',\n  label: 'Allow same origin'\n}, {\n  attribute: ALLOW_ATTRIBUTE,\n  directive: 'fullscreen',\n  property: 'fullscreen',\n  label: 'Open in fullscreen'\n}, {\n  attribute: ALLOW_ATTRIBUTE,\n  directive: 'geolocation',\n  property: 'geolocation',\n  label: 'Geolocation'\n}, {\n  attribute: ALLOW_ATTRIBUTE,\n  directive: 'camera',\n  property: 'camera',\n  label: 'Camera access'\n}, {\n  attribute: ALLOW_ATTRIBUTE,\n  directive: 'microphone',\n  property: 'microphone',\n  label: 'Microphone access'\n}, {\n  attribute: SANDBOX_ATTRIBUTE,\n  directive: 'allow-forms',\n  property: 'allowForms',\n  label: 'Forms submission'\n}, {\n  attribute: SANDBOX_ATTRIBUTE,\n  directive: 'allow-modals',\n  property: 'allowModals',\n  label: 'Open modal windows'\n}, {\n  attribute: SANDBOX_ATTRIBUTE,\n  directive: 'allow-popups',\n  property: 'allowPopups',\n  label: 'Open popups'\n}, {\n  attribute: SANDBOX_ATTRIBUTE,\n  directive: 'allow-top-navigation',\n  property: 'allowTopNavigation',\n  label: 'Top level navigation'\n}, {\n  attribute: SANDBOX_ATTRIBUTE,\n  directive: 'allow-storage-access-by-user-activation',\n  property: 'allowStorageAccessByUserActivation',\n  label: 'Storage access by user'\n}];\nfunction createInjector(bootstrapModules) {\n  const injector = new Injector(bootstrapModules);\n  injector.init();\n  return injector;\n}\n\n/**\n * @param {string?} prefix\n *\n * @returns Element\n */\nfunction createFormContainer(prefix = 'fjs') {\n  const container = document.createElement('div');\n  container.classList.add(`${prefix}-container`);\n  return container;\n}\nfunction formFieldClasses(type, {\n  errors = [],\n  disabled = false,\n  readonly = false\n} = {}) {\n  if (!type) {\n    throw new Error('type required');\n  }\n  return classNames('fjs-form-field', `fjs-form-field-${type}`, {\n    'fjs-has-errors': errors.length > 0,\n    'fjs-disabled': disabled,\n    'fjs-readonly': readonly\n  });\n}\nfunction gridColumnClasses(formField) {\n  const {\n    layout = {}\n  } = formField;\n  const {\n    columns\n  } = layout;\n  return classNames('fjs-layout-column', `cds--col${columns ? '-lg-' + columns : ''}`,\n  // always fall back to top-down on smallest screens\n  'cds--col-sm-16', 'cds--col-md-16');\n}\nfunction prefixId(id, formId, indexes) {\n  let result = 'fjs-form';\n  if (formId) {\n    result += `-${formId}`;\n  }\n  result += `-${id}`;\n  Object.values(indexes || {}).forEach(index => {\n    result += `_${index}`;\n  });\n  return result;\n}\nconst type$g = 'button';\nfunction Button(props) {\n  const {\n    disabled,\n    onFocus,\n    onBlur,\n    field\n  } = props;\n  const {\n    action = 'submit'\n  } = field;\n  return jsx(\"div\", {\n    class: formFieldClasses(type$g),\n    children: jsx(\"button\", {\n      class: \"fjs-button\",\n      type: action,\n      disabled: disabled,\n      onFocus: () => onFocus && onFocus(),\n      onBlur: () => onBlur && onBlur(),\n      children: field.label\n    })\n  });\n}\nButton.config = {\n  type: type$g,\n  keyed: false,\n  label: 'Button',\n  group: 'action',\n  create: (options = {}) => ({\n    action: 'submit',\n    ...options\n  })\n};\nconst FormRenderContext = createContext({\n  Empty: props => {\n    return null;\n  },\n  Hidden: props => {\n    return null;\n  },\n  Children: props => {\n    return jsx(\"div\", {\n      class: props.class,\n      style: props.style,\n      children: props.children\n    });\n  },\n  Element: props => {\n    return jsx(\"div\", {\n      class: props.class,\n      style: props.style,\n      children: props.children\n    });\n  },\n  Row: props => {\n    return jsx(\"div\", {\n      class: props.class,\n      style: props.style,\n      children: props.children\n    });\n  },\n  Column: props => {\n    if (props.field.type === 'default') {\n      return props.children;\n    }\n    return jsx(\"div\", {\n      class: props.class,\n      style: props.style,\n      children: props.children\n    });\n  },\n  hoverInfo: {\n    cleanup: () => {}\n  }\n});\nconst LocalExpressionContext = createContext({\n  data: null,\n  this: null,\n  parent: null,\n  i: null\n});\n\n/**\n * @param {string} type\n * @param {boolean} [strict]\n *\n * @returns {any}\n */\nfunction getService(type, strict) {}\nconst FormContext = createContext({\n  getService,\n  formId: null\n});\nfunction useService(type, strict) {\n  const {\n    getService\n  } = useContext(FormContext);\n  return getService(type, strict);\n}\nfunction isRequired(field) {\n  return field.required;\n}\nfunction pathParse(path) {\n  if (!path) {\n    return [];\n  }\n  return path.split('.').map(key => {\n    return isNaN(parseInt(key)) ? key : parseInt(key);\n  });\n}\nfunction pathsEqual(a, b) {\n  return a && b && a.length === b.length && a.every((value, index) => value === b[index]);\n}\nconst indices = {};\nfunction generateIndexForType(type) {\n  if (type in indices) {\n    indices[type]++;\n  } else {\n    indices[type] = 1;\n  }\n  return indices[type];\n}\nfunction generateIdForType(type) {\n  return `${type}${generateIndexForType(type)}`;\n}\n\n/**\n * @template T\n * @param {T} data\n * @param {(this: any, key: string, value: any) => any} [replacer]\n * @return {T}\n */\nfunction clone(data, replacer) {\n  return JSON.parse(JSON.stringify(data, replacer));\n}\n\n/**\n * Transform a LocalExpressionContext object into a usable FEEL context.\n *\n * @param {Object} context - The LocalExpressionContext object.\n * @returns {Object} The usable FEEL context.\n */\n\nfunction buildExpressionContext(context) {\n  const {\n    data,\n    ...specialContextKeys\n  } = context;\n  return {\n    ...specialContextKeys,\n    ...data,\n    ..._wrapObjectKeysWithUnderscores(specialContextKeys)\n  };\n}\nfunction runRecursively(formField, fn) {\n  const components = formField.components || [];\n  components.forEach((component, index) => {\n    runRecursively(component, fn);\n  });\n  fn(formField);\n}\n\n// helpers //////////////////////\n\nfunction _wrapObjectKeysWithUnderscores(obj) {\n  const newObj = {};\n  for (const [key, value] of Object.entries(obj)) {\n    newObj[`_${key}_`] = value;\n  }\n  return newObj;\n}\n\n/**\n * Evaluate if condition is met reactively based on the conditionChecker and form data.\n *\n * @param {string | undefined} condition\n *\n * @returns {boolean} true if condition is met or no condition or condition checker exists\n */\nfunction useCondition(condition) {\n  const conditionChecker = useService('conditionChecker', false);\n  const expressionContextInfo = useContext(LocalExpressionContext);\n  return useMemo(() => {\n    return conditionChecker ? conditionChecker.check(condition, buildExpressionContext(expressionContextInfo)) : null;\n  }, [conditionChecker, condition, expressionContextInfo]);\n}\n\n/**\n * Returns the options data for the provided if they can be simply determined, ignoring expression defined options.\n *\n * @param {object} formField\n * @param {object} formData\n */\nfunction getSimpleOptionsData(formField, formData) {\n  const {\n    valuesExpression: optionsExpression,\n    valuesKey: optionsKey,\n    values: staticOptions\n  } = formField;\n  if (optionsExpression) {\n    return null;\n  }\n  return optionsKey ? get(formData, [optionsKey]) : staticOptions;\n}\n\n/**\n * Normalizes the provided options data to a format that can be used by the select components.\n * If the options data is not valid, it is filtered out.\n *\n * @param {any[]} optionsData\n *\n * @returns {object[]}\n */\nfunction normalizeOptionsData(optionsData) {\n  return optionsData.filter(_isAllowedValue).map(_normalizeOption).filter(o => !isNil(o));\n}\n\n/**\n * Creates an options object with default values if no options are provided.\n *\n * @param {object} options\n *\n * @returns {object}\n */\nfunction createEmptyOptions(options = {}) {\n  const defaults = {};\n\n  // provide default options if valuesKey and valuesExpression are not set\n  if (!options.valuesKey && !options.valuesExpression) {\n    defaults.values = [{\n      label: 'Value',\n      value: 'value'\n    }];\n  }\n  return {\n    ...defaults,\n    ...options\n  };\n}\n\n/**\n * Converts the provided option to a normalized format.\n * If the option is not valid, null is returned.\n *\n * @param {object} option\n * @param {string} option.label\n * @param {*} option.value\n *\n * @returns\n */\nfunction _normalizeOption(option) {\n  // (1) simple primitive case, use it as both label and value\n  if (_isAllowedPrimitive(option)) {\n    return {\n      value: option,\n      label: `${option}`\n    };\n  }\n  if (isObject(option)) {\n    const isValidLabel = _isValidLabel(option.label);\n\n    // (2) no label provided, but value is a simple primitive, use it as label and value\n    if (!isValidLabel && _isAllowedPrimitive(option.value)) {\n      return {\n        value: option.value,\n        label: `${option.value}`\n      };\n    }\n\n    // (3) both label and value are provided, use them as is\n    if (isValidLabel && _isAllowedValue(option.value)) {\n      return option;\n    }\n  }\n  return null;\n}\nfunction _isAllowedPrimitive(value) {\n  const isAllowedPrimitiveType = ['number', 'string', 'boolean'].includes(typeof value);\n  const isValid = value || value === 0 || value === false;\n  return isAllowedPrimitiveType && isValid;\n}\nfunction _isValidLabel(label) {\n  return label && isString(label);\n}\nfunction _isAllowedValue(value) {\n  if (isObject(value)) {\n    return Object.keys(value).length > 0;\n  }\n  return _isAllowedPrimitive(value);\n}\n\n/**\n * Evaluate a string reactively based on the expressionLanguage and form data.\n * If the string is not an expression, it is returned as is.\n * The function is memoized to minimize re-renders.\n *\n * @param {string} value - The string to evaluate.\n * @returns {any} - Evaluated value or the original value if not an expression.\n */\nfunction useExpressionEvaluation(value) {\n  const expressionLanguage = useService('expressionLanguage');\n  const expressionContextInfo = useContext(LocalExpressionContext);\n  return useMemo(() => {\n    if (expressionLanguage && expressionLanguage.isExpression(value)) {\n      return expressionLanguage.evaluate(value, buildExpressionContext(expressionContextInfo));\n    }\n    return value;\n  }, [expressionLanguage, expressionContextInfo, value]);\n}\n\n/**\n * A custom hook to manage state changes with deep comparison.\n *\n * @template T\n * @param {T} value - The current value to manage.\n * @returns {T} - Returns the current state.\n */\nfunction useDeepCompareMemoize(value) {\n  const ref = useRef();\n  if (!isEqual(value, ref.current)) {\n    ref.current = value;\n  }\n  return ref.current;\n}\n\n/**\n * @enum { String }\n */\nconst LOAD_STATES = {\n  LOADING: 'loading',\n  LOADED: 'loaded',\n  ERROR: 'error'\n};\n\n/**\n * @typedef {Object} OptionsGetter\n * @property {Object[]} options - The options data\n * @property {(LOAD_STATES)} loadState - The options data's loading state, to use for conditional rendering\n */\n\n/**\n * A hook to load options for single and multiselect components.\n *\n * @param {Object} field - The form field to handle options for\n * @return {OptionsGetter} optionsGetter - A options getter object providing loading state and options\n */\nfunction useOptionsAsync(field) {\n  const {\n    valuesExpression: optionsExpression,\n    valuesKey: optionsKey,\n    values: staticOptions\n  } = field;\n  const initialData = useService('form')._getState().initialData;\n  const expressionEvaluation = useExpressionEvaluation(optionsExpression);\n  const evaluatedOptions = useDeepCompareMemoize(expressionEvaluation || []);\n  const optionsGetter = useMemo(() => {\n    let options = [];\n\n    // dynamic options\n    if (optionsKey !== undefined) {\n      const keyedOptions = (initialData || {})[optionsKey];\n      if (keyedOptions && Array.isArray(keyedOptions)) {\n        options = keyedOptions;\n      }\n\n      // static options\n    } else if (staticOptions !== undefined) {\n      options = Array.isArray(staticOptions) ? staticOptions : [];\n\n      // expression\n    } else if (optionsExpression && evaluatedOptions && Array.isArray(evaluatedOptions)) {\n      options = evaluatedOptions;\n\n      // error case\n    } else {\n      return buildErrorState('No options source defined in the form definition');\n    }\n\n    // normalize data to support primitives and partially defined objects\n    return buildLoadedState(normalizeOptionsData(options));\n  }, [optionsKey, staticOptions, initialData, optionsExpression, evaluatedOptions]);\n  return optionsGetter;\n}\nconst buildErrorState = error => ({\n  options: [],\n  error,\n  loadState: LOAD_STATES.ERROR\n});\nconst buildLoadedState = options => ({\n  options,\n  error: undefined,\n  loadState: LOAD_STATES.LOADED\n});\n\n/**\n * Wrap HTML content in a configuration object for dangerouslySetInnerHTML\n * @param {Object} props\n * @param {string} props.html\n * @param {Function} [props.transform]\n * @param {boolean} [props.sanitize = true]\n * @param {boolean} [props.sanitizeStyleTags = true]\n */\nconst useDangerousHTMLWrapper = props => {\n  const {\n    html,\n    transform = html => html,\n    sanitize = true,\n    sanitizeStyleTags = true\n  } = props;\n  const sanitizedHtml = useMemo(() => sanitize ? DOMPurify.sanitize(html, getDOMPurifyConfig(sanitizeStyleTags)) : html, [html, sanitize, sanitizeStyleTags]);\n  const transformedHtml = useMemo(() => transform(sanitizedHtml), [sanitizedHtml, transform]);\n\n  // Return the configuration object for dangerouslySetInnerHTML\n  return {\n    __html: transformedHtml\n  };\n};\nconst getDOMPurifyConfig = sanitizeStyleTags => {\n  return {\n    FORCE_BODY: true,\n    FORBID_TAGS: sanitizeStyleTags ? ['style'] : []\n  };\n};\n\n/**\r\n * A custom hook to build up security attributes from form configuration.\r\n *\r\n * @param {Object} security - The security configuration.\r\n * @returns {Array} - Returns a tuple with sandbox and allow attributes.\r\n */\nfunction useSecurityAttributesMap(security) {\n  const securityMemoized = useDeepCompareMemoize(security);\n  const sandbox = useMemo(() => SECURITY_ATTRIBUTES_DEFINITIONS.filter(({\n    attribute\n  }) => attribute === SANDBOX_ATTRIBUTE).filter(({\n    property\n  }) => get(securityMemoized, [property], false)).map(({\n    directive\n  }) => directive).join(' '), [securityMemoized]);\n  const allow = useMemo(() => SECURITY_ATTRIBUTES_DEFINITIONS.filter(({\n    attribute\n  }) => attribute !== SANDBOX_ATTRIBUTE).filter(({\n    property\n  }) => get(securityMemoized, [property], false)).map(({\n    directive\n  }) => directive).join('; '), [securityMemoized]);\n  return [sandbox, allow];\n}\n\n/**\n * This hook allows us to retrieve the label from a value in linear time by caching it in a map\n * @param {Array} options\n */\nfunction useGetLabelCorrelation(options) {\n  // This allows us to retrieve the label from a value in linear time\n  const labelMap = useMemo(() => Object.assign({}, ...options.map(o => ({\n    [_getValueHash(o.value)]: o.label\n  }))), [options]);\n  return useCallback(value => labelMap[_getValueHash(value)], [labelMap]);\n}\nconst _getValueHash = value => {\n  return isObject(value) ? JSON.stringify(value) : value;\n};\n\n/**\n * Custom hook to scroll an element into view only when it is not visible within the viewport.\n *\n * @param {Object} targetRef - A ref pointing to the DOM element to scroll into view.\n * @param {Array} deps - An array of dependencies that trigger the effect.\n * @param {Array} flagRefs - An array of refs that are used as flags to control when to scroll.\n * @param {Object} [scrollOptions={}] - Options defining the behavior of the scrolling.\n * @param {String} [scrollOptions.align='center'] - The alignment of the element within the viewport.\n * @param {String} [scrollOptions.behavior='auto'] - The scrolling behavior.\n * @param {Number} [scrollOptions.offset=0] - An offset that is added to the scroll position.\n * @param {Boolean} [scrollOptions.scrollIfVisible=false] - Whether to scroll even if the element is visible.\n */\nfunction useScrollIntoView(targetRef, deps, scrollOptions = null, flagRefs = []) {\n  useEffect(() => {\n    // return early if flags are not raised, or component is not mounted\n    if (some(flagRefs, ref => !ref.current) || !targetRef.current) {\n      return;\n    }\n    for (let i = 0; i < flagRefs.length; i++) {\n      flagRefs[i].current = false;\n    }\n    const itemToBeScrolled = targetRef.current;\n    const scrollContainer = _getNearestScrollableAncestor(itemToBeScrolled);\n    if (!scrollContainer) {\n      return;\n    }\n    const itemRect = itemToBeScrolled.getBoundingClientRect();\n    const containerRect = scrollContainer.getBoundingClientRect();\n\n    // should scroll if visible or scrollIfVisible option is set\n    const shouldScroll = scrollOptions.scrollIfVisible || !(itemRect.top >= containerRect.top && itemRect.bottom <= containerRect.bottom);\n    if (!shouldScroll) {\n      return;\n    }\n    const {\n      align = 'center',\n      offset = 0,\n      behavior = 'auto'\n    } = scrollOptions;\n    const topOffset = _getTopOffset(itemToBeScrolled, scrollContainer, {\n      align,\n      offset\n    });\n    scrollContainer.scroll({\n      top: topOffset,\n      behavior\n    });\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, deps);\n}\n\n// helper //////////////////////\n\nfunction _getNearestScrollableAncestor(el) {\n  while (el) {\n    if (el.scrollHeight > el.clientHeight) {\n      return el;\n    }\n    el = el.parentElement;\n  }\n}\nfunction _getTopOffset(item, scrollContainer, options) {\n  const itemRect = item.getBoundingClientRect();\n  const containerRect = scrollContainer.getBoundingClientRect();\n  if (options.align === 'top') {\n    return itemRect.top - containerRect.top + scrollContainer.scrollTop - options.offset;\n  } else if (options.align === 'bottom') {\n    return itemRect.bottom - containerRect.top - scrollContainer.clientHeight + scrollContainer.scrollTop + options.offset;\n  } else if (options.align === 'center') {\n    return itemRect.top - containerRect.top - scrollContainer.clientHeight / 2 + scrollContainer.scrollTop + itemRect.height / 2 + options.offset;\n  }\n  return 0;\n}\n\n/**\n * Returns the conditionally filtered data of a form reactively.\n * Memoised to minimize re-renders\n *\n * Warning: costly operation, use with care\n */\nfunction useFilteredFormData() {\n  const {\n    initialData,\n    data\n  } = useService('form')._getState();\n  const conditionChecker = useService('conditionChecker', false);\n  return useMemo(() => {\n    const newData = conditionChecker ? conditionChecker.applyConditions(data, data) : data;\n    return {\n      ...initialData,\n      ...newData\n    };\n  }, [conditionChecker, data, initialData]);\n}\nfunction useKeyDownAction(targetKey, action, listenerElement = window) {\n  function downHandler({\n    key\n  }) {\n    if (key === targetKey) {\n      action();\n    }\n  }\n  useEffect(() => {\n    listenerElement.addEventListener('keydown', downHandler);\n    return () => {\n      listenerElement.removeEventListener('keydown', downHandler);\n    };\n  });\n}\n\n/**\n * Retrieve readonly value of a form field, given it can be an\n * expression optionally or configured globally.\n *\n * @typedef { import('../../types').FormProperties } FormProperties\n *\n * @param {any} formField\n * @param {FormProperties} properties\n *\n * @returns {boolean}\n */\nfunction useReadonly(formField, properties = {}) {\n  const expressionLanguage = useService('expressionLanguage');\n  const conditionChecker = useService('conditionChecker', false);\n  const expressionContextInfo = useContext(LocalExpressionContext);\n  const {\n    readonly\n  } = formField;\n  if (properties.readOnly) {\n    return true;\n  }\n  if (expressionLanguage && expressionLanguage.isExpression(readonly)) {\n    return conditionChecker ? conditionChecker.check(readonly, buildExpressionContext(expressionContextInfo)) : false;\n  }\n  return readonly || false;\n}\nfunction usePrevious(value, defaultValue = null) {\n  const ref = useRef(defaultValue);\n  useEffect(() => ref.current = value, [value]);\n  return ref.current;\n}\nfunction useFlushDebounce(func) {\n  const timeoutRef = useRef(null);\n  const lastArgsRef = useRef(null);\n  const config = useService('config', false);\n  const debounce = config && config.debounce;\n  const shouldDebounce = debounce !== false && debounce !== 0;\n  const delay = typeof debounce === 'number' ? debounce : 300;\n  const debounceFunc = useCallback((...args) => {\n    if (!shouldDebounce) {\n      func(...args);\n      return;\n    }\n    lastArgsRef.current = args;\n    if (timeoutRef.current) {\n      clearTimeout(timeoutRef.current);\n    }\n    timeoutRef.current = setTimeout(() => {\n      func(...lastArgsRef.current);\n      lastArgsRef.current = null;\n    }, delay);\n  }, [func, delay, shouldDebounce]);\n  const flushFunc = useCallback(() => {\n    if (timeoutRef.current) {\n      clearTimeout(timeoutRef.current);\n      if (lastArgsRef.current !== null) {\n        func(...lastArgsRef.current);\n        lastArgsRef.current = null;\n      }\n      timeoutRef.current = null;\n    }\n  }, [func]);\n  return [debounceFunc, flushFunc];\n}\n\n/**\n * Template a string reactively based on form data. If the string is not a template, it is returned as is.\n * Memoised to minimize re-renders\n *\n * @param {string} value\n * @param {Object} options\n * @param {boolean} [options.debug = false]\n * @param {boolean} [options.strict = false]\n * @param {Function} [options.sanitizer]\n * @param {Function} [options.buildDebugString]\n *\n */\nfunction useTemplateEvaluation(value, options = {}) {\n  const templating = useService('templating');\n  const expressionContextInfo = useContext(LocalExpressionContext);\n  return useMemo(() => {\n    if (templating && templating.isTemplate(value)) {\n      return templating.evaluate(value, buildExpressionContext(expressionContextInfo), options);\n    }\n    return value;\n  }, [templating, value, expressionContextInfo, options]);\n}\n\n/**\n * Template a string reactively based on form data. If the string is not a template, it is returned as is.\n * If the string contains multiple lines, only the first line is returned.\n * Memoised to minimize re-renders\n *\n * @param {string} value\n * @param {Object} [options]\n * @param {boolean} [options.debug = false]\n * @param {boolean} [options.strict = false]\n * @param {Function} [options.buildDebugString]\n *\n */\nfunction useSingleLineTemplateEvaluation(value, options = {}) {\n  const evaluatedTemplate = useTemplateEvaluation(value, options);\n  return useMemo(() => evaluatedTemplate && evaluatedTemplate.split('\\n')[0], [evaluatedTemplate]);\n}\nconst ENTER_KEYDOWN_EVENT = new KeyboardEvent('keydown', {\n  code: 'Enter',\n  key: 'Enter',\n  charCode: 13,\n  keyCode: 13,\n  bubbles: true\n});\nfunction focusRelevantFlatpickerDay(flatpickrInstance) {\n  if (!flatpickrInstance) return;\n  !flatpickrInstance.isOpen && flatpickrInstance.open();\n  const container = flatpickrInstance.calendarContainer;\n  const dayToFocus = container.querySelector('.flatpickr-day.selected') || container.querySelector('.flatpickr-day.today') || container.querySelector('.flatpickr-day');\n  dayToFocus && dayToFocus.focus();\n}\nfunction formatTime(use24h, minutes) {\n  if (minutes === null) return null;\n  const wrappedMinutes = minutes % (24 * 60);\n  const minute = minutes % 60;\n  let hour = Math.floor(wrappedMinutes / 60);\n  if (use24h) {\n    return _getZeroPaddedString(hour) + ':' + _getZeroPaddedString(minute);\n  }\n  hour = hour % 12 || 12;\n  const isPM = wrappedMinutes >= 12 * 60;\n  return _getZeroPaddedString(hour) + ':' + _getZeroPaddedString(minute) + ' ' + (isPM ? 'PM' : 'AM');\n}\nfunction parseInputTime(stringTime) {\n  let workingString = stringTime.toLowerCase();\n  const is12h = workingString.includes('am') || workingString.includes('pm');\n  if (is12h) {\n    const isPM = workingString.includes('pm');\n    const digits = workingString.match(/\\d+/g);\n    const displayHour = parseInt(digits && digits[0]);\n    const minute = parseInt(digits && digits[1]) || 0;\n    const isValidDisplayHour = isNumber(displayHour) && displayHour >= 1 && displayHour <= 12;\n    const isValidMinute = minute >= 0 && minute <= 59;\n    if (!isValidDisplayHour || !isValidMinute) return null;\n    const hour = displayHour % 12 + (isPM ? 12 : 0);\n    return hour * 60 + minute;\n  } else {\n    const digits = workingString.match(/\\d+/g);\n    const hour = parseInt(digits && digits[0]);\n    const minute = parseInt(digits && digits[1]);\n    const isValidHour = isNumber(hour) && hour >= 0 && hour <= 23;\n    const isValidMinute = isNumber(minute) && minute >= 0 && minute <= 59;\n    if (!isValidHour || !isValidMinute) return null;\n    return hour * 60 + minute;\n  }\n}\nfunction serializeTime(minutes, offset, timeSerializingFormat) {\n  if (timeSerializingFormat === TIME_SERIALISING_FORMATS.UTC_NORMALIZED) {\n    const normalizedMinutes = (minutes + offset + MINUTES_IN_DAY) % MINUTES_IN_DAY;\n    return _getZeroPaddedString(Math.floor(normalizedMinutes / 60)) + ':' + _getZeroPaddedString(normalizedMinutes % 60) + 'Z';\n  }\n  const baseTime = _getZeroPaddedString(Math.floor(minutes / 60)) + ':' + _getZeroPaddedString(minutes % 60);\n  const addUTCOffset = timeSerializingFormat === TIME_SERIALISING_FORMATS.UTC_OFFSET;\n  return baseTime + (addUTCOffset ? formatTimezoneOffset(offset) : '');\n}\nfunction parseIsoTime(isoTimeString) {\n  if (!isoTimeString) return null;\n  const parseBasicMinutes = timeString => {\n    const timeSegments = timeString.split(':');\n    const hour = parseInt(timeSegments[0]);\n    const minute = timeSegments.length > 1 ? parseInt(timeSegments[1]) : 0;\n    if (isNaN(hour) || hour < 0 || hour > 24 || isNaN(minute) || minute < 0 || minute > 60) return null;\n    return hour * 60 + minute;\n  };\n  const localOffset = new Date().getTimezoneOffset();\n\n  // Parse normalized time\n  if (isoTimeString.includes('Z')) {\n    isoTimeString = isoTimeString.replace('Z', '');\n    const minutes = parseBasicMinutes(isoTimeString);\n    if (minutes === null) return null;\n    return (minutes - localOffset + MINUTES_IN_DAY) % MINUTES_IN_DAY;\n  }\n\n  // Parse offset positive time\n  else if (isoTimeString.includes('+')) {\n    const [timeString, offsetString] = isoTimeString.split('+');\n    const minutes = parseBasicMinutes(timeString);\n    let inboundOffset = parseBasicMinutes(offsetString);\n    if (minutes === null || inboundOffset === null) return null;\n\n    // The offset is flipped for consistency with javascript\n    inboundOffset = -inboundOffset;\n    return (minutes + inboundOffset - localOffset + MINUTES_IN_DAY) % MINUTES_IN_DAY;\n  }\n\n  // Parse offset negative time\n  else if (isoTimeString.includes('-')) {\n    const [timeString, offsetString] = isoTimeString.split('-');\n    const minutes = parseBasicMinutes(timeString);\n    let inboundOffset = parseBasicMinutes(offsetString);\n    if (minutes === null || inboundOffset === null) return null;\n    return (minutes + inboundOffset - localOffset + MINUTES_IN_DAY) % MINUTES_IN_DAY;\n  }\n\n  // Default to local parsing\n  else {\n    return parseBasicMinutes(isoTimeString);\n  }\n}\nfunction serializeDate(date) {\n  var d = new Date(date),\n    month = '' + (d.getMonth() + 1),\n    day = '' + d.getDate(),\n    year = d.getFullYear();\n  if (month.length < 2) month = '0' + month;\n  if (day.length < 2) day = '0' + day;\n  return [year, month, day].join('-');\n}\n\n// this method is used to make the `new Date(value)` parsing behavior stricter\nfunction isDateTimeInputInformationSufficient(value) {\n  if (!value || typeof value !== 'string') return false;\n  const segments = value.split('T');\n  if (segments.length != 2) return false;\n  const dateNumbers = segments[0].split('-');\n  if (dateNumbers.length != 3) return false;\n  return true;\n}\n\n// this method checks if the date isn't a datetime, or a partial date\nfunction isDateInputInformationMatching(value) {\n  if (!value || typeof value !== 'string') return false;\n  if (value.includes('T')) return false;\n  const dateNumbers = value.split('-');\n  if (dateNumbers.length != 3) return false;\n  return true;\n}\nfunction serializeDateTime(date, time, timeSerializingFormat) {\n  const workingDate = new Date();\n  workingDate.setFullYear(date.getFullYear(), date.getMonth(), date.getDate());\n  workingDate.setHours(Math.floor(time / 60), time % 60, 0, 0);\n  if (timeSerializingFormat === TIME_SERIALISING_FORMATS.UTC_NORMALIZED) {\n    const timezoneOffsetMinutes = workingDate.getTimezoneOffset();\n    const dayOffset = time + timezoneOffsetMinutes < 0 ? -1 : time + timezoneOffsetMinutes > MINUTES_IN_DAY ? 1 : 0;\n\n    // Apply the date rollover pre-emptively\n    workingDate.setHours(workingDate.getHours() + dayOffset * 24);\n  }\n  return serializeDate(workingDate) + 'T' + serializeTime(time, workingDate.getTimezoneOffset(), timeSerializingFormat);\n}\nfunction formatTimezoneOffset(minutes) {\n  return _getSignedPaddedHours(minutes) + ':' + _getZeroPaddedString(Math.abs(minutes % 60));\n}\nfunction isInvalidDateString(value) {\n  return isNaN(new Date(Date.parse(value)).getTime());\n}\nfunction _getSignedPaddedHours(minutes) {\n  if (minutes > 0) {\n    return '-' + _getZeroPaddedString(Math.floor(minutes / 60));\n  } else {\n    return '+' + _getZeroPaddedString(Math.floor((0 - minutes) / 60));\n  }\n}\nfunction _getZeroPaddedString(time) {\n  return time.toString().padStart(2, '0');\n}\nconst ALLOWED_IMAGE_SRC_PATTERN = /^(https?|data):.*/i; // eslint-disable-line no-useless-escape\nconst ALLOWED_IFRAME_SRC_PATTERN = /^(https):\\/\\/*/i; // eslint-disable-line no-useless-escape\n\nfunction sanitizeDateTimePickerValue(options) {\n  const {\n    formField,\n    value\n  } = options;\n  const {\n    subtype\n  } = formField;\n  if (typeof value !== 'string') return null;\n  if (subtype === DATETIME_SUBTYPES.DATE && (isInvalidDateString(value) || !isDateInputInformationMatching(value))) return null;\n  if (subtype === DATETIME_SUBTYPES.TIME && parseIsoTime(value) === null) return null;\n  if (subtype === DATETIME_SUBTYPES.DATETIME && (isInvalidDateString(value) || !isDateTimeInputInformationSufficient(value))) return null;\n  return value;\n}\nfunction hasEqualValue(value, array) {\n  if (!Array.isArray(array)) {\n    return false;\n  }\n  return array.some(element => isEqual(value, element));\n}\nfunction sanitizeSingleSelectValue(options) {\n  const {\n    formField,\n    data,\n    value\n  } = options;\n  const {\n    valuesExpression: optionsExpression\n  } = formField;\n  try {\n    // if options are expression evaluated, we don't need to sanitize the value against the options\n    // and defer to the field's internal validation\n    if (optionsExpression) {\n      return value;\n    }\n    const validValues = normalizeOptionsData(getSimpleOptionsData(formField, data)).map(v => v.value);\n    return hasEqualValue(value, validValues) ? value : null;\n  } catch (error) {\n    // use default value in case of formatting error\n    // TODO(@Skaiir): log a warning when this happens - https://github.com/bpmn-io/form-js/issues/289\n    return null;\n  }\n}\nfunction sanitizeMultiSelectValue(options) {\n  const {\n    formField,\n    data,\n    value\n  } = options;\n  const {\n    valuesExpression: optionsExpression\n  } = formField;\n  try {\n    // if options are expression evaluated, we don't need to sanitize the values against the options\n    // and defer to the field's internal validation\n    if (optionsExpression) {\n      return value;\n    }\n    const validValues = normalizeOptionsData(getSimpleOptionsData(formField, data)).map(v => v.value);\n    return value.filter(v => hasEqualValue(v, validValues));\n  } catch (error) {\n    // use default value in case of formatting error\n    // TODO(@Skaiir): log a warning when this happens - https://github.com/bpmn-io/form-js/issues/289\n    return [];\n  }\n}\n\n/**\n * Sanitizes an image source to ensure we only allow for data URI and links\n * that start with http(s).\n *\n * Note: Most browsers anyway do not support script execution in <img> elements.\n *\n * @param {string} src\n * @returns {string}\n */\nfunction sanitizeImageSource(src) {\n  const valid = ALLOWED_IMAGE_SRC_PATTERN.test(src);\n  return valid ? src : '';\n}\n\n/**\n * Sanitizes an iframe source to ensure we only allow for links\n * that start with http(s).\n *\n * @param {string} src\n * @returns {string}\n */\nfunction sanitizeIFrameSource(src) {\n  const valid = ALLOWED_IFRAME_SRC_PATTERN.test(src);\n  return valid ? src : '';\n}\n\n/**\n * Escapes HTML and returns pure text.\n * @param {string} html\n * @returns {string}\n */\nfunction escapeHTML(html) {\n  const escapeMap = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#039;',\n    '{': '&#123;',\n    '}': '&#125;',\n    ':': '&#58;',\n    ';': '&#59;'\n  };\n  return html.replace(/[&<>\"'{};:]/g, match => escapeMap[match]);\n}\nfunction useCleanupSingleSelectValue(props) {\n  const {\n    field,\n    options,\n    loadState,\n    onChange,\n    value\n  } = props;\n\n  // Ensures that the value is always one of the possible options\n  useEffect(() => {\n    if (loadState !== LOAD_STATES.LOADED) {\n      return;\n    }\n    const optionValues = options.map(o => o.value);\n    const hasValueNotInOptions = value && !hasEqualValue(value, optionValues);\n    if (hasValueNotInOptions) {\n      onChange({\n        field,\n        value: null\n      });\n    }\n  }, [field, options, onChange, value, loadState]);\n}\nfunction useCleanupMultiSelectValue(props) {\n  const {\n    field,\n    options,\n    loadState,\n    onChange,\n    values\n  } = props;\n  const memoizedValues = useDeepCompareMemoize(values || []);\n\n  // ensures that the values are always a subset of the possible options\n  useEffect(() => {\n    if (loadState !== LOAD_STATES.LOADED) {\n      return;\n    }\n    const optionValues = options.map(o => o.value);\n    const hasValuesNotInOptions = memoizedValues.some(v => !hasEqualValue(v, optionValues));\n    if (hasValuesNotInOptions) {\n      onChange({\n        field,\n        value: memoizedValues.filter(v => hasEqualValue(v, optionValues))\n      });\n    }\n  }, [field, options, onChange, memoizedValues, loadState]);\n}\nfunction Description(props) {\n  const {\n    description,\n    id\n  } = props;\n  const evaluatedDescription = useSingleLineTemplateEvaluation(description || '', {\n    debug: true\n  });\n  if (!evaluatedDescription) {\n    return null;\n  }\n  return jsx(\"div\", {\n    id: id,\n    class: \"fjs-form-field-description\",\n    children: evaluatedDescription\n  });\n}\nfunction Errors(props) {\n  const {\n    errors,\n    id\n  } = props;\n  if (!errors.length) {\n    return null;\n  }\n  return jsx(\"div\", {\n    class: \"fjs-form-field-error\",\n    \"aria-live\": \"polite\",\n    id: id,\n    children: jsx(\"ul\", {\n      children: errors.map(error => {\n        return jsx(\"li\", {\n          children: error\n        });\n      })\n    })\n  });\n}\nfunction Label(props) {\n  const {\n    id,\n    htmlFor,\n    label,\n    collapseOnEmpty = true,\n    required = false\n  } = props;\n  const evaluatedLabel = useSingleLineTemplateEvaluation(label || '', {\n    debug: true\n  });\n  return jsxs(\"label\", {\n    id: id,\n    for: htmlFor,\n    class: classNames('fjs-form-field-label', {\n      'fjs-incollapsible-label': !collapseOnEmpty\n    }, props['class']),\n    children: [props.children, evaluatedLabel, required && jsx(\"span\", {\n      class: \"fjs-asterix\",\n      \"aria-hidden\": true,\n      children: \"*\"\n    })]\n  });\n}\nconst type$f = 'checkbox';\nfunction Checkbox(props) {\n  const {\n    disabled,\n    errors = [],\n    domId,\n    onBlur,\n    onFocus,\n    field,\n    readonly,\n    value = false\n  } = props;\n  const {\n    description,\n    label,\n    validate = {}\n  } = field;\n  const {\n    required\n  } = validate;\n  const onChange = ({\n    target\n  }) => {\n    props.onChange({\n      field,\n      value: target.checked\n    });\n  };\n  const descriptionId = `${domId}-description`;\n  const errorMessageId = `${domId}-error-message`;\n  return jsxs(\"div\", {\n    class: classNames(formFieldClasses(type$f, {\n      errors,\n      disabled,\n      readonly\n    }), {\n      'fjs-checked': value\n    }),\n    children: [jsx(Label, {\n      htmlFor: domId,\n      label: label,\n      required: required,\n      children: jsx(\"input\", {\n        checked: value,\n        class: \"fjs-input\",\n        disabled: disabled,\n        readOnly: readonly,\n        id: domId,\n        type: \"checkbox\",\n        onChange: onChange,\n        onBlur: () => onBlur && onBlur(),\n        onFocus: () => onFocus && onFocus(),\n        required: required,\n        \"aria-invalid\": errors.length > 0,\n        \"aria-describedby\": [descriptionId, errorMessageId].join(' ')\n      })\n    }), jsx(Description, {\n      id: descriptionId,\n      description: description\n    }), jsx(Errors, {\n      id: errorMessageId,\n      errors: errors\n    })]\n  });\n}\nCheckbox.config = {\n  type: type$f,\n  keyed: true,\n  label: 'Checkbox',\n  group: 'selection',\n  emptyValue: false,\n  sanitizeValue: ({\n    value\n  }) => value === true,\n  create: (options = {}) => ({\n    ...options\n  })\n};\nconst type$e = 'checklist';\nfunction Checklist(props) {\n  const {\n    disabled,\n    errors = [],\n    domId,\n    onBlur,\n    onFocus,\n    field,\n    readonly,\n    value: values = []\n  } = props;\n  const {\n    description,\n    label,\n    validate = {}\n  } = field;\n  const outerDivRef = useRef();\n  const {\n    required\n  } = validate;\n  const toggleCheckbox = toggledValue => {\n    const newValues = hasEqualValue(toggledValue, values) ? values.filter(value => !isEqual(value, toggledValue)) : [...values, toggledValue];\n    props.onChange({\n      field,\n      value: newValues\n    });\n  };\n  const onCheckboxBlur = e => {\n    if (outerDivRef.current.contains(e.relatedTarget)) {\n      return;\n    }\n    onBlur && onBlur();\n  };\n  const onCheckboxFocus = e => {\n    if (outerDivRef.current.contains(e.relatedTarget)) {\n      return;\n    }\n    onFocus && onFocus();\n  };\n  const {\n    loadState,\n    options\n  } = useOptionsAsync(field);\n  useCleanupMultiSelectValue({\n    field,\n    loadState,\n    options,\n    values,\n    onChange: props.onChange\n  });\n  const descriptionId = `${domId}-description`;\n  const errorMessageId = `${domId}-error-message`;\n  return jsxs(\"div\", {\n    class: classNames(formFieldClasses(type$e, {\n      errors,\n      disabled,\n      readonly\n    })),\n    ref: outerDivRef,\n    children: [jsx(Label, {\n      label: label,\n      required: required\n    }), loadState == LOAD_STATES.LOADED && options.map((o, index) => {\n      const itemDomId = `${domId}-${index}`;\n      const isChecked = hasEqualValue(o.value, values);\n      return jsx(Label, {\n        htmlFor: itemDomId,\n        label: o.label,\n        class: classNames({\n          'fjs-checked': isChecked\n        }),\n        required: false,\n        children: jsx(\"input\", {\n          checked: isChecked,\n          class: \"fjs-input\",\n          disabled: disabled,\n          readOnly: readonly,\n          id: itemDomId,\n          type: \"checkbox\",\n          onClick: () => toggleCheckbox(o.value),\n          onBlur: onCheckboxBlur,\n          onFocus: onCheckboxFocus,\n          required: required,\n          \"aria-invalid\": errors.length > 0,\n          \"aria-describedby\": [descriptionId, errorMessageId].join(' ')\n        })\n      });\n    }), jsx(Description, {\n      id: descriptionId,\n      description: description\n    }), jsx(Errors, {\n      id: errorMessageId,\n      errors: errors\n    })]\n  });\n}\nChecklist.config = {\n  type: type$e,\n  keyed: true,\n  label: 'Checkbox group',\n  group: 'selection',\n  emptyValue: [],\n  sanitizeValue: sanitizeMultiSelectValue,\n  create: createEmptyOptions\n};\nconst noop$1 = () => false;\nfunction FormField(props) {\n  const {\n    field,\n    indexes,\n    onChange\n  } = props;\n  const formFields = useService('formFields'),\n    viewerCommands = useService('viewerCommands', false),\n    pathRegistry = useService('pathRegistry'),\n    eventBus = useService('eventBus'),\n    form = useService('form');\n  const {\n    initialData,\n    data,\n    errors,\n    properties\n  } = form._getState();\n  const {\n    Element,\n    Hidden,\n    Column\n  } = useContext(FormRenderContext);\n  const {\n    formId\n  } = useContext(FormContext);\n\n  // track whether we should trigger initial validation on certain actions, e.g. field blur\n  // disabled straight away, if viewerCommands are not available\n  const [initialValidationTrigger, setInitialValidationTrigger] = useState(!!viewerCommands);\n  const FormFieldComponent = formFields.get(field.type);\n  if (!FormFieldComponent) {\n    throw new Error(`cannot render field <${field.type}>`);\n  }\n  const valuePath = useMemo(() => pathRegistry.getValuePath(field, {\n    indexes\n  }), [field, indexes, pathRegistry]);\n  const initialValue = useMemo(() => get(initialData, valuePath), [initialData, valuePath]);\n  const readonly = useReadonly(field, properties);\n  const value = get(data, valuePath);\n\n  // add precedence: global readonly > form field disabled\n  const disabled = !properties.readOnly && (properties.disabled || field.disabled || false);\n\n  // ensures the initial validation behavior can be re-triggered upon form reset\n  useEffect(() => {\n    if (!viewerCommands) {\n      return;\n    }\n    const resetValidation = () => {\n      setInitialValidationTrigger(true);\n    };\n    eventBus.on('import.done', resetValidation);\n    eventBus.on('reset', resetValidation);\n    return () => {\n      eventBus.off('import.done', resetValidation);\n      eventBus.off('reset', resetValidation);\n    };\n  }, [eventBus, viewerCommands]);\n  useEffect(() => {\n    if (initialValidationTrigger && initialValue) {\n      setInitialValidationTrigger(false);\n      viewerCommands.updateFieldValidation(field, initialValue, indexes);\n    }\n  }, [viewerCommands, field, initialValue, initialValidationTrigger, indexes]);\n  const onBlur = useCallback(() => {\n    const value = get(data, valuePath);\n    if (initialValidationTrigger) {\n      setInitialValidationTrigger(false);\n      viewerCommands.updateFieldValidation(field, value, indexes);\n    }\n    eventBus.fire('formField.blur', {\n      formField: field\n    });\n  }, [eventBus, field, indexes, viewerCommands, initialValidationTrigger, data, valuePath]);\n  const onFocus = useCallback(() => {\n    eventBus.fire('formField.focus', {\n      formField: field\n    });\n  }, [eventBus, field]);\n  const hidden = useCondition(field.conditional && field.conditional.hide || null);\n  const onChangeIndexed = useCallback(update => {\n    // any data change will trigger validation\n    setInitialValidationTrigger(false);\n\n    // add indexes of the keyed field to the update, if any\n    onChange(FormFieldComponent.config.keyed ? {\n      ...update,\n      indexes\n    } : update);\n  }, [onChange, FormFieldComponent.config.keyed, indexes]);\n  if (hidden) {\n    return jsx(Hidden, {\n      field: field\n    });\n  }\n  const domId = `${prefixId(field.id, formId, indexes)}`;\n  const fieldErrors = get(errors, [field.id, ...Object.values(indexes || {})]) || [];\n  return jsx(Column, {\n    field: field,\n    class: gridColumnClasses(field),\n    children: jsx(Element, {\n      class: \"fjs-element\",\n      field: field,\n      children: jsx(FormFieldComponent, {\n        ...props,\n        disabled: disabled,\n        errors: fieldErrors,\n        domId: domId,\n        onChange: disabled || readonly ? noop$1 : onChangeIndexed,\n        onBlur: disabled || readonly ? noop$1 : onBlur,\n        onFocus: disabled || readonly ? noop$1 : onFocus,\n        readonly: readonly,\n        value: value\n      })\n    })\n  });\n}\nfunction ChildrenRenderer(props) {\n  const {\n    Children\n  } = useContext(FormRenderContext);\n  const {\n    field,\n    Empty\n  } = props;\n  const {\n    id\n  } = field;\n  const repeatRenderManager = useService('repeatRenderManager', false);\n  const isRepeating = repeatRenderManager && repeatRenderManager.isFieldRepeating(id);\n  const Repeater = repeatRenderManager.Repeater;\n  const RepeatFooter = repeatRenderManager.RepeatFooter;\n  return isRepeating ? jsx(RepeatChildrenRenderer, {\n    ...props,\n    ChildrenRoot: Children,\n    Empty,\n    Repeater,\n    RepeatFooter,\n    repeatRenderManager\n  }) : jsx(SimpleChildrenRenderer, {\n    ...props,\n    ChildrenRoot: Children,\n    Empty\n  });\n}\nfunction SimpleChildrenRenderer(props) {\n  const {\n    ChildrenRoot,\n    Empty,\n    field\n  } = props;\n  const {\n    components = []\n  } = field;\n  const isEmpty = !components.length;\n  return jsxs(ChildrenRoot, {\n    class: \"fjs-vertical-layout fjs-children cds--grid cds--grid--condensed\",\n    field: field,\n    children: [jsx(RowsRenderer, {\n      ...props\n    }), isEmpty ? jsx(Empty, {\n      field: field\n    }) : null]\n  });\n}\nfunction RepeatChildrenRenderer(props) {\n  const {\n    ChildrenRoot,\n    repeatRenderManager,\n    Empty,\n    field,\n    ...restProps\n  } = props;\n  const {\n    components = []\n  } = field;\n  const useSharedState = useState({\n    isCollapsed: true\n  });\n  const Repeater = repeatRenderManager.Repeater;\n  const RepeatFooter = repeatRenderManager.RepeatFooter;\n  return jsxs(Fragment, {\n    children: [jsxs(ChildrenRoot, {\n      class: \"fjs-vertical-layout fjs-children cds--grid cds--grid--condensed\",\n      field: field,\n      children: [Repeater ? jsx(Repeater, {\n        ...restProps,\n        useSharedState,\n        field,\n        RowsRenderer\n      }) : jsx(RowsRenderer, {\n        ...restProps,\n        field\n      }), !components.length ? jsx(Empty, {\n        field: field\n      }) : null]\n    }), RepeatFooter ? jsx(RepeatFooter, {\n      ...restProps,\n      useSharedState,\n      field\n    }) : null]\n  });\n}\nfunction RowsRenderer(props) {\n  const {\n    field,\n    indexes\n  } = props;\n  const {\n    id: parentId,\n    verticalAlignment = 'start'\n  } = field;\n  const formLayouter = useService('formLayouter');\n  const formFieldRegistry = useService('formFieldRegistry');\n  const rows = formLayouter.getRows(parentId);\n  const {\n    Row\n  } = useContext(FormRenderContext);\n  return jsxs(Fragment, {\n    children: [\" \", rows.map(row => {\n      const {\n        components = []\n      } = row;\n      if (!components.length) {\n        return null;\n      }\n      return jsx(Row, {\n        row: row,\n        class: \"fjs-layout-row cds--row\",\n        style: {\n          alignItems: verticalAlignment\n        },\n        children: components.map(childId => {\n          const childField = formFieldRegistry.get(childId);\n          if (!childField) {\n            return null;\n          }\n          return createElement(FormField, {\n            ...props,\n            key: childId,\n            field: childField,\n            indexes: indexes\n          });\n        })\n      });\n    }), \" \"]\n  });\n}\nfunction Default(props) {\n  const {\n    Empty\n  } = useContext(FormRenderContext);\n  const fullProps = {\n    ...props,\n    Empty\n  };\n  return jsx(ChildrenRenderer, {\n    ...fullProps\n  });\n}\nDefault.config = {\n  type: 'default',\n  keyed: false,\n  label: null,\n  group: null,\n  create: (options = {}) => ({\n    components: [],\n    ...options\n  })\n};\nvar _path$v;\nfunction _extends$w() {\n  _extends$w = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$w.apply(this, arguments);\n}\nvar SvgCalendar = function SvgCalendar(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$w({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 14,\n    height: 15,\n    fill: \"none\",\n    viewBox: \"0 0 28 30\"\n  }, props), _path$v || (_path$v = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentColor\",\n    fillRule: \"evenodd\",\n    d: \"M19 2H9V0H7v2H2a2 2 0 0 0-2 2v24a2 2 0 0 0 2 2h24a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2h-5V0h-2v2ZM7 7V4H2v5h24V4h-5v3h-2V4H9v3H7Zm-5 4v17h24V11H2Z\",\n    clipRule: \"evenodd\"\n  })));\n};\nvar CalendarIcon = SvgCalendar;\n\n/**\n * Returns date format for the provided locale.\n * If the locale is not provided, uses the browser's locale.\n *\n * @param {string} [locale] - The locale to get date format for.\n * @returns {string} The date format for the locale.\n */\nfunction getLocaleDateFormat(locale = 'default') {\n  const parts = new Intl.DateTimeFormat(locale).formatToParts(new Date(Date.UTC(2020, 5, 5)));\n  return parts.map(part => {\n    const len = part.value.length;\n    switch (part.type) {\n      case 'day':\n        return 'd'.repeat(len);\n      case 'month':\n        return 'M'.repeat(len);\n      case 'year':\n        return 'y'.repeat(len);\n      default:\n        return part.value;\n    }\n  }).join('');\n}\n\n/**\n * Returns readable date format for the provided locale.\n * If the locale is not provided, uses the browser's locale.\n *\n * @param {string} [locale] - The locale to get readable date format for.\n * @returns {string} The readable date format for the locale.\n */\nfunction getLocaleReadableDateFormat(locale) {\n  let format = getLocaleDateFormat(locale).toLowerCase();\n\n  // Ensure month is in 'mm' format\n  if (!format.includes('mm')) {\n    format = format.replace('m', 'mm');\n  }\n\n  // Ensure day is in 'dd' format\n  if (!format.includes('dd')) {\n    format = format.replace('d', 'dd');\n  }\n  return format;\n}\n\n/**\n * Returns flatpickr config for the provided locale.\n * If the locale is not provided, uses the browser's locale.\n *\n * @param {string} [locale] - The locale to get flatpickr config for.\n * @returns {object} The flatpickr config for the locale.\n */\nfunction getLocaleDateFlatpickrConfig(locale) {\n  return flatpickerizeDateFormat(getLocaleDateFormat(locale));\n}\nfunction flatpickerizeDateFormat(dateFormat) {\n  const useLeadingZero = {\n    day: dateFormat.includes('dd'),\n    month: dateFormat.includes('MM'),\n    year: dateFormat.includes('yyyy')\n  };\n  dateFormat = useLeadingZero.day ? dateFormat.replace('dd', 'd') : dateFormat.replace('d', 'j');\n  dateFormat = useLeadingZero.month ? dateFormat.replace('MM', 'm') : dateFormat.replace('M', 'n');\n  dateFormat = useLeadingZero.year ? dateFormat.replace('yyyy', 'Y') : dateFormat.replace('yy', 'y');\n  return dateFormat;\n}\nfunction InputAdorner(props) {\n  const {\n    pre,\n    post,\n    rootRef,\n    inputRef,\n    children,\n    disabled,\n    readonly,\n    hasErrors\n  } = props;\n  const onAdornmentClick = () => inputRef && inputRef.current && inputRef.current.focus();\n  return jsxs(\"div\", {\n    class: classNames('fjs-input-group', {\n      'fjs-disabled': disabled,\n      'fjs-readonly': readonly\n    }, {\n      'hasErrors': hasErrors\n    }),\n    ref: rootRef,\n    children: [pre && jsxs(\"span\", {\n      class: \"fjs-input-adornment border-right border-radius-left\",\n      onClick: onAdornmentClick,\n      children: [\" \", isString(pre) ? jsx(\"span\", {\n        class: \"fjs-input-adornment-text\",\n        children: pre\n      }) : pre, \" \"]\n    }), children, post && jsxs(\"span\", {\n      class: \"fjs-input-adornment border-left border-radius-right\",\n      onClick: onAdornmentClick,\n      children: [\" \", isString(post) ? jsx(\"span\", {\n        class: \"fjs-input-adornment-text\",\n        children: post\n      }) : post, \" \"]\n    })]\n  });\n}\nfunction Datepicker(props) {\n  const {\n    label,\n    domId,\n    collapseLabelOnEmpty,\n    onDateTimeBlur,\n    onDateTimeFocus,\n    required,\n    disabled,\n    disallowPassedDates,\n    date: dateObject,\n    readonly,\n    setDate\n  } = props;\n  const dateInputRef = useRef();\n  const focusScopeRef = useRef();\n  const [flatpickrInstance, setFlatpickrInstance] = useState(null);\n  const [isInputDirty, setIsInputDirty] = useState(false);\n  const [forceFocusCalendar, setForceFocusCalendar] = useState(false);\n\n  // ensures we render based on date value instead of reference\n  const date = useDeepCompareMemoize(dateObject);\n\n  // shorts the date value back to the source\n  useEffect(() => {\n    if (!flatpickrInstance || !flatpickrInstance.config) return;\n    flatpickrInstance.setDate(date, true);\n    setIsInputDirty(false);\n  }, [flatpickrInstance, date]);\n  useEffect(() => {\n    if (!forceFocusCalendar) return;\n    focusRelevantFlatpickerDay(flatpickrInstance);\n    setForceFocusCalendar(false);\n  }, [flatpickrInstance, forceFocusCalendar]);\n\n  // setup flatpickr instance\n  useEffect(() => {\n    let config = {\n      allowInput: true,\n      dateFormat: getLocaleDateFlatpickrConfig(),\n      static: true,\n      clickOpens: false,\n      // TODO: support dates prior to 1900 (https://github.com/bpmn-io/form-js/issues/533)\n      minDate: disallowPassedDates ? 'today' : '01/01/1900',\n      errorHandler: () => {/* do nothing, we expect the values to sometimes be erronous and we don't want warnings polluting the console */}\n    };\n    const instance = flatpickr(dateInputRef.current, config);\n    setFlatpickrInstance(instance);\n    const onCalendarFocusOut = e => {\n      if (!instance.calendarContainer.contains(e.relatedTarget) && e.relatedTarget != dateInputRef.current) {\n        instance.close();\n      }\n    };\n\n    // remove dirty tag to have mouse day selection prioritize input blur\n    const onCalendarMouseDown = e => {\n      if (e.target.classList.contains('flatpickr-day')) {\n        setIsInputDirty(false);\n      }\n    };\n\n    // when the dropdown of the datepickr opens, we register a few event handlers to re-implement some of the\n    // flatpicker logic that was lost when setting allowInput to true\n    instance.config.onOpen = [() => instance.calendarContainer.addEventListener('focusout', onCalendarFocusOut), () => instance.calendarContainer.addEventListener('mousedown', onCalendarMouseDown)];\n    instance.config.onClose = [() => instance.calendarContainer.removeEventListener('focusout', onCalendarFocusOut), () => instance.calendarContainer.removeEventListener('mousedown', onCalendarMouseDown)];\n  }, [disallowPassedDates]);\n\n  // onChange is updated dynamically, so not to re-render the flatpicker every time it changes\n  useEffect(() => {\n    if (!flatpickrInstance || !flatpickrInstance.config) return;\n    flatpickrInstance.config.onChange = [date => setDate(new Date(date)), () => setIsInputDirty(false)];\n  }, [flatpickrInstance, setDate]);\n  const onInputKeyDown = useCallback(e => {\n    if (!flatpickrInstance) return;\n    if (e.code === 'Escape') {\n      flatpickrInstance.close();\n    }\n    if (e.code === 'ArrowDown') {\n      if (isInputDirty) {\n        // trigger an enter keypress to submit the new input, then focus calendar day on the next render cycle\n        dateInputRef.current.dispatchEvent(ENTER_KEYDOWN_EVENT);\n        setIsInputDirty(false);\n        setForceFocusCalendar(true);\n      } else {\n        // focus calendar day immediately\n        focusRelevantFlatpickerDay(flatpickrInstance);\n      }\n      e.preventDefault();\n    }\n    if (e.code === 'Enter') {\n      setIsInputDirty(false);\n    }\n  }, [flatpickrInstance, isInputDirty]);\n  const onInputFocus = useCallback(e => {\n    if (!flatpickrInstance || focusScopeRef.current.contains(e.relatedTarget) || readonly) return;\n    flatpickrInstance.open();\n    onDateTimeFocus(e);\n  }, [flatpickrInstance, readonly, onDateTimeFocus]);\n\n  // simulate an enter press on blur to make sure the date value is submitted in all scenarios\n  const onInputBlur = useCallback(e => {\n    const isFalseBlur = e.relatedTarget && e.relatedTarget.classList.contains('flatpickr-day');\n    if (isFalseBlur) return;\n    if (isInputDirty) {\n      dateInputRef.current.dispatchEvent(ENTER_KEYDOWN_EVENT);\n      setIsInputDirty(false);\n    }\n    onDateTimeBlur(e);\n  }, [isInputDirty, onDateTimeBlur]);\n  return jsxs(\"div\", {\n    class: \"fjs-datetime-subsection\",\n    children: [jsx(Label, {\n      htmlFor: domId,\n      label: label,\n      collapseOnEmpty: collapseLabelOnEmpty,\n      required: required\n    }), jsx(InputAdorner, {\n      pre: jsx(CalendarIcon, {}),\n      disabled: disabled,\n      readonly: readonly,\n      rootRef: focusScopeRef,\n      inputRef: dateInputRef,\n      children: jsx(\"div\", {\n        class: \"fjs-datepicker\",\n        style: {\n          width: '100%'\n        },\n        children: jsx(\"input\", {\n          ref: dateInputRef,\n          type: \"text\",\n          id: domId,\n          class: \"fjs-input\",\n          disabled: disabled,\n          readOnly: readonly,\n          placeholder: getLocaleReadableDateFormat(),\n          autoComplete: \"off\",\n          onFocus: onInputFocus,\n          onBlur: onInputBlur,\n          onKeyDown: onInputKeyDown,\n          onMouseDown: () => !flatpickrInstance.isOpen && !readonly && flatpickrInstance.open(),\n          onInput: () => setIsInputDirty(true),\n          \"data-input\": true,\n          \"aria-describedby\": props['aria-describedby']\n        })\n      })\n    })]\n  });\n}\nvar _path$u, _path2$5;\nfunction _extends$v() {\n  _extends$v = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$v.apply(this, arguments);\n}\nvar SvgClock = function SvgClock(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$v({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 16,\n    height: 16,\n    fill: \"none\",\n    viewBox: \"0 0 28 29\"\n  }, props), _path$u || (_path$u = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentColor\",\n    d: \"M13 14.41 18.59 20 20 18.59l-5-5.01V5h-2v9.41Z\"\n  })), _path2$5 || (_path2$5 = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentColor\",\n    fillRule: \"evenodd\",\n    d: \"M6.222 25.64A14 14 0 1 0 21.778 2.36 14 14 0 0 0 6.222 25.64ZM7.333 4.023a12 12 0 1 1 13.334 19.955A12 12 0 0 1 7.333 4.022Z\",\n    clipRule: \"evenodd\"\n  })));\n};\nvar ClockIcon = SvgClock;\nconst DEFAULT_LABEL_GETTER = value => value;\nconst NOOP = () => {};\nfunction DropdownList(props) {\n  const {\n    listenerElement = window,\n    values = [],\n    getLabel = DEFAULT_LABEL_GETTER,\n    onValueSelected = NOOP,\n    height = 235,\n    emptyListMessage = 'No results',\n    initialFocusIndex = 0\n  } = props;\n  const [mouseControl, setMouseControl] = useState(false);\n  const [focusedValueIndex, setFocusedValueIndex] = useState(initialFocusIndex);\n  const [smoothScrolling, setSmoothScrolling] = useState(false);\n  const dropdownContainer = useRef();\n  const mouseScreenPos = useRef();\n  const focusedItem = useMemo(() => values.length ? values[focusedValueIndex] : null, [focusedValueIndex, values]);\n  const changeFocusedValueIndex = useCallback(delta => {\n    setFocusedValueIndex(x => Math.min(Math.max(0, x + delta), values.length - 1));\n  }, [values.length]);\n  useEffect(() => {\n    if (focusedValueIndex === 0) return;\n    if (!focusedValueIndex || !values.length) {\n      setFocusedValueIndex(0);\n    } else if (focusedValueIndex >= values.length) {\n      setFocusedValueIndex(values.length - 1);\n    }\n  }, [focusedValueIndex, values.length]);\n  useKeyDownAction('ArrowUp', () => {\n    if (values.length) {\n      changeFocusedValueIndex(-1);\n      setMouseControl(false);\n    }\n  }, listenerElement);\n  useKeyDownAction('ArrowDown', () => {\n    if (values.length) {\n      changeFocusedValueIndex(1);\n      setMouseControl(false);\n    }\n  }, listenerElement);\n  useKeyDownAction('Enter', () => {\n    if (focusedItem) {\n      onValueSelected(focusedItem);\n    }\n  }, listenerElement);\n  useEffect(() => {\n    const individualEntries = dropdownContainer.current.children;\n    if (individualEntries.length && !mouseControl) {\n      const focusedEntry = individualEntries[focusedValueIndex];\n      focusedEntry && focusedEntry.scrollIntoView({\n        block: 'nearest',\n        inline: 'nearest'\n      });\n    }\n  }, [focusedValueIndex, mouseControl]);\n  useEffect(() => {\n    setSmoothScrolling(true);\n  }, []);\n  const onMouseMovedInKeyboardMode = (event, valueIndex) => {\n    const userMovedCursor = !mouseScreenPos.current || mouseScreenPos.current.x !== event.screenX && mouseScreenPos.current.y !== event.screenY;\n    if (userMovedCursor) {\n      mouseScreenPos.current = {\n        x: event.screenX,\n        y: event.screenY\n      };\n      setMouseControl(true);\n      setFocusedValueIndex(valueIndex);\n    }\n  };\n  return jsxs(\"div\", {\n    ref: dropdownContainer,\n    tabIndex: -1,\n    class: \"fjs-dropdownlist\",\n    onMouseDown: e => e.preventDefault(),\n    style: {\n      maxHeight: height,\n      scrollBehavior: smoothScrolling ? 'smooth' : 'auto'\n    },\n    children: [values.length > 0 && values.map((v, i) => {\n      return jsx(\"div\", {\n        class: classNames('fjs-dropdownlist-item', {\n          'focused': focusedValueIndex === i\n        }),\n        onMouseMove: mouseControl ? undefined : e => onMouseMovedInKeyboardMode(e, i),\n        onMouseEnter: mouseControl ? () => setFocusedValueIndex(i) : undefined,\n        onMouseDown: e => onValueSelected(v),\n        children: getLabel(v)\n      });\n    }), !values.length && jsx(\"div\", {\n      class: \"fjs-dropdownlist-empty\",\n      children: emptyListMessage\n    })]\n  });\n}\nfunction Timepicker(props) {\n  const {\n    label,\n    collapseLabelOnEmpty,\n    onDateTimeBlur,\n    onDateTimeFocus,\n    domId,\n    required,\n    disabled,\n    readonly,\n    use24h = false,\n    timeInterval,\n    time,\n    setTime\n  } = props;\n  const safeTimeInterval = useMemo(() => {\n    const allowedIntervals = [1, 5, 10, 15, 30, 60];\n    if (allowedIntervals.includes(timeInterval)) {\n      return timeInterval;\n    }\n    return 15;\n  }, [timeInterval]);\n  const timeInputRef = useRef();\n  const [dropdownIsOpen, setDropdownIsOpen] = useState(false);\n  const useDropdown = useMemo(() => safeTimeInterval !== 1, [safeTimeInterval]);\n  const [rawValue, setRawValue] = useState('');\n\n  // populates values from source\n  useEffect(() => {\n    if (time === null) {\n      setRawValue('');\n      return;\n    }\n    const intervalAdjustedTime = time - time % safeTimeInterval;\n    setRawValue(formatTime(use24h, intervalAdjustedTime));\n    if (intervalAdjustedTime != time) {\n      setTime(intervalAdjustedTime);\n    }\n  }, [time, setTime, use24h, safeTimeInterval]);\n  const propagateRawToMinute = useCallback(newRawValue => {\n    const localRawValue = newRawValue || rawValue;\n\n    // If no raw value exists, set the minute to null\n    if (!localRawValue) {\n      setTime(null);\n      return;\n    }\n    const minutes = parseInputTime(localRawValue);\n\n    // If raw string couldn't be parsed, clean everything up\n    if (!isNumber(minutes)) {\n      setRawValue('');\n      setTime(null);\n      return;\n    }\n\n    // Enforce the minutes to match the timeInterval\n    const correctedMinutes = minutes - minutes % safeTimeInterval;\n\n    // Enforce the raw text to be formatted properly\n    setRawValue(formatTime(use24h, correctedMinutes));\n    setTime(correctedMinutes);\n  }, [rawValue, safeTimeInterval, use24h, setTime]);\n  const timeOptions = useMemo(() => {\n    const minutesInDay = 24 * 60;\n    const intervalCount = Math.floor(minutesInDay / safeTimeInterval);\n    return [...Array(intervalCount).keys()].map(intervalIndex => formatTime(use24h, intervalIndex * safeTimeInterval));\n  }, [safeTimeInterval, use24h]);\n  const initialFocusIndex = useMemo(() => {\n    // if there are no options, there will not be any focusing\n    if (!timeOptions || !safeTimeInterval) return null;\n\n    // if there is a set minute value, we focus it in the dropdown\n    if (time) return time / safeTimeInterval;\n    const cacheTime = parseInputTime(rawValue);\n\n    // if there is a valid value in the input cache, we try and focus close to it\n    if (cacheTime) {\n      const flooredCacheTime = cacheTime - cacheTime % safeTimeInterval;\n      return flooredCacheTime / safeTimeInterval;\n    }\n\n    // If there is no set value, simply focus the middle of the dropdown (12:00)\n    return Math.floor(timeOptions.length / 2);\n  }, [rawValue, time, safeTimeInterval, timeOptions]);\n  const onInputKeyDown = e => {\n    switch (e.key) {\n      case 'ArrowUp':\n        e.preventDefault();\n        break;\n      case 'ArrowDown':\n        useDropdown && setDropdownIsOpen(true);\n        e.preventDefault();\n        break;\n      case 'Escape':\n        useDropdown && setDropdownIsOpen(false);\n        break;\n      case 'Enter':\n        !dropdownIsOpen && propagateRawToMinute();\n        break;\n    }\n  };\n  const onInputBlur = e => {\n    setDropdownIsOpen(false);\n    propagateRawToMinute();\n    onDateTimeBlur(e);\n  };\n  const onInputFocus = e => {\n    onDateTimeFocus(e);\n    !readonly && useDropdown && setDropdownIsOpen(true);\n  };\n  const onDropdownValueSelected = value => {\n    setDropdownIsOpen(false);\n    propagateRawToMinute(value);\n  };\n  return jsxs(\"div\", {\n    class: \"fjs-datetime-subsection\",\n    children: [jsx(Label, {\n      htmlFor: domId,\n      label: label,\n      collapseOnEmpty: collapseLabelOnEmpty,\n      required: required\n    }), jsx(InputAdorner, {\n      pre: jsx(ClockIcon, {}),\n      inputRef: timeInputRef,\n      disabled: disabled,\n      readonly: readonly,\n      children: jsxs(\"div\", {\n        class: \"fjs-timepicker fjs-timepicker-anchor\",\n        children: [jsx(\"input\", {\n          ref: timeInputRef,\n          type: \"text\",\n          id: domId,\n          class: \"fjs-input\",\n          value: rawValue,\n          disabled: disabled,\n          readOnly: readonly,\n          placeholder: use24h ? 'hh:mm' : 'hh:mm ?m',\n          autoComplete: \"off\"\n\n          // @ts-ignore\n          ,\n\n          onInput: e => {\n            setRawValue(e.target.value);\n            useDropdown && setDropdownIsOpen(false);\n          },\n          onBlur: onInputBlur,\n          onFocus: onInputFocus,\n          onClick: () => !readonly && useDropdown && setDropdownIsOpen(true),\n          onKeyDown: onInputKeyDown,\n          \"data-input\": true,\n          \"aria-describedby\": props['aria-describedby']\n        }), dropdownIsOpen && jsx(DropdownList, {\n          values: timeOptions,\n          height: 150,\n          onValueSelected: onDropdownValueSelected,\n          listenerElement: timeInputRef.current,\n          initialFocusIndex: initialFocusIndex\n        })]\n      })\n    })]\n  });\n}\nconst type$d = 'datetime';\nfunction Datetime(props) {\n  const {\n    disabled,\n    errors = [],\n    domId,\n    onBlur,\n    onFocus,\n    field,\n    onChange,\n    readonly,\n    value = ''\n  } = props;\n  const {\n    description,\n    id,\n    dateLabel,\n    timeLabel,\n    validate = {},\n    subtype,\n    use24h,\n    disallowPassedDates,\n    timeInterval,\n    timeSerializingFormat\n  } = field;\n  const {\n    required\n  } = validate;\n  const {\n    formId\n  } = useContext(FormContext);\n  const dateTimeGroupRef = useRef();\n  const getNullDateTime = () => ({\n    date: new Date(Date.parse(null)),\n    time: null\n  });\n  const [dateTime, setDateTime] = useState(getNullDateTime());\n  const [dateTimeUpdateRequest, setDateTimeUpdateRequest] = useState(null);\n  const isValidDate = date => date && !isNaN(date.getTime());\n  const isValidTime = time => !isNaN(parseInt(time));\n  const useDatePicker = useMemo(() => subtype === DATETIME_SUBTYPES.DATE || subtype === DATETIME_SUBTYPES.DATETIME, [subtype]);\n  const useTimePicker = useMemo(() => subtype === DATETIME_SUBTYPES.TIME || subtype === DATETIME_SUBTYPES.DATETIME, [subtype]);\n  const onDateTimeBlur = useCallback(e => {\n    if (e.relatedTarget && dateTimeGroupRef.current.contains(e.relatedTarget)) {\n      return;\n    }\n    onBlur && onBlur();\n  }, [onBlur]);\n  const onDateTimeFocus = useCallback(e => {\n    if (e.relatedTarget && dateTimeGroupRef.current.contains(e.relatedTarget)) {\n      return;\n    }\n    onFocus && onFocus();\n  }, [onFocus]);\n  useEffect(() => {\n    let {\n      date,\n      time\n    } = getNullDateTime();\n    switch (subtype) {\n      case DATETIME_SUBTYPES.DATE:\n        {\n          date = new Date(Date.parse(value));\n          break;\n        }\n      case DATETIME_SUBTYPES.TIME:\n        {\n          time = parseIsoTime(value);\n          break;\n        }\n      case DATETIME_SUBTYPES.DATETIME:\n        {\n          date = new Date(Date.parse(value));\n          time = isValidDate(date) ? 60 * date.getHours() + date.getMinutes() : null;\n          break;\n        }\n    }\n    setDateTime({\n      date,\n      time\n    });\n  }, [subtype, value]);\n  const computeAndSetState = useCallback(({\n    date,\n    time\n  }) => {\n    let newDateTimeValue = null;\n    if (subtype === DATETIME_SUBTYPES.DATE && isValidDate(date)) {\n      newDateTimeValue = serializeDate(date);\n    } else if (subtype === DATETIME_SUBTYPES.TIME && isValidTime(time)) {\n      newDateTimeValue = serializeTime(time, new Date().getTimezoneOffset(), timeSerializingFormat);\n    } else if (subtype === DATETIME_SUBTYPES.DATETIME && isValidDate(date) && isValidTime(time)) {\n      newDateTimeValue = serializeDateTime(date, time, timeSerializingFormat);\n    }\n    onChange({\n      value: newDateTimeValue,\n      field\n    });\n  }, [field, onChange, subtype, timeSerializingFormat]);\n  useEffect(() => {\n    if (dateTimeUpdateRequest) {\n      if (dateTimeUpdateRequest.refreshOnly) {\n        computeAndSetState(dateTime);\n      } else {\n        const newDateTime = {\n          ...dateTime,\n          ...dateTimeUpdateRequest\n        };\n        setDateTime(newDateTime);\n        computeAndSetState(newDateTime);\n      }\n      setDateTimeUpdateRequest(null);\n    }\n  }, [computeAndSetState, dateTime, dateTimeUpdateRequest]);\n  useEffect(() => {\n    setDateTimeUpdateRequest({\n      refreshOnly: true\n    });\n  }, [timeSerializingFormat]);\n  const allErrors = useMemo(() => {\n    if (required || subtype !== DATETIME_SUBTYPES.DATETIME) return errors;\n    const isOnlyOneFieldSet = isValidDate(dateTime.date) && !isValidTime(dateTime.time) || !isValidDate(dateTime.date) && isValidTime(dateTime.time);\n    return isOnlyOneFieldSet ? ['Date and time must both be entered.', ...errors] : errors;\n  }, [required, subtype, dateTime, errors]);\n  const setDate = useCallback(date => {\n    setDateTimeUpdateRequest(prev => prev ? {\n      ...prev,\n      date\n    } : {\n      date\n    });\n  }, []);\n  const setTime = useCallback(time => {\n    setDateTimeUpdateRequest(prev => prev ? {\n      ...prev,\n      time\n    } : {\n      time\n    });\n  }, []);\n  const errorMessageId = allErrors.length === 0 ? undefined : `${prefixId(id, formId)}-error-message`;\n  const descriptionId = `${prefixId(id, formId)}-description`;\n  const datePickerProps = {\n    label: dateLabel,\n    collapseLabelOnEmpty: !timeLabel,\n    onDateTimeBlur,\n    onDateTimeFocus,\n    domId: `${domId}-date`,\n    required,\n    disabled,\n    disallowPassedDates,\n    date: dateTime.date,\n    readonly,\n    setDate,\n    'aria-describedby': [descriptionId, errorMessageId].join(' ')\n  };\n  const timePickerProps = {\n    label: timeLabel,\n    collapseLabelOnEmpty: !dateLabel,\n    onDateTimeBlur,\n    onDateTimeFocus,\n    domId: `${domId}-time`,\n    required,\n    disabled,\n    readonly,\n    use24h,\n    timeInterval,\n    time: dateTime.time,\n    setTime,\n    'aria-describedby': [descriptionId, errorMessageId].join(' ')\n  };\n  return jsxs(\"div\", {\n    class: formFieldClasses(type$d, {\n      errors: allErrors,\n      disabled,\n      readonly\n    }),\n    children: [jsxs(\"div\", {\n      class: classNames('fjs-vertical-group'),\n      ref: dateTimeGroupRef,\n      children: [useDatePicker && jsx(Datepicker, {\n        ...datePickerProps\n      }), useTimePicker && useDatePicker && jsx(\"div\", {\n        class: \"fjs-datetime-separator\"\n      }), useTimePicker && jsx(Timepicker, {\n        ...timePickerProps\n      })]\n    }), jsx(Description, {\n      id: descriptionId,\n      description: description\n    }), jsx(Errors, {\n      errors: allErrors,\n      id: errorMessageId\n    })]\n  });\n}\nDatetime.config = {\n  type: type$d,\n  keyed: true,\n  label: 'Date time',\n  group: 'basic-input',\n  emptyValue: null,\n  sanitizeValue: sanitizeDateTimePickerValue,\n  create: (options = {}) => {\n    const defaults = {};\n    set(defaults, DATETIME_SUBTYPE_PATH, DATETIME_SUBTYPES.DATE);\n    set(defaults, DATE_LABEL_PATH, 'Date');\n    return {\n      ...defaults,\n      ...options\n    };\n  }\n};\nfunction Group(props) {\n  const {\n    field,\n    domId\n  } = props;\n  const {\n    label,\n    type,\n    showOutline\n  } = field;\n  const {\n    Empty\n  } = useContext(FormRenderContext);\n  const fullProps = {\n    ...props,\n    Empty\n  };\n  return jsxs(\"div\", {\n    className: classNames(formFieldClasses(type), 'fjs-form-field-grouplike', {\n      'fjs-outlined': showOutline\n    }),\n    role: \"group\",\n    \"aria-labelledby\": domId,\n    children: [jsx(Label, {\n      id: domId,\n      label: label\n    }), jsx(ChildrenRenderer, {\n      ...fullProps\n    })]\n  });\n}\nGroup.config = {\n  type: 'group',\n  pathed: true,\n  label: 'Group',\n  group: 'container',\n  create: (options = {}) => ({\n    components: [],\n    showOutline: true,\n    ...options\n  })\n};\nconst type$c = 'iframe';\nconst DEFAULT_HEIGHT = 300;\nfunction IFrame(props) {\n  const {\n    field,\n    disabled,\n    readonly,\n    domId\n  } = props;\n  const {\n    height = DEFAULT_HEIGHT,\n    label,\n    url,\n    security = {}\n  } = field;\n  const evaluatedUrl = useSingleLineTemplateEvaluation(url, {\n    debug: true\n  });\n  const safeUrl = useMemo(() => sanitizeIFrameSource(evaluatedUrl), [evaluatedUrl]);\n  const evaluatedLabel = useSingleLineTemplateEvaluation(label, {\n    debug: true\n  });\n  const [sandbox, allow] = useSecurityAttributesMap(security);\n  const [iframeRefresh, setIframeRefresh] = useState(0);\n\n  // forces re-render of iframe when sandbox or allow attributes change, as browsers do not do it automatically\n  useEffect(() => {\n    setIframeRefresh(count => count + 1);\n  }, [sandbox, allow]);\n  return jsxs(\"div\", {\n    class: formFieldClasses(type$c, {\n      disabled,\n      readonly\n    }),\n    children: [jsx(Label, {\n      htmlFor: domId,\n      label: evaluatedLabel\n    }), !evaluatedUrl && jsx(IFramePlaceholder, {\n      text: \"No content to show.\"\n    }), evaluatedUrl && safeUrl && jsx(\"iframe\", {\n      src: safeUrl,\n      title: evaluatedLabel,\n      height: height,\n      class: \"fjs-iframe\",\n      id: domId,\n      sandbox: sandbox,\n      allow\n    }, 'iframe-' + iframeRefresh), evaluatedUrl && !safeUrl && jsx(IFramePlaceholder, {\n      text: \"External content couldn't be loaded.\"\n    })]\n  });\n}\nfunction IFramePlaceholder(props) {\n  const {\n    text = 'iFrame'\n  } = props;\n  return jsx(\"div\", {\n    class: \"fjs-iframe-placeholder\",\n    children: jsx(\"p\", {\n      class: \"fjs-iframe-placeholder-text\",\n      children: text\n    })\n  });\n}\nIFrame.config = {\n  type: type$c,\n  keyed: false,\n  label: 'iFrame',\n  group: 'container',\n  create: (options = {}) => ({\n    security: {\n      allowScripts: true\n    },\n    ...options\n  })\n};\nvar _path$t;\nfunction _extends$u() {\n  _extends$u = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$u.apply(this, arguments);\n}\nvar SvgButton = function SvgButton(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$u({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 54,\n    height: 54,\n    fill: \"currentcolor\"\n  }, props), _path$t || (_path$t = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    d: \"M45 17a3 3 0 0 1 3 3v14a3 3 0 0 1-3 3H9a3 3 0 0 1-3-3V20a3 3 0 0 1 3-3h36zm-9 8.889H18v2.222h18v-2.222z\"\n  })));\n};\nvar ButtonIcon = SvgButton;\nvar _path$s;\nfunction _extends$t() {\n  _extends$t = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$t.apply(this, arguments);\n}\nvar SvgCheckbox = function SvgCheckbox(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$t({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 54,\n    height: 54,\n    fill: \"currentcolor\"\n  }, props), _path$s || (_path$s = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M34 18H20a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V20a2 2 0 0 0-2-2zm-9 14-5-5 1.41-1.41L25 29.17l7.59-7.59L34 23l-9 9z\"\n  })));\n};\nvar CheckboxIcon = SvgCheckbox;\nvar _path$r;\nfunction _extends$s() {\n  _extends$s = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$s.apply(this, arguments);\n}\nvar SvgChecklist = function SvgChecklist(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$s({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 54,\n    height: 54,\n    fill: \"none\"\n  }, props), _path$r || (_path$r = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentColor\",\n    fillRule: \"evenodd\",\n    d: \"M14.35 24.75H19v4.65h-4.65v-4.65Zm-1.414-1.414a2 2 0 0 1 1.414-.586H19a2 2 0 0 1 2 2v4.65a2 2 0 0 1-2 2h-4.65a2 2 0 0 1-2-2v-4.65a2 2 0 0 1 .586-1.414ZM14.35 37.05H19v4.65h-4.65v-4.65Zm-1.414-1.414a2 2 0 0 1 1.414-.586H19a2 2 0 0 1 2 2v4.65a2 2 0 0 1-2 2h-4.65a2 2 0 0 1-2-2v-4.65a2 2 0 0 1 .586-1.414ZM14.35 12.45H19v4.65h-4.65v-4.65Zm-1.414-1.414a2 2 0 0 1 1.414-.586H19a2 2 0 0 1 2 2v4.65a2 2 0 0 1-2 2h-4.65a2 2 0 0 1-2-2v-4.65a2 2 0 0 1 .586-1.414Zm12.007 14.977a1 1 0 0 0-.293.707v.65a1 1 0 0 0 1 1h15a1 1 0 0 0 1-1v-.65a1 1 0 0 0-1-1h-15a1 1 0 0 0-.707.293Zm0 12.3a1 1 0 0 0-.293.707v.65a1 1 0 0 0 1 1h15a1 1 0 0 0 1-1v-.65a1 1 0 0 0-1-1h-15a1 1 0 0 0-.707.293Zm0-24.6a1 1 0 0 0-.293.707v.65a1 1 0 0 0 1 1h15a1 1 0 0 0 1-1v-.65a1 1 0 0 0-1-1h-15a1 1 0 0 0-.707.293Z\",\n    clipRule: \"evenodd\"\n  })));\n};\nvar ChecklistIcon = SvgChecklist;\nvar _path$q, _path2$4, _path3;\nfunction _extends$r() {\n  _extends$r = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$r.apply(this, arguments);\n}\nvar SvgDatetime = function SvgDatetime(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$r({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 54,\n    height: 54,\n    fill: \"currentcolor\"\n  }, props), _path$q || (_path$q = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    d: \"M37.908 13.418h-5.004v-2.354h-1.766v2.354H21.13v-2.354h-1.766v2.354H14.36a2.07 2.07 0 0 0-2.06 2.06v23.549a2.07 2.07 0 0 0 2.06 2.06h6.77v-1.766h-6.358a.707.707 0 0 1-.706-.706V15.89c0-.39.316-.707.706-.707h4.592v2.355h1.766v-2.355h10.008v2.355h1.766v-2.355h4.592a.71.71 0 0 1 .707.707v6.358h1.765v-6.77c0-1.133-.927-2.06-2.06-2.06z\"\n  })), _path2$4 || (_path2$4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m35.13 37.603 1.237-1.237-3.468-3.475v-5.926h-1.754v6.654l3.984 3.984Z\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    d: \"M23.08 36.962a9.678 9.678 0 1 0 17.883-7.408 9.678 9.678 0 0 0-17.882 7.408Zm4.54-10.292a7.924 7.924 0 1 1 8.805 13.177A7.924 7.924 0 0 1 27.62 26.67Z\"\n  })));\n};\nvar DatetimeIcon = SvgDatetime;\nvar _path$p, _path2$3;\nfunction _extends$q() {\n  _extends$q = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$q.apply(this, arguments);\n}\nvar SvgTaglist = function SvgTaglist(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$q({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 54,\n    height: 54,\n    fill: \"currentcolor\"\n  }, props), _path$p || (_path$p = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    d: \"M45 16a3 3 0 0 1 3 3v16a3 3 0 0 1-3 3H9a3 3 0 0 1-3-3V19a3 3 0 0 1 3-3h36Zm0 2H9a1 1 0 0 0-1 1v16a1 1 0 0 0 1 1h36a1 1 0 0 0 1-1V19a1 1 0 0 0-1-1Z\"\n  })), _path2$3 || (_path2$3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M11 22a1 1 0 0 1 1-1h19a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H12a1 1 0 0 1-1-1V22Z\"\n  })));\n};\nvar TaglistIcon = SvgTaglist;\nvar _rect, _rect2, _rect3;\nfunction _extends$p() {\n  _extends$p = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$p.apply(this, arguments);\n}\nvar SvgForm = function SvgForm(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$p({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 54,\n    height: 54\n  }, props), _rect || (_rect = /*#__PURE__*/React.createElement(\"rect\", {\n    width: 24,\n    height: 4,\n    x: 15,\n    y: 17,\n    rx: 1\n  })), _rect2 || (_rect2 = /*#__PURE__*/React.createElement(\"rect\", {\n    width: 24,\n    height: 4,\n    x: 15,\n    y: 25,\n    rx: 1\n  })), _rect3 || (_rect3 = /*#__PURE__*/React.createElement(\"rect\", {\n    width: 13,\n    height: 4,\n    x: 15,\n    y: 33,\n    rx: 1\n  })));\n};\nvar FormIcon = SvgForm;\nvar _path$o;\nfunction _extends$o() {\n  _extends$o = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$o.apply(this, arguments);\n}\nvar SvgGroup = function SvgGroup(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$o({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 54,\n    height: 54,\n    fill: \"currentcolor\"\n  }, props), _path$o || (_path$o = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    d: \"M8 33v5a1 1 0 0 0 1 1h4v2H9a3 3 0 0 1-3-3v-5h2Zm18 6v2H15v-2h11Zm13 0v2H28v-2h11Zm9-6v5a3 3 0 0 1-3 3h-4v-2h4a1 1 0 0 0 .993-.883L46 38v-5h2ZM8 22v9H6v-9h2Zm40 0v9h-2v-9h2Zm-35-9v2H9a1 1 0 0 0-.993.883L8 16v4H6v-4a3 3 0 0 1 3-3h4Zm32 0a3 3 0 0 1 3 3v4h-2v-4a1 1 0 0 0-.883-.993L45 15h-4v-2h4Zm-6 0v2H28v-2h11Zm-13 0v2H15v-2h11Z\"\n  })));\n};\nvar GroupIcon = SvgGroup;\nvar _path$n;\nfunction _extends$n() {\n  _extends$n = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$n.apply(this, arguments);\n}\nvar SvgNumber = function SvgNumber(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$n({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 54,\n    height: 54,\n    fill: \"currentcolor\"\n  }, props), _path$n || (_path$n = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    d: \"M45 16a3 3 0 0 1 3 3v16a3 3 0 0 1-3 3H9a3 3 0 0 1-3-3V19a3 3 0 0 1 3-3h36zm0 2H9a1 1 0 0 0-1 1v16a1 1 0 0 0 1 1h36a1 1 0 0 0 1-1V19a1 1 0 0 0-1-1zM35 28.444h7l-3.5 4-3.5-4zM35 26h7l-3.5-4-3.5 4z\"\n  })));\n};\nvar NumberIcon = SvgNumber;\nvar _path$m;\nfunction _extends$m() {\n  _extends$m = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$m.apply(this, arguments);\n}\nvar SvgRadio = function SvgRadio(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$m({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 54,\n    height: 54,\n    fill: \"currentcolor\"\n  }, props), _path$m || (_path$m = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M27 22c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm0-5c-5.52 0-10 4.48-10 10s4.48 10 10 10 10-4.48 10-10-4.48-10-10-10zm0 18a8 8 0 1 1 0-16 8 8 0 1 1 0 16z\"\n  })));\n};\nvar RadioIcon = SvgRadio;\nvar _path$l;\nfunction _extends$l() {\n  _extends$l = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$l.apply(this, arguments);\n}\nvar SvgSelect = function SvgSelect(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$l({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 54,\n    height: 54,\n    fill: \"currentcolor\"\n  }, props), _path$l || (_path$l = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    d: \"M45 16a3 3 0 0 1 3 3v16a3 3 0 0 1-3 3H9a3 3 0 0 1-3-3V19a3 3 0 0 1 3-3h36zm0 2H9a1 1 0 0 0-1 1v16a1 1 0 0 0 1 1h36a1 1 0 0 0 1-1V19a1 1 0 0 0-1-1zm-12 7h9l-4.5 6-4.5-6z\"\n  })));\n};\nvar SelectIcon = SvgSelect;\nvar _path$k;\nfunction _extends$k() {\n  _extends$k = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$k.apply(this, arguments);\n}\nvar SvgSeparator = function SvgSeparator(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$k({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 54,\n    height: 54,\n    fill: \"none\"\n  }, props), _path$k || (_path$k = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentColor\",\n    d: \"M26.293 16.293a1 1 0 0 1 1.414 0l4 4a1 1 0 0 1-1.414 1.414L27 18.414l-3.293 3.293a1 1 0 0 1-1.414-1.414l4-4ZM9 26h36v2H9v-2Zm13.293 7.707 4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0-1.414-1.414L27 35.586l-3.293-3.293a1 1 0 0 0-1.414 1.414Z\"\n  })));\n};\nvar SeparatorIcon = SvgSeparator;\nvar _path$j;\nfunction _extends$j() {\n  _extends$j = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$j.apply(this, arguments);\n}\nvar SvgSpacer = function SvgSpacer(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$j({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 54,\n    height: 54,\n    fill: \"none\"\n  }, props), _path$j || (_path$j = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentColor\",\n    d: \"M9 15v2h36v-2H9Zm0 22v2h36v-2H9Zm17.293-17.707a1 1 0 0 1 1.414 0l4 4a1 1 0 0 1-1.414 1.414L27 21.414l-3.293 3.293a1 1 0 0 1-1.414-1.414l4-4Zm-4 11.414 4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0-1.414-1.414L27 32.586l-3.293-3.293a1 1 0 0 0-1.414 1.414Z\"\n  })));\n};\nvar SpacerIcon = SvgSpacer;\nvar _path$i;\nfunction _extends$i() {\n  _extends$i = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$i.apply(this, arguments);\n}\nvar SvgDynamicList = function SvgDynamicList(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$i({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 54,\n    height: 54,\n    fill: \"none\"\n  }, props), _path$i || (_path$i = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentColor\",\n    fillRule: \"evenodd\",\n    d: \"M2.7 43.296v1.254c0 .746.604 1.35 1.35 1.35h1.275v-1.795c.049.14.075.29.075.445v-1.254h-.075V43.2H4.05c.177 0 .347.034.502.096H2.7Zm2.7-2.507v-2.507H2.7v2.507h2.7Zm0-5.014v-2.507H2.7v2.507h2.7Zm0-5.014v-2.507H2.7v2.507h2.7Zm0-5.015V23.24H2.7v2.507h2.7Zm0-5.014v-2.507H2.7v2.507h2.7Zm0-5.014V13.21H2.7v2.507h2.7Zm-2.7-5.014h1.852a1.346 1.346 0 0 1-.502.096h1.275v-.096H5.4V9.45c0 .156-.026.306-.075.445V8.1H4.05A1.35 1.35 0 0 0 2.7 9.45v1.254Zm5.175.096h2.55V8.1h-2.55v2.7Zm5.1 0h2.55V8.1h-2.55v2.7Zm5.1 0h2.55V8.1h-2.55v2.7Zm5.1 0h2.55V8.1h-2.55v2.7Zm5.1 0h2.55V8.1h-2.55v2.7Zm5.1 0h2.55V8.1h-2.55v2.7Zm5.1 0h2.55V8.1h-2.55v2.7Zm5.1 0h2.55V8.1h-2.55v2.7Zm5.1-2.7v1.795a1.348 1.348 0 0 1-.075-.445v1.254h.075v.096h1.275c-.177 0-.347-.034-.502-.096H51.3V9.45a1.35 1.35 0 0 0-1.35-1.35h-1.275Zm-.075 5.11v2.508h2.7V13.21h-2.7Zm0 5.015v2.507h2.7v-2.507h-2.7Zm0 5.014v2.507h2.7V23.24h-2.7Zm0 5.015v2.507h2.7v-2.507h-2.7Zm0 5.014v2.507h2.7v-2.507h-2.7Zm0 5.014v2.507h2.7v-2.507h-2.7Zm2.7 5.014h-1.852c.155-.062.325-.096.502-.096h-1.275v.096H48.6v1.254c0-.156.026-.305.075-.445V45.9h1.275a1.35 1.35 0 0 0 1.35-1.35v-1.254Zm-5.175-.096h-2.55v2.7h2.55v-2.7Zm-5.1 0h-2.55v2.7h2.55v-2.7Zm-5.1 0h-2.55v2.7h2.55v-2.7Zm-5.1 0h-2.55v2.7h2.55v-2.7Zm-5.1 0h-2.55v2.7h2.55v-2.7Zm-5.1 0h-2.55v2.7h2.55v-2.7Zm-5.1 0h-2.55v2.7h2.55v-2.7Zm-5.1 0h-2.55v2.7h2.55v-2.7ZM16.2 17.55a4.05 4.05 0 0 1 4.05 4.05v1.35A4.05 4.05 0 0 1 16.2 27h-1.35a4.05 4.05 0 0 1-4.05-4.05V21.6a4.05 4.05 0 0 1 4.05-4.05h1.35Zm0 2.7h-1.35a1.35 1.35 0 0 0-1.35 1.35v1.35c0 .746.604 1.35 1.35 1.35h1.35a1.35 1.35 0 0 0 1.35-1.35V21.6a1.35 1.35 0 0 0-1.35-1.35Zm27 1.35a4.05 4.05 0 0 0-4.05-4.05H29.7a4.05 4.05 0 0 0-4.05 4.05v1.35A4.05 4.05 0 0 0 29.7 27h9.45a4.05 4.05 0 0 0 4.05-4.05V21.6Zm-13.5-1.35h9.45c.746 0 1.35.604 1.35 1.35v1.35a1.35 1.35 0 0 1-1.35 1.35H29.7a1.35 1.35 0 0 1-1.35-1.35V21.6c0-.746.604-1.35 1.35-1.35ZM43.2 37.8a4.05 4.05 0 0 0-4.05-4.05H29.7a4.05 4.05 0 0 0-4.05 4.05v1.35h2.7V37.8c0-.746.604-1.35 1.35-1.35h9.45c.746 0 1.35.604 1.35 1.35v1.35h2.7V37.8Zm-27-4.05a4.05 4.05 0 0 1 4.05 4.05v1.35h-2.7V37.8a1.35 1.35 0 0 0-1.35-1.35h-1.35a1.35 1.35 0 0 0-1.35 1.35v1.35h-2.7V37.8a4.05 4.05 0 0 1 4.05-4.05h1.35Z\",\n    clipRule: \"evenodd\"\n  })));\n};\nvar DynamicListIcon = SvgDynamicList;\nvar _path$h;\nfunction _extends$h() {\n  _extends$h = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$h.apply(this, arguments);\n}\nvar SvgText = function SvgText(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$h({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 54,\n    height: 54,\n    fill: \"currentcolor\"\n  }, props), _path$h || (_path$h = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M20.58 33.77h-3l-1.18-3.08H11l-1.1 3.08H7l5.27-13.54h2.89zm-5-5.36-1.86-5-1.83 5zM22 20.23h5.41a15.47 15.47 0 0 1 2.4.14 3.42 3.42 0 0 1 1.41.55 3.47 3.47 0 0 1 1 1.14 3 3 0 0 1 .42 1.58 3.26 3.26 0 0 1-1.91 2.94 3.63 3.63 0 0 1 1.91 1.22 3.28 3.28 0 0 1 .66 2 4 4 0 0 1-.43 1.8 3.63 3.63 0 0 1-1.09 1.4 3.89 3.89 0 0 1-1.83.65q-.69.07-3.3.09H22zm2.73 2.25v3.13h3.8a1.79 1.79 0 0 0 1.1-.49 1.41 1.41 0 0 0 .41-1 1.49 1.49 0 0 0-.35-1 1.54 1.54 0 0 0-1-.48c-.27 0-1.05-.05-2.34-.05zm0 5.39v3.62h2.57a11.52 11.52 0 0 0 1.88-.09 1.65 1.65 0 0 0 1-.54 1.6 1.6 0 0 0 .38-1.14 1.75 1.75 0 0 0-.29-1 1.69 1.69 0 0 0-.86-.62 9.28 9.28 0 0 0-2.41-.23zm19.62.92 2.65.84a5.94 5.94 0 0 1-2 3.29A5.74 5.74 0 0 1 41.38 34a5.87 5.87 0 0 1-4.44-1.84 7.09 7.09 0 0 1-1.73-5A7.43 7.43 0 0 1 37 21.87 6 6 0 0 1 41.54 20a5.64 5.64 0 0 1 4 1.47A5.33 5.33 0 0 1 47 24l-2.7.65a2.8 2.8 0 0 0-2.86-2.27A3.09 3.09 0 0 0 39 23.42a5.31 5.31 0 0 0-.93 3.5 5.62 5.62 0 0 0 .93 3.65 3 3 0 0 0 2.4 1.09 2.72 2.72 0 0 0 1.82-.66 4 4 0 0 0 1.13-2.21z\"\n  })));\n};\nvar TextIcon = SvgText;\nvar _path$g;\nfunction _extends$g() {\n  _extends$g = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$g.apply(this, arguments);\n}\nvar SvgHtml = function SvgHtml(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$g({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 54,\n    height: 54,\n    fill: \"none\"\n  }, props), _path$g || (_path$g = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentColor\",\n    fillRule: \"evenodd\",\n    d: \"M47.008 12.15c1.625 0 2.942 1.36 2.942 3.039v23.622c0 1.678-1.317 3.039-2.942 3.039H6.992c-1.625 0-2.942-1.36-2.942-3.039V15.189c0-1.678 1.317-3.039 2.942-3.039h40.016Zm0 2.026H6.992c-.542 0-.98.454-.98 1.013V16.2h-.004v2.7h.003v19.911c0 .56.44 1.013.98 1.013h40.017c.542 0 .98-.453.98-1.013V18.9h.005v-2.7h-.004v-1.011c0-.56-.44-1.013-.98-1.013ZM14.934 26.055v-3.78h2.194v9.45h-2.194v-3.78h-3.29v3.78H9.45v-9.45h2.194v3.78h3.29Zm4.388-1.89h2.194v7.56h2.193v-7.56h2.194v-1.89h-6.581v1.89Zm14.26-1.89h2.193v9.45h-2.194V25.11l-1.645 3.78-1.645-3.78v6.615h-2.194v-9.45h2.194l1.645 3.78 1.645-3.78Zm4.387 0h2.194v7.56h4.387v1.89h-6.581v-9.45Z\",\n    clipRule: \"evenodd\"\n  })));\n};\nvar HTMLIcon = SvgHtml;\nvar _path$f;\nfunction _extends$f() {\n  _extends$f = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$f.apply(this, arguments);\n}\nvar SvgTextfield = function SvgTextfield(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$f({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 54,\n    height: 54,\n    fill: \"currentcolor\"\n  }, props), _path$f || (_path$f = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    d: \"M45 16a3 3 0 0 1 3 3v16a3 3 0 0 1-3 3H9a3 3 0 0 1-3-3V19a3 3 0 0 1 3-3h36zm0 2H9a1 1 0 0 0-1 1v16a1 1 0 0 0 1 1h36a1 1 0 0 0 1-1V19a1 1 0 0 0-1-1zm-32 4v10h-2V22h2z\"\n  })));\n};\nvar TextfieldIcon = SvgTextfield;\nvar _path$e;\nfunction _extends$e() {\n  _extends$e = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$e.apply(this, arguments);\n}\nvar SvgTextarea = function SvgTextarea(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$e({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 54,\n    height: 54,\n    fill: \"currentcolor\"\n  }, props), _path$e || (_path$e = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    d: \"M45 13a3 3 0 0 1 3 3v22a3 3 0 0 1-3 3H9a3 3 0 0 1-3-3V16a3 3 0 0 1 3-3h36zm0 2H9a1 1 0 0 0-1 1v22a1 1 0 0 0 1 1h36a1 1 0 0 0 1-1V16a1 1 0 0 0-1-1zm-1.136 15.5.849.849-6.364 6.364-.849-.849 6.364-6.364zm.264 3.5.849.849-2.828 2.828-.849-.849L44.128 34zM13 19v10h-2V19h2z\"\n  })));\n};\nvar TextareaIcon = SvgTextarea;\nvar _path$d, _path2$2;\nfunction _extends$d() {\n  _extends$d = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$d.apply(this, arguments);\n}\nvar SvgIFrame = function SvgIFrame(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$d({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 54,\n    height: 54,\n    fill: \"none\"\n  }, props), _path$d || (_path$d = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentcolor\",\n    d: \"M34.467 37.3 41 31l-6.533-6.3-1.32 1.273L38.36 31l-5.213 5.027 1.32 1.273ZM19.533 24.7 13 31l6.533 6.3 1.32-1.273L15.64 31l5.214-5.027-1.32-1.273Zm4.127 14.832 1.805.468 4.875-17.532L28.535 22 23.66 39.532Z\"\n  })), _path2$2 || (_path2$2 = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentcolor\",\n    fillRule: \"evenodd\",\n    d: \"M46 9a3 3 0 0 1 3 3v30a3 3 0 0 1-3 3H8a3 3 0 0 1-3-3V12a3 3 0 0 1 3-3h38Zm0 2H8a1 1 0 0 0-1 1v4h40v-4a1 1 0 0 0-1-1ZM7 42V18h40v24a1 1 0 0 1-1 1H8a1 1 0 0 1-1-1Z\",\n    clipRule: \"evenodd\"\n  })));\n};\nvar IFrameIcon = SvgIFrame;\nvar _path$c, _path2$1;\nfunction _extends$c() {\n  _extends$c = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$c.apply(this, arguments);\n}\nvar SvgImage = function SvgImage(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$c({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 54,\n    height: 54,\n    fill: \"currentcolor\"\n  }, props), _path$c || (_path$c = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    d: \"M34.636 21.91A3.818 3.818 0 1 1 27 21.908a3.818 3.818 0 0 1 7.636 0Zm-2 0A1.818 1.818 0 1 1 29 21.908a1.818 1.818 0 0 1 3.636 0Z\",\n    clipRule: \"evenodd\"\n  })), _path2$1 || (_path2$1 = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    d: \"M15 13a2 2 0 0 0-2 2v24a2 2 0 0 0 2 2h24a2 2 0 0 0 2-2V15a2 2 0 0 0-2-2H15Zm24 2H15v12.45l4.71-4.709a1.91 1.91 0 0 1 2.702 0l6.695 6.695 2.656-1.77a1.91 1.91 0 0 1 2.411.239L39 32.73V15ZM15 39v-8.754a.975.975 0 0 0 .168-.135l5.893-5.893 6.684 6.685a1.911 1.911 0 0 0 2.41.238l2.657-1.77 6.02 6.02c.052.051.108.097.168.135V39H15Z\",\n    clipRule: \"evenodd\"\n  })));\n};\nvar ImageIcon = SvgImage;\nvar _path$b;\nfunction _extends$b() {\n  _extends$b = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$b.apply(this, arguments);\n}\nvar SvgTable = function SvgTable(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$b({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 54 54\"\n  }, props), _path$b || (_path$b = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentcolor\",\n    fillRule: \"evenodd\",\n    d: \"M42.545 12.273A2.455 2.455 0 0 1 45 14.727v24.546a2.455 2.455 0 0 1-2.455 2.454h-31.09A2.455 2.455 0 0 1 9 39.273V14.727a2.455 2.455 0 0 1 2.455-2.454zM27.818 40.09h14.727a.818.818 0 0 0 .819-.818v-4.91H27.818Zm-1.636-5.727v5.727H11.455a.818.818 0 0 1-.819-.818v-4.91zm1.636-1.637h15.546V27H27.818ZM26.182 27v5.727H10.636V27zm1.636-1.636h15.546v-5.728H27.818Zm-1.636-5.728v5.728H10.636v-5.728z\",\n    clipRule: \"evenodd\"\n  })));\n};\nvar TableIcon = SvgTable;\nconst iconsByType = type => {\n  return {\n    button: ButtonIcon,\n    checkbox: CheckboxIcon,\n    checklist: ChecklistIcon,\n    columns: GroupIcon,\n    datetime: DatetimeIcon,\n    group: GroupIcon,\n    iframe: IFrameIcon,\n    image: ImageIcon,\n    number: NumberIcon,\n    radio: RadioIcon,\n    select: SelectIcon,\n    separator: SeparatorIcon,\n    spacer: SpacerIcon,\n    dynamiclist: DynamicListIcon,\n    taglist: TaglistIcon,\n    text: TextIcon,\n    html: HTMLIcon,\n    textfield: TextfieldIcon,\n    textarea: TextareaIcon,\n    table: TableIcon,\n    default: FormIcon\n  }[type];\n};\nconst type$b = 'image';\nfunction Image(props) {\n  const {\n    field\n  } = props;\n  const {\n    alt,\n    id,\n    source\n  } = field;\n  const Icon = iconsByType(field.type);\n  const evaluatedImageSource = useSingleLineTemplateEvaluation(source, {\n    debug: true\n  });\n  const safeSource = useMemo(() => sanitizeImageSource(evaluatedImageSource), [evaluatedImageSource]);\n  const altText = useSingleLineTemplateEvaluation(alt, {\n    debug: true\n  });\n  const {\n    formId\n  } = useContext(FormContext);\n  return jsxs(\"div\", {\n    class: formFieldClasses(type$b),\n    children: [safeSource && jsx(\"div\", {\n      class: \"fjs-image-container\",\n      children: jsx(\"img\", {\n        alt: altText,\n        src: safeSource,\n        class: \"fjs-image\",\n        id: prefixId(id, formId)\n      })\n    }), !safeSource && jsx(\"div\", {\n      class: \"fjs-image-placeholder\",\n      children: jsx(\"span\", {\n        class: \"fjs-image-placeholder-inner\",\n        children: jsx(Icon, {\n          alt: \"This is an image placeholder\",\n          width: \"32\",\n          height: \"32\",\n          viewBox: \"0 0 56 56\"\n        })\n      })\n    })]\n  });\n}\nImage.config = {\n  type: type$b,\n  keyed: false,\n  label: 'Image view',\n  group: 'presentation',\n  create: (options = {}) => ({\n    ...options\n  })\n};\nfunction TemplatedInputAdorner(props) {\n  const {\n    pre,\n    post\n  } = props;\n  const evaluatedPre = useSingleLineTemplateEvaluation(pre, {\n    debug: true\n  });\n  const evaluatedPost = useSingleLineTemplateEvaluation(post, {\n    debug: true\n  });\n  return jsx(InputAdorner, {\n    ...props,\n    pre: evaluatedPre,\n    post: evaluatedPost\n  });\n}\nvar _path$a;\nfunction _extends$a() {\n  _extends$a = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$a.apply(this, arguments);\n}\nvar SvgAngelDown = function SvgAngelDown(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$a({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 8,\n    height: 8\n  }, props), _path$a || (_path$a = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentColor\",\n    fillRule: \"evenodd\",\n    stroke: \"currentColor\",\n    strokeWidth: 0.5,\n    d: \"M7.75 1.336 4 6.125.258 1.335 0 1.54l4 5.125L8 1.54Zm0 0\",\n    clipRule: \"evenodd\"\n  })));\n};\nvar AngelDownIcon = SvgAngelDown;\nvar _path$9;\nfunction _extends$9() {\n  _extends$9 = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$9.apply(this, arguments);\n}\nvar SvgAngelUp = function SvgAngelUp(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$9({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 8,\n    height: 8\n  }, props), _path$9 || (_path$9 = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentColor\",\n    fillRule: \"evenodd\",\n    stroke: \"currentColor\",\n    strokeWidth: 0.5,\n    d: \"M7.75 6.664 4 1.875.258 6.665 0 6.46l4-5.125L8 6.46Zm0 0\",\n    clipRule: \"evenodd\"\n  })));\n};\nvar AngelUpIcon = SvgAngelUp;\nfunction countDecimals(number) {\n  const num = Big(number);\n  if (num.toString() === num.toFixed(0)) return 0;\n  return num.toFixed().split('.')[1].length || 0;\n}\nfunction isValidNumber(value) {\n  return (typeof value === 'number' || typeof value === 'string') && value !== '' && !isNaN(Number(value));\n}\nfunction willKeyProduceValidNumber(key, previousValue, caretIndex, selectionWidth, decimalDigits) {\n  if (previousValue === 'NaN') {\n    return false;\n  }\n\n  // Dot and comma are both treated as dot\n  previousValue = previousValue.replace(',', '.');\n  const isFirstDot = !previousValue.includes('.') && (key === '.' || key === ',');\n  const isFirstMinus = !previousValue.includes('-') && key === '-' && caretIndex === 0;\n  const keypressIsNumeric = /^[0-9]$/i.test(key);\n  const dotIndex = previousValue === undefined ? -1 : previousValue.indexOf('.');\n\n  // If the caret is positioned after a dot, and the current decimal digits count is equal or greater to the maximum, disallow the key press\n  const overflowsDecimalSpace = typeof decimalDigits === 'number' && selectionWidth === 0 && dotIndex !== -1 && previousValue.includes('.') && previousValue.split('.')[1].length >= decimalDigits && caretIndex > dotIndex;\n  const keypressIsAllowedChar = keypressIsNumeric || decimalDigits !== 0 && isFirstDot || isFirstMinus;\n  return keypressIsAllowedChar && !overflowsDecimalSpace;\n}\nfunction isNullEquivalentValue(value) {\n  return value === undefined || value === null || value === '';\n}\nconst type$a = 'number';\nfunction Numberfield(props) {\n  const {\n    disabled,\n    errors = [],\n    domId,\n    onBlur,\n    onFocus,\n    field,\n    value,\n    readonly\n  } = props;\n  const {\n    description,\n    label,\n    appearance = {},\n    validate = {},\n    decimalDigits,\n    increment: incrementValue\n  } = field;\n  const {\n    prefixAdorner,\n    suffixAdorner\n  } = appearance;\n  const {\n    required\n  } = validate;\n  const inputRef = useRef();\n  const [cachedValue, setCachedValue] = useState(value);\n  const [displayValue, setDisplayValue] = useState(value);\n  const sanitize = useCallback(value => Numberfield.config.sanitizeValue({\n    value,\n    formField: field\n  }), [field]);\n  const [debouncedOnChange, flushOnChange] = useFlushDebounce(props.onChange);\n  const previousCachedValue = usePrevious(value);\n  if (previousCachedValue !== cachedValue) {\n    debouncedOnChange({\n      field,\n      value: cachedValue\n    });\n  }\n  const onInputBlur = () => {\n    flushOnChange && flushOnChange();\n    onBlur && onBlur();\n  };\n  const onInputFocus = () => {\n    onFocus && onFocus();\n  };\n\n  // all value changes must go through this function\n  const setValue = useCallback(stringValue => {\n    if (isNullEquivalentValue(stringValue)) {\n      setDisplayValue('');\n      setCachedValue(null);\n      return;\n    }\n\n    // converts automatically for countries where the comma is used as a decimal separator\n    stringValue = stringValue.replaceAll(',', '.');\n    if (stringValue === '-') {\n      setDisplayValue('-');\n      return;\n    }\n\n    // provides feedback for invalid numbers entered via pasting as opposed to just ignoring the paste\n    if (isNaN(Number(stringValue))) {\n      setDisplayValue('NaN');\n      setCachedValue(null);\n      return;\n    }\n    setDisplayValue(stringValue);\n    setCachedValue(sanitize(stringValue));\n  }, [sanitize]);\n\n  // when external changes occur independently of the input, we update the display and cache values of the component\n  const previousValue = usePrevious(value);\n  const outerValueChanged = previousValue != value;\n  const outerValueEqualsCache = sanitize(value) === sanitize(cachedValue);\n  if (outerValueChanged && !outerValueEqualsCache) {\n    setValue(value && value.toString() || '');\n  }\n\n  // caches the value an increment/decrement operation will be based on\n  const incrementAmount = useMemo(() => {\n    if (incrementValue) return Big(incrementValue);\n    if (decimalDigits) return Big(`1e-${decimalDigits}`);\n    return Big('1');\n  }, [decimalDigits, incrementValue]);\n  const increment = () => {\n    if (readonly) {\n      return;\n    }\n    const base = isValidNumber(cachedValue) ? Big(cachedValue) : Big(0);\n    const stepFlooredValue = base.minus(base.mod(incrementAmount));\n\n    // note: toFixed() behaves differently in big.js\n    setValue(stepFlooredValue.plus(incrementAmount).toFixed());\n  };\n  const decrement = () => {\n    if (readonly) {\n      return;\n    }\n    const base = isValidNumber(cachedValue) ? Big(cachedValue) : Big(0);\n    const offset = base.mod(incrementAmount);\n    if (offset.cmp(0) === 0) {\n      // if we're already on a valid step, decrement\n      setValue(base.minus(incrementAmount).toFixed());\n    } else {\n      // otherwise floor to the step\n      const stepFlooredValue = base.minus(base.mod(incrementAmount));\n      setValue(stepFlooredValue.toFixed());\n    }\n  };\n  const onKeyDown = e => {\n    // delete the NaN state all at once on backspace or delete\n    if (displayValue === 'NaN' && (e.code === 'Backspace' || e.code === 'Delete')) {\n      setValue('');\n      e.preventDefault();\n      return;\n    }\n    if (e.code === 'ArrowUp') {\n      increment();\n      e.preventDefault();\n      return;\n    }\n    if (e.code === 'ArrowDown') {\n      decrement();\n      e.preventDefault();\n      return;\n    }\n  };\n\n  // intercept key presses which would lead to an invalid number\n  const onKeyPress = e => {\n    const caretIndex = inputRef.current.selectionStart;\n    const selectionWidth = inputRef.current.selectionStart - inputRef.current.selectionEnd;\n    const previousValue = inputRef.current.value;\n    if (!willKeyProduceValidNumber(e.key, previousValue, caretIndex, selectionWidth, decimalDigits)) {\n      e.preventDefault();\n    }\n  };\n  const descriptionId = `${domId}-description`;\n  const errorMessageId = `${domId}-error-message`;\n  return jsxs(\"div\", {\n    class: formFieldClasses(type$a, {\n      errors,\n      disabled,\n      readonly\n    }),\n    children: [jsx(Label, {\n      htmlFor: domId,\n      label: label,\n      required: required\n    }), jsx(TemplatedInputAdorner, {\n      disabled: disabled,\n      readonly: readonly,\n      pre: prefixAdorner,\n      post: suffixAdorner,\n      children: jsxs(\"div\", {\n        class: classNames('fjs-vertical-group', {\n          'fjs-disabled': disabled,\n          'fjs-readonly': readonly\n        }, {\n          'hasErrors': errors.length\n        }),\n        children: [jsx(\"input\", {\n          ref: inputRef,\n          class: \"fjs-input\",\n          disabled: disabled,\n          readOnly: readonly,\n          id: domId,\n          onKeyDown: onKeyDown,\n          onKeyPress: onKeyPress,\n          onBlur: onInputBlur,\n          onFocus: onInputFocus\n\n          // @ts-ignore\n          ,\n\n          onInput: e => setValue(e.target.value, true),\n          onPaste: e => displayValue === 'NaN' && e.preventDefault(),\n          type: \"text\",\n          autoComplete: \"off\",\n          step: incrementAmount,\n          value: displayValue,\n          \"aria-describedby\": [descriptionId, errorMessageId].join(' '),\n          required: required,\n          \"aria-invalid\": errors.length > 0\n        }), jsxs(\"div\", {\n          class: classNames('fjs-number-arrow-container', {\n            'fjs-disabled': disabled,\n            'fjs-readonly': readonly\n          }),\n          children: [jsx(\"button\", {\n            type: \"button\",\n            class: \"fjs-number-arrow-up\",\n            \"aria-label\": \"Increment\",\n            onClick: () => increment(),\n            tabIndex: -1,\n            children: jsx(AngelUpIcon, {})\n          }), jsx(\"div\", {\n            class: \"fjs-number-arrow-separator\"\n          }), jsx(\"button\", {\n            type: \"button\",\n            class: \"fjs-number-arrow-down\",\n            \"aria-label\": \"Decrement\",\n            onClick: () => decrement(),\n            tabIndex: -1,\n            children: jsx(AngelDownIcon, {})\n          })]\n        })]\n      })\n    }), jsx(Description, {\n      id: descriptionId,\n      description: description\n    }), jsx(Errors, {\n      id: errorMessageId,\n      errors: errors\n    })]\n  });\n}\nNumberfield.config = {\n  type: type$a,\n  keyed: true,\n  label: 'Number',\n  group: 'basic-input',\n  emptyValue: null,\n  sanitizeValue: ({\n    value,\n    formField\n  }) => {\n    // invalid value types are sanitized to null\n    if (isNullEquivalentValue(value) || !isValidNumber(value)) return null;\n\n    // otherwise, we return a string or a number depending on the form field configuration\n    return formField.serializeToString ? value.toString() : Number(value);\n  },\n  create: (options = {}) => ({\n    ...options\n  })\n};\nconst type$9 = 'radio';\nfunction Radio(props) {\n  const {\n    disabled,\n    errors = [],\n    domId,\n    onBlur,\n    onFocus,\n    field,\n    readonly,\n    value\n  } = props;\n  const {\n    description,\n    label,\n    validate = {}\n  } = field;\n  const outerDivRef = useRef();\n  const {\n    required\n  } = validate;\n  const onChange = v => {\n    props.onChange({\n      field,\n      value: v\n    });\n  };\n  const onRadioBlur = e => {\n    if (outerDivRef.current.contains(e.relatedTarget)) {\n      return;\n    }\n    onBlur && onBlur();\n  };\n  const onRadioFocus = e => {\n    if (outerDivRef.current.contains(e.relatedTarget)) {\n      return;\n    }\n    onFocus && onFocus();\n  };\n  const {\n    loadState,\n    options\n  } = useOptionsAsync(field);\n  useCleanupSingleSelectValue({\n    field,\n    loadState,\n    options,\n    value,\n    onChange: props.onChange\n  });\n  const descriptionId = `${domId}-description`;\n  const errorMessageId = `${domId}-error-message`;\n  return jsxs(\"div\", {\n    class: formFieldClasses(type$9, {\n      errors,\n      disabled,\n      readonly\n    }),\n    ref: outerDivRef,\n    children: [jsx(Label, {\n      label: label,\n      required: required\n    }), loadState == LOAD_STATES.LOADED && options.map((option, index) => {\n      const itemDomId = `${domId}-${index}`;\n      const isChecked = isEqual(option.value, value);\n      return jsx(Label, {\n        htmlFor: itemDomId,\n        label: option.label,\n        class: classNames({\n          'fjs-checked': isChecked\n        }),\n        required: false,\n        children: jsx(\"input\", {\n          checked: isChecked,\n          class: \"fjs-input\",\n          disabled: disabled,\n          readOnly: readonly,\n          id: itemDomId,\n          type: \"radio\",\n          onClick: () => onChange(option.value),\n          onBlur: onRadioBlur,\n          onFocus: onRadioFocus,\n          \"aria-describedby\": [descriptionId, errorMessageId].join(' '),\n          required: required,\n          \"aria-invalid\": errors.length > 0\n        })\n      }, index);\n    }), jsx(Description, {\n      id: descriptionId,\n      description: description\n    }), jsx(Errors, {\n      id: errorMessageId,\n      errors: errors\n    })]\n  });\n}\nRadio.config = {\n  type: type$9,\n  keyed: true,\n  label: 'Radio group',\n  group: 'selection',\n  emptyValue: null,\n  sanitizeValue: sanitizeSingleSelectValue,\n  create: createEmptyOptions\n};\nvar _path$8;\nfunction _extends$8() {\n  _extends$8 = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$8.apply(this, arguments);\n}\nvar SvgXMark = function SvgXMark(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$8({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 8,\n    height: 8\n  }, props), _path$8 || (_path$8 = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentColor\",\n    fillRule: \"evenodd\",\n    stroke: \"currentColor\",\n    strokeWidth: 0.5,\n    d: \"M4 3.766 7.43.336l.234.234L4.234 4l3.43 3.43-.234.234L4 4.234.57 7.664.336 7.43 3.766 4 .336.57.57.336Zm0 0\",\n    clipRule: \"evenodd\"\n  })));\n};\nvar XMarkIcon = SvgXMark;\nfunction SearchableSelect(props) {\n  const {\n    domId,\n    disabled,\n    errors,\n    onBlur,\n    onFocus,\n    field,\n    readonly,\n    value\n  } = props;\n  const [filter, setFilter] = useState('');\n  const [isDropdownExpanded, setIsDropdownExpanded] = useState(false);\n  const [isFilterActive, setIsFilterActive] = useState(true);\n  const [isEscapeClosed, setIsEscapeClose] = useState(false);\n  const searchbarRef = useRef();\n  const eventBus = useService('eventBus');\n  const {\n    loadState,\n    options\n  } = useOptionsAsync(field);\n  useCleanupSingleSelectValue({\n    field,\n    loadState,\n    options,\n    value,\n    onChange: props.onChange\n  });\n  const getLabelCorrelation = useGetLabelCorrelation(options);\n  const label = useMemo(() => value && getLabelCorrelation(value), [value, getLabelCorrelation]);\n\n  // whenever we change the underlying value, set the label to it\n  useEffect(() => {\n    setFilter(label || '');\n  }, [label]);\n  const filteredOptions = useMemo(() => {\n    if (loadState !== LOAD_STATES.LOADED) {\n      return [];\n    }\n    if (!filter || !isFilterActive) {\n      return options;\n    }\n    return options.filter(o => o.label && o.value && o.label.toLowerCase().includes(filter.toLowerCase()));\n  }, [filter, loadState, options, isFilterActive]);\n  const setValue = useCallback(option => {\n    setFilter(option && option.label || '');\n    props.onChange({\n      value: option && option.value || null,\n      field\n    });\n  }, [field, props]);\n  const displayState = useMemo(() => {\n    const ds = {};\n    ds.componentReady = !disabled && !readonly && loadState === LOAD_STATES.LOADED;\n    ds.displayCross = ds.componentReady && value !== null && value !== undefined;\n    ds.displayDropdown = !disabled && !readonly && isDropdownExpanded && !isEscapeClosed;\n    return ds;\n  }, [disabled, isDropdownExpanded, isEscapeClosed, loadState, readonly, value]);\n  const onAngelMouseDown = useCallback(e => {\n    setIsEscapeClose(false);\n    setIsDropdownExpanded(!isDropdownExpanded);\n    const searchbar = searchbarRef.current;\n    isDropdownExpanded ? searchbar.blur() : searchbar.focus();\n    e.preventDefault();\n  }, [isDropdownExpanded]);\n  const onInputChange = ({\n    target\n  }) => {\n    setIsEscapeClose(false);\n    setIsDropdownExpanded(true);\n    setIsFilterActive(true);\n    setFilter(target.value || '');\n    eventBus.fire('formField.search', {\n      formField: field,\n      value: target.value || ''\n    });\n  };\n  const onInputKeyDown = useCallback(keyDownEvent => {\n    switch (keyDownEvent.key) {\n      case 'ArrowUp':\n        keyDownEvent.preventDefault();\n        break;\n      case 'ArrowDown':\n        {\n          if (!isDropdownExpanded) {\n            setIsDropdownExpanded(true);\n            setIsFilterActive(false);\n          }\n          keyDownEvent.preventDefault();\n          break;\n        }\n      case 'Escape':\n        setIsEscapeClose(true);\n        break;\n      case 'Enter':\n        if (isEscapeClosed) {\n          setIsEscapeClose(false);\n        }\n        break;\n    }\n  }, [isDropdownExpanded, isEscapeClosed]);\n  const onInputMouseDown = useCallback(() => {\n    setIsEscapeClose(false);\n    setIsDropdownExpanded(true);\n    setIsFilterActive(false);\n  }, []);\n  const onInputFocus = useCallback(() => {\n    setIsEscapeClose(false);\n    setIsDropdownExpanded(true);\n    onFocus && onFocus();\n  }, [onFocus]);\n  const onInputBlur = useCallback(() => {\n    setIsDropdownExpanded(false);\n    setFilter(label || '');\n    onBlur && onBlur();\n  }, [onBlur, label]);\n  return jsxs(Fragment, {\n    children: [jsxs(\"div\", {\n      class: classNames('fjs-input-group', {\n        'disabled': disabled,\n        'readonly': readonly\n      }, {\n        'hasErrors': errors.length\n      }),\n      children: [jsx(\"input\", {\n        disabled: disabled,\n        readOnly: readonly,\n        class: \"fjs-input\",\n        ref: searchbarRef,\n        id: domId,\n        onChange: onInputChange,\n        type: \"text\",\n        value: filter,\n        placeholder: 'Search',\n        autoComplete: \"off\",\n        onKeyDown: onInputKeyDown,\n        onMouseDown: onInputMouseDown,\n        onFocus: onInputFocus,\n        onBlur: onInputBlur,\n        \"aria-describedby\": props['aria-describedby']\n      }), displayState.displayCross && jsxs(\"span\", {\n        class: \"fjs-select-cross\",\n        onMouseDown: e => {\n          setValue(null);\n          e.preventDefault();\n        },\n        children: [jsx(XMarkIcon, {}), \" \"]\n      }), jsx(\"span\", {\n        class: \"fjs-select-arrow\",\n        onMouseDown: e => onAngelMouseDown(e),\n        children: displayState.displayDropdown ? jsx(AngelUpIcon, {}) : jsx(AngelDownIcon, {})\n      })]\n    }), jsx(\"div\", {\n      class: \"fjs-select-anchor\",\n      children: displayState.displayDropdown && jsx(DropdownList, {\n        values: filteredOptions,\n        getLabel: o => o.label,\n        onValueSelected: o => {\n          setValue(o);\n          setIsDropdownExpanded(false);\n        },\n        listenerElement: searchbarRef.current\n      })\n    })]\n  });\n}\nfunction SimpleSelect(props) {\n  const {\n    domId,\n    disabled,\n    errors,\n    onBlur,\n    onFocus,\n    field,\n    readonly,\n    value\n  } = props;\n  const [isDropdownExpanded, setIsDropdownExpanded] = useState(false);\n  const selectRef = useRef();\n  const inputRef = useRef();\n  const {\n    loadState,\n    options\n  } = useOptionsAsync(field);\n  useCleanupSingleSelectValue({\n    field,\n    loadState,\n    options,\n    value,\n    onChange: props.onChange\n  });\n  const getLabelCorrelation = useGetLabelCorrelation(options);\n  const valueLabel = useMemo(() => value && getLabelCorrelation(value), [value, getLabelCorrelation]);\n  const setValue = useCallback(option => {\n    props.onChange({\n      value: option && option.value || null,\n      field\n    });\n  }, [field, props]);\n  const displayState = useMemo(() => {\n    const ds = {};\n    ds.componentReady = !disabled && !readonly && loadState === LOAD_STATES.LOADED;\n    ds.displayCross = ds.componentReady && value !== null && value !== undefined;\n    ds.displayDropdown = !disabled && !readonly && isDropdownExpanded;\n    return ds;\n  }, [disabled, isDropdownExpanded, loadState, readonly, value]);\n  const onMouseDown = useCallback(e => {\n    const input = inputRef.current;\n    if (disabled || !input) {\n      return;\n    }\n    setIsDropdownExpanded(!isDropdownExpanded);\n    if (isDropdownExpanded) {\n      input.blur();\n    } else {\n      input.focus();\n    }\n    e.preventDefault();\n  }, [disabled, isDropdownExpanded]);\n  const initialFocusIndex = useMemo(() => value && findIndex(options, o => o.value === value) || 0, [options, value]);\n  const onInputFocus = useCallback(() => {\n    if (!readonly) {\n      setIsDropdownExpanded(true);\n      onFocus && onFocus();\n    }\n  }, [onFocus, readonly]);\n  const onInputBlur = useCallback(() => {\n    if (!readonly) {\n      setIsDropdownExpanded(false);\n      onBlur && onBlur();\n    }\n  }, [onBlur, readonly]);\n  return jsxs(Fragment, {\n    children: [jsxs(\"div\", {\n      ref: selectRef,\n      class: classNames('fjs-input-group', {\n        disabled,\n        readonly\n      }, {\n        'hasErrors': errors.length\n      }),\n      onFocus: onInputFocus,\n      onBlur: onInputBlur,\n      onMouseDown: onMouseDown,\n      children: [jsx(\"div\", {\n        class: classNames('fjs-select-display', {\n          'fjs-select-placeholder': !value\n        }),\n        id: `${domId}-display`,\n        children: valueLabel || 'Select'\n      }), !disabled && jsx(\"input\", {\n        ref: inputRef,\n        id: domId,\n        class: \"fjs-select-hidden-input\",\n        value: valueLabel,\n        onFocus: onInputFocus,\n        onBlur: onInputBlur,\n        \"aria-describedby\": props['aria-describedby']\n      }), displayState.displayCross && jsx(\"span\", {\n        class: \"fjs-select-cross\",\n        onMouseDown: e => {\n          setValue(null);\n          e.stopPropagation();\n        },\n        children: jsx(XMarkIcon, {})\n      }), jsx(\"span\", {\n        class: \"fjs-select-arrow\",\n        children: displayState.displayDropdown ? jsx(AngelUpIcon, {}) : jsx(AngelDownIcon, {})\n      })]\n    }), jsx(\"div\", {\n      class: \"fjs-select-anchor\",\n      children: displayState.displayDropdown && jsx(DropdownList, {\n        values: options,\n        getLabel: o => o.label,\n        initialFocusIndex: initialFocusIndex,\n        onValueSelected: o => {\n          setValue(o);\n          setIsDropdownExpanded(false);\n        },\n        listenerElement: selectRef.current\n      })\n    })]\n  });\n}\nconst type$8 = 'select';\nfunction Select(props) {\n  const {\n    disabled,\n    errors = [],\n    domId,\n    onBlur,\n    onFocus,\n    field,\n    onChange,\n    readonly,\n    value\n  } = props;\n  const {\n    description,\n    label,\n    searchable = false,\n    validate = {}\n  } = field;\n  const {\n    required\n  } = validate;\n  const descriptionId = `${domId}-description`;\n  const errorMessageId = `${domId}-error-message`;\n  const selectProps = {\n    domId,\n    disabled,\n    errors,\n    onBlur,\n    onFocus,\n    field,\n    value,\n    onChange,\n    readonly,\n    required,\n    'aria-invalid': errors.length > 0,\n    'aria-describedby': [descriptionId, errorMessageId].join(' ')\n  };\n  return jsxs(\"div\", {\n    class: formFieldClasses(type$8, {\n      errors,\n      disabled,\n      readonly\n    }),\n    onKeyDown: event => {\n      if (event.key === 'Enter') {\n        event.preventDefault();\n        event.stopPropagation();\n      }\n    },\n    children: [jsx(Label, {\n      htmlFor: domId,\n      label: label,\n      required: required\n    }), searchable ? jsx(SearchableSelect, {\n      ...selectProps\n    }) : jsx(SimpleSelect, {\n      ...selectProps\n    }), jsx(Description, {\n      id: descriptionId,\n      description: description\n    }), jsx(Errors, {\n      id: errorMessageId,\n      errors: errors\n    })]\n  });\n}\nSelect.config = {\n  type: type$8,\n  keyed: true,\n  label: 'Select',\n  group: 'selection',\n  emptyValue: null,\n  sanitizeValue: sanitizeSingleSelectValue,\n  create: createEmptyOptions\n};\nconst type$7 = 'separator';\nfunction Separator() {\n  return jsx(\"div\", {\n    class: formFieldClasses(type$7),\n    children: jsx(\"hr\", {})\n  });\n}\nSeparator.config = {\n  type: type$7,\n  keyed: false,\n  label: 'Separator',\n  group: 'presentation',\n  create: (options = {}) => ({\n    ...options\n  })\n};\nconst type$6 = 'spacer';\nfunction Spacer(props) {\n  const {\n    field\n  } = props;\n  const {\n    height = 60\n  } = field;\n  return jsx(\"div\", {\n    class: formFieldClasses(type$6),\n    style: {\n      height: height\n    }\n  });\n}\nSpacer.config = {\n  type: type$6,\n  keyed: false,\n  label: 'Spacer',\n  group: 'presentation',\n  create: (options = {}) => ({\n    height: 60,\n    ...options\n  })\n};\nfunction DynamicList(props) {\n  const {\n    field,\n    domId,\n    readonly\n  } = props;\n  const {\n    label,\n    type,\n    showOutline\n  } = field;\n  const {\n    Empty\n  } = useContext(FormRenderContext);\n  const fullProps = {\n    ...props,\n    Empty\n  };\n  return jsxs(\"div\", {\n    className: classNames(formFieldClasses(type, {\n      readonly\n    }), 'fjs-form-field-grouplike', {\n      'fjs-outlined': showOutline\n    }),\n    role: \"group\",\n    \"aria-labelledby\": domId,\n    children: [jsx(Label, {\n      id: domId,\n      label: label\n    }), jsx(ChildrenRenderer, {\n      ...fullProps\n    })]\n  });\n}\nDynamicList.config = {\n  type: 'dynamiclist',\n  pathed: true,\n  repeatable: true,\n  label: 'Dynamic list',\n  group: 'container',\n  create: (options = {}) => ({\n    components: [],\n    showOutline: true,\n    isRepeating: true,\n    allowAddRemove: true,\n    defaultRepetitions: 1,\n    ...options\n  })\n};\nfunction SkipLink(props) {\n  const {\n    className,\n    label,\n    onSkip\n  } = props;\n  const onKeyDown = useCallback(event => {\n    if (event.key === 'Enter') {\n      event.preventDefault();\n      event.stopPropagation();\n      onSkip();\n    }\n  }, [onSkip]);\n  return jsx(\"a\", {\n    href: \"#\",\n    class: classNames('fjs-skip-link', className),\n    onKeyDown: onKeyDown,\n    children: label\n  });\n}\nconst type$5 = 'taglist';\nfunction Taglist(props) {\n  const {\n    disabled,\n    errors = [],\n    onFocus,\n    domId,\n    onBlur,\n    field,\n    readonly,\n    value\n  } = props;\n  const {\n    description,\n    label,\n    validate = {}\n  } = field;\n  const {\n    required\n  } = validate;\n  const [filter, setFilter] = useState('');\n  const [isDropdownExpanded, setIsDropdownExpanded] = useState(false);\n  const [isEscapeClosed, setIsEscapeClose] = useState(false);\n  const focusScopeRef = useRef();\n  const inputRef = useRef();\n  const eventBus = useService('eventBus');\n  const {\n    loadState,\n    options\n  } = useOptionsAsync(field);\n\n  // ensures we render based on array content instead of reference\n  const values = useDeepCompareMemoize(value || []);\n  useCleanupMultiSelectValue({\n    field,\n    loadState,\n    options,\n    values,\n    onChange: props.onChange\n  });\n  const getLabelCorrelation = useGetLabelCorrelation(options);\n  const hasOptionsLeft = useMemo(() => options.length > values.length, [options.length, values.length]);\n  const filteredOptions = useMemo(() => {\n    if (loadState !== LOAD_STATES.LOADED) {\n      return [];\n    }\n    const isValidFilteredOption = option => {\n      const filterMatches = option.label.toLowerCase().includes(filter.toLowerCase());\n      return filterMatches && !hasEqualValue(option.value, values);\n    };\n    return options.filter(isValidFilteredOption);\n  }, [filter, options, values, loadState]);\n  const selectValue = value => {\n    setFilter('');\n\n    // Ensure values cannot be double selected due to latency\n    if (values.at(-1) === value) {\n      return;\n    }\n    props.onChange({\n      value: [...values, value],\n      field\n    });\n  };\n  const deselectValue = value => {\n    const newValues = values.filter(v => !isEqual(v, value));\n    props.onChange({\n      value: newValues,\n      field\n    });\n  };\n  const onInputChange = ({\n    target\n  }) => {\n    setIsEscapeClose(false);\n    setFilter(target.value || '');\n    eventBus.fire('formField.search', {\n      formField: field,\n      value: target.value || ''\n    });\n  };\n  const onInputKeyDown = e => {\n    switch (e.key) {\n      case 'ArrowUp':\n      case 'ArrowDown':\n        // We do not want the cursor to seek in the search field when we press up and down\n        e.preventDefault();\n        break;\n      case 'Backspace':\n        if (!filter && values.length) {\n          deselectValue(values[values.length - 1]);\n        }\n        break;\n      case 'Escape':\n        setIsEscapeClose(true);\n        break;\n      case 'Enter':\n        if (isEscapeClosed) {\n          setIsEscapeClose(false);\n        }\n        break;\n    }\n  };\n  const onElementBlur = e => {\n    if (focusScopeRef.current.contains(e.relatedTarget)) return;\n    onBlur && onBlur();\n  };\n  const onElementFocus = e => {\n    if (focusScopeRef.current.contains(e.relatedTarget)) return;\n    onFocus && onFocus();\n  };\n  const onInputBlur = e => {\n    if (!readonly) {\n      setIsDropdownExpanded(false);\n      setFilter('');\n    }\n    onElementBlur(e);\n  };\n  const onInputFocus = e => {\n    if (!readonly) {\n      setIsDropdownExpanded(true);\n    }\n    onElementFocus(e);\n  };\n  const onTagRemoveClick = (event, value) => {\n    const {\n      target\n    } = event;\n    deselectValue(value);\n\n    // restore focus if there is no next sibling to focus\n    const nextTag = target.closest('.fjs-taglist-tag').nextSibling;\n    if (!nextTag) {\n      inputRef.current.focus();\n    }\n  };\n  const onSkipToSearch = () => {\n    inputRef.current.focus();\n  };\n  const shouldDisplayDropdown = useMemo(() => !disabled && loadState === LOAD_STATES.LOADED && isDropdownExpanded && !isEscapeClosed, [disabled, isDropdownExpanded, isEscapeClosed, loadState]);\n  const descriptionId = `${domId}-description`;\n  const errorMessageId = `${domId}-error-message`;\n  return jsxs(\"div\", {\n    ref: focusScopeRef,\n    class: formFieldClasses(type$5, {\n      errors,\n      disabled,\n      readonly\n    }),\n    onKeyDown: event => {\n      if (event.key === 'Enter') {\n        event.stopPropagation();\n        event.preventDefault();\n      }\n    },\n    children: [jsx(Label, {\n      label: label,\n      required: required,\n      htmlFor: domId\n    }), !disabled && !readonly && !!values.length && jsx(SkipLink, {\n      className: \"fjs-taglist-skip-link\",\n      label: \"Skip to search\",\n      onSkip: onSkipToSearch\n    }), jsxs(\"div\", {\n      class: classNames('fjs-taglist', {\n        'fjs-disabled': disabled,\n        'fjs-readonly': readonly\n      }),\n      children: [loadState === LOAD_STATES.LOADED && jsx(\"div\", {\n        class: \"fjs-taglist-tags\",\n        children: values.map(v => {\n          return jsxs(\"div\", {\n            class: classNames('fjs-taglist-tag', {\n              'fjs-disabled': disabled,\n              'fjs-readonly': readonly\n            }),\n            onMouseDown: e => e.preventDefault(),\n            children: [jsx(\"span\", {\n              class: \"fjs-taglist-tag-label\",\n              children: getLabelCorrelation(v)\n            }), !disabled && !readonly && jsx(\"button\", {\n              type: \"button\",\n              title: \"Remove tag\",\n              class: \"fjs-taglist-tag-remove\",\n              onFocus: onElementFocus,\n              onBlur: onElementBlur,\n              onClick: event => onTagRemoveClick(event, v),\n              children: jsx(XMarkIcon, {})\n            })]\n          });\n        })\n      }), jsx(\"input\", {\n        disabled: disabled,\n        readOnly: readonly,\n        class: \"fjs-taglist-input\",\n        ref: inputRef,\n        id: domId,\n        onChange: onInputChange,\n        type: \"text\",\n        value: filter,\n        placeholder: disabled || readonly ? undefined : 'Search',\n        autoComplete: \"off\",\n        onKeyDown: onInputKeyDown,\n        onMouseDown: () => setIsEscapeClose(false),\n        onFocus: onInputFocus,\n        onBlur: onInputBlur,\n        \"aria-describedby\": [descriptionId, errorMessageId].join(' '),\n        required: required,\n        \"aria-invalid\": errors.length > 0\n      })]\n    }), jsx(\"div\", {\n      class: \"fjs-taglist-anchor\",\n      children: shouldDisplayDropdown && jsx(DropdownList, {\n        values: filteredOptions,\n        getLabel: o => o.label,\n        onValueSelected: o => selectValue(o.value),\n        emptyListMessage: hasOptionsLeft ? 'No results' : 'All values selected',\n        listenerElement: inputRef.current\n      })\n    }), jsx(Description, {\n      id: descriptionId,\n      description: description\n    }), jsx(Errors, {\n      id: errorMessageId,\n      errors: errors\n    })]\n  });\n}\nTaglist.config = {\n  type: type$5,\n  keyed: true,\n  label: 'Tag list',\n  group: 'selection',\n  emptyValue: [],\n  sanitizeValue: sanitizeMultiSelectValue,\n  create: createEmptyOptions\n};\nconst NODE_TYPE_TEXT = 3,\n  NODE_TYPE_ELEMENT = 1;\nconst ALLOWED_NODES = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'span', 'em', 'a', 'p', 'div', 'ul', 'ol', 'li', 'hr', 'blockquote', 'img', 'pre', 'code', 'br', 'strong', 'table', 'thead', 'tbody', 'tr', 'th', 'td'];\nconst ALLOWED_ATTRIBUTES = ['align', 'alt', 'class', 'href', 'id', 'name', 'rel', 'target', 'src'];\nconst ALLOWED_URI_PATTERN = /^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\\-]+(?:[^a-z+.\\-:]|$))/i; // eslint-disable-line no-useless-escape\nconst ATTR_WHITESPACE_PATTERN = /[\\u0000-\\u0020\\u00A0\\u1680\\u180E\\u2000-\\u2029\\u205F\\u3000]/g; // eslint-disable-line no-control-regex\n\nconst FORM_ELEMENT = document.createElement('form');\n\n/**\n * Sanitize a HTML string and return the cleaned, safe version.\n *\n * @param {string} html\n * @return {string}\n */\n\n// see https://github.com/developit/snarkdown/issues/70\nfunction sanitizeHTML(html) {\n  const doc = new DOMParser().parseFromString(`<!DOCTYPE html>\\n<html><body><div>${html}`, 'text/html');\n  doc.normalize();\n  const element = doc.body.firstChild;\n  if (element) {\n    sanitizeNode( /** @type Element */element);\n    return /** @type Element */element.innerHTML;\n  } else {\n    // handle the case that document parsing\n    // does not work at all, due to HTML gibberish\n    return '';\n  }\n}\n\n/**\n * Recursively sanitize a HTML node, potentially\n * removing it, its children or attributes.\n *\n * Inspired by https://github.com/developit/snarkdown/issues/70\n * and https://github.com/cure53/DOMPurify. Simplified\n * for our use-case.\n *\n * @param {Element} node\n */\nfunction sanitizeNode(node) {\n  // allow text nodes\n  if (node.nodeType === NODE_TYPE_TEXT) {\n    return;\n  }\n\n  // disallow all other nodes but Element\n  if (node.nodeType !== NODE_TYPE_ELEMENT) {\n    return node.remove();\n  }\n  const lcTag = node.tagName.toLowerCase();\n\n  // disallow non-whitelisted tags\n  if (!ALLOWED_NODES.includes(lcTag)) {\n    return node.remove();\n  }\n  const attributes = node.attributes;\n\n  // clean attributes\n  for (let i = attributes.length; i--;) {\n    const attribute = attributes[i];\n    const name = attribute.name;\n    const lcName = name.toLowerCase();\n\n    // normalize node value\n    const value = attribute.value.trim();\n    node.removeAttribute(name);\n    const valid = isValidAttribute(lcTag, lcName, value);\n    if (valid) {\n      node.setAttribute(name, value);\n    }\n  }\n\n  // force noopener on target=\"_blank\" links\n  if (lcTag === 'a' && node.getAttribute('target') === '_blank' && node.getAttribute('rel') !== 'noopener') {\n    node.setAttribute('rel', 'noopener');\n  }\n  for (let i = node.childNodes.length; i--;) {\n    sanitizeNode( /** @type Element */node.childNodes[i]);\n  }\n}\n\n/**\n * Validates attributes for validity.\n *\n * @param {string} lcTag\n * @param {string} lcName\n * @param {string} value\n * @return {boolean}\n */\nfunction isValidAttribute(lcTag, lcName, value) {\n  // disallow most attributes based on whitelist\n  if (!ALLOWED_ATTRIBUTES.includes(lcName)) {\n    return false;\n  }\n\n  // disallow \"DOM clobbering\" / polution of document and wrapping form elements\n  if ((lcName === 'id' || lcName === 'name') && (value in document || value in FORM_ELEMENT)) {\n    return false;\n  }\n  if (lcName === 'target' && value !== '_blank') {\n    return false;\n  }\n\n  // allow valid url links only\n  if (lcName === 'href' && !ALLOWED_URI_PATTERN.test(value.replace(ATTR_WHITESPACE_PATTERN, ''))) {\n    return false;\n  }\n  return true;\n}\nconst type$4 = 'text';\nfunction Text(props) {\n  const form = useService('form');\n  const {\n    textLinkTarget\n  } = form._getState().properties;\n  const {\n    field,\n    disableLinks\n  } = props;\n  const {\n    text = '',\n    strict = false\n  } = field;\n  const markdownRenderer = useService('markdownRenderer');\n\n  // feelers => pure markdown\n  const markdown = useTemplateEvaluation(text, {\n    debug: true,\n    strict\n  });\n\n  // markdown => html\n  const html = useMemo(() => markdownRenderer.render(markdown), [markdownRenderer, markdown]);\n  const sanitizeAndTransformLinks = useCallback(unsafeHtml => {\n    const html = sanitizeHTML(unsafeHtml);\n    const tempDiv = document.createElement('div');\n    tempDiv.innerHTML = html;\n    const links = tempDiv.querySelectorAll('a');\n    links.forEach(link => {\n      if (disableLinks) {\n        link.setAttribute('class', 'fjs-disabled-link');\n        link.setAttribute('tabIndex', '-1');\n      }\n      if (textLinkTarget) {\n        link.setAttribute('target', textLinkTarget);\n      }\n    });\n    return tempDiv.innerHTML;\n  }, [disableLinks, textLinkTarget]);\n  const dangerouslySetInnerHTML = useDangerousHTMLWrapper({\n    html,\n    transform: sanitizeAndTransformLinks,\n    sanitize: false,\n    sanitizeStyleTags: false\n  });\n  return jsx(\"div\", {\n    class: formFieldClasses(type$4),\n    dangerouslySetInnerHTML: dangerouslySetInnerHTML\n  });\n}\nText.config = {\n  type: type$4,\n  keyed: false,\n  label: 'Text view',\n  group: 'presentation',\n  create: (options = {}) => ({\n    text: '# Text',\n    ...options\n  })\n};\n\n/**\n * Wrap CSS styles with a given prefix.\n *\n * @param {HTMLElement} rootNode\n * @param {string} prefix\n *\n * @returns {HTMLElement}\n */\nfunction wrapCSSStyles(rootNode, prefix) {\n  const styleTags = rootNode.querySelectorAll('style');\n  styleTags.forEach(styleTag => {\n    const topLevelRules = extractTopLevelRules(styleTag.textContent);\n    const scopedCss = topLevelRules.map(rule => {\n      const {\n        selector,\n        styles\n      } = splitRule(rule);\n      const scopedSelector = scopeSelector(selector, prefix);\n      return `${scopedSelector} ${styles}`;\n    }).join(' ');\n    styleTag.textContent = scopedCss;\n  });\n  return rootNode;\n}\nfunction extractTopLevelRules(cssString) {\n  let cursor = 0;\n  let start = 0;\n  let level = 0;\n  const topLevelRules = [];\n  while (cursor < cssString.length) {\n    if (cssString[cursor] === '{') {\n      level++;\n    }\n    if (cssString[cursor] === '}') {\n      level--;\n      if (level === 0) {\n        topLevelRules.push(cssString.substring(start, cursor + 1));\n        start = cursor + 1;\n      }\n    }\n    cursor++;\n  }\n  return topLevelRules.map(rule => rule.trim());\n}\nfunction splitRule(rule) {\n  const firstBracket = rule.indexOf('{');\n  const selector = rule.substring(0, firstBracket);\n  const styles = rule.substring(firstBracket);\n  return {\n    selector,\n    styles\n  };\n}\nfunction scopeSelector(selector, prefix) {\n  return selector.split(',').map(sel => `${prefix} ${sel.trim()}`).join(', ');\n}\nconst type$3 = 'html';\nfunction Html(props) {\n  const form = useService('form');\n  const {\n    textLinkTarget\n  } = form._getState().properties;\n  const {\n    field,\n    disableLinks,\n    domId\n  } = props;\n  const {\n    content = '',\n    strict = false\n  } = field;\n  const styleScope = `${domId}-style-scope`;\n\n  // we escape HTML within the template evaluation to prevent clickjacking attacks\n  const html = useTemplateEvaluation(content, {\n    debug: true,\n    strict,\n    sanitizer: escapeHTML\n  });\n  const transform = useCallback(html => {\n    const tempDiv = document.createElement('div');\n    tempDiv.innerHTML = html;\n\n    // (1) apply modifications to links\n\n    const links = tempDiv.querySelectorAll('a');\n    links.forEach(link => {\n      if (disableLinks) {\n        link.setAttribute('class', 'fjs-disabled-link');\n        link.setAttribute('tabIndex', '-1');\n      }\n      if (textLinkTarget) {\n        link.setAttribute('target', textLinkTarget);\n      }\n    });\n\n    // (2) scope styles to the root div\n    wrapCSSStyles(tempDiv, `.${styleScope}`);\n    return tempDiv.innerHTML;\n  }, [disableLinks, styleScope, textLinkTarget]);\n  const dangerouslySetInnerHTML = useDangerousHTMLWrapper({\n    html,\n    transform,\n    sanitize: true,\n    sanitizeStyleTags: false\n  });\n  return jsx(\"div\", {\n    class: classNames(formFieldClasses(type$3), styleScope),\n    dangerouslySetInnerHTML: dangerouslySetInnerHTML\n  });\n}\nHtml.config = {\n  type: type$3,\n  keyed: false,\n  label: 'HTML',\n  group: 'presentation',\n  create: (options = {}) => ({\n    content: '',\n    ...options\n  })\n};\nconst type$2 = 'textfield';\nfunction Textfield(props) {\n  const {\n    disabled,\n    errors = [],\n    domId,\n    onBlur,\n    onFocus,\n    field,\n    readonly,\n    value = ''\n  } = props;\n  const {\n    description,\n    label,\n    appearance = {},\n    validate = {}\n  } = field;\n  const {\n    prefixAdorner,\n    suffixAdorner\n  } = appearance;\n  const {\n    required\n  } = validate;\n  const [onInputChange, flushOnChange] = useFlushDebounce(({\n    target\n  }) => {\n    props.onChange({\n      field,\n      value: target.value\n    });\n  });\n  const onInputBlur = () => {\n    flushOnChange && flushOnChange();\n    onBlur && onBlur();\n  };\n  const onInputFocus = () => {\n    onFocus && onFocus();\n  };\n  const descriptionId = `${domId}-description`;\n  const errorMessageId = `${domId}-error-message`;\n  return jsxs(\"div\", {\n    class: formFieldClasses(type$2, {\n      errors,\n      disabled,\n      readonly\n    }),\n    children: [jsx(Label, {\n      htmlFor: domId,\n      label: label,\n      required: required\n    }), jsx(TemplatedInputAdorner, {\n      disabled: disabled,\n      readonly: readonly,\n      pre: prefixAdorner,\n      post: suffixAdorner,\n      children: jsx(\"input\", {\n        class: \"fjs-input\",\n        disabled: disabled,\n        readOnly: readonly,\n        id: domId,\n        onInput: onInputChange,\n        onBlur: onInputBlur,\n        onFocus: onInputFocus,\n        type: \"text\",\n        value: value,\n        \"aria-describedby\": [descriptionId, errorMessageId].join(' '),\n        required: required,\n        \"aria-invalid\": errors.length > 0\n      })\n    }), jsx(Description, {\n      id: descriptionId,\n      description: description\n    }), jsx(Errors, {\n      id: errorMessageId,\n      errors: errors\n    })]\n  });\n}\nTextfield.config = {\n  type: type$2,\n  keyed: true,\n  label: 'Text field',\n  group: 'basic-input',\n  emptyValue: '',\n  sanitizeValue: ({\n    value\n  }) => {\n    if (isArray(value) || isObject(value) || isNil(value)) {\n      return '';\n    }\n\n    // sanitize newlines to spaces\n    if (typeof value === 'string') {\n      return value.replace(/[\\r\\n\\t]/g, ' ');\n    }\n    return String(value);\n  },\n  create: (options = {}) => ({\n    ...options\n  })\n};\nconst type$1 = 'textarea';\nfunction Textarea(props) {\n  const {\n    disabled,\n    errors = [],\n    domId,\n    onBlur,\n    onFocus,\n    field,\n    readonly,\n    value = ''\n  } = props;\n  const {\n    description,\n    label,\n    validate = {}\n  } = field;\n  const {\n    required\n  } = validate;\n  const textareaRef = useRef();\n  const [onChange, flushOnChange] = useFlushDebounce(({\n    target\n  }) => {\n    props.onChange({\n      field,\n      value: target.value\n    });\n  });\n  const onInputBlur = () => {\n    flushOnChange && flushOnChange();\n    onBlur && onBlur();\n  };\n  const onInputFocus = () => {\n    onFocus && onFocus();\n  };\n  const onInputChange = event => {\n    onChange({\n      target: event.target\n    });\n    autoSizeTextarea(textareaRef.current);\n  };\n  useLayoutEffect(() => {\n    autoSizeTextarea(textareaRef.current);\n  }, [value]);\n  useEffect(() => {\n    autoSizeTextarea(textareaRef.current);\n  }, []);\n  const descriptionId = `${domId}-description`;\n  const errorMessageId = `${domId}-error-message`;\n  return jsxs(\"div\", {\n    class: formFieldClasses(type$1, {\n      errors,\n      disabled,\n      readonly\n    }),\n    children: [jsx(Label, {\n      htmlFor: domId,\n      label: label,\n      required: required\n    }), jsx(\"textarea\", {\n      class: \"fjs-textarea\",\n      disabled: disabled,\n      readonly: readonly,\n      id: domId,\n      onInput: onInputChange,\n      onBlur: onInputBlur,\n      onFocus: onInputFocus,\n      value: value,\n      ref: textareaRef,\n      \"aria-describedby\": [descriptionId, errorMessageId].join(' '),\n      required: required,\n      \"aria-invalid\": errors.length > 0\n    }), jsx(Description, {\n      id: descriptionId,\n      description: description\n    }), jsx(Errors, {\n      id: errorMessageId,\n      errors: errors\n    })]\n  });\n}\nTextarea.config = {\n  type: type$1,\n  keyed: true,\n  label: 'Text area',\n  group: 'basic-input',\n  emptyValue: '',\n  sanitizeValue: ({\n    value\n  }) => isArray(value) || isObject(value) || isNil(value) ? '' : String(value),\n  create: (options = {}) => ({\n    ...options\n  })\n};\nconst autoSizeTextarea = textarea => {\n  // Ensures the textarea shrinks back, and improves resizing behavior consistency\n  textarea.style.height = '0px';\n  const computed = window.getComputedStyle(textarea);\n  const heightFromLines = () => {\n    const lineHeight = parseInt(computed.getPropertyValue('line-height').replace('px', '')) || 0;\n    const lines = textarea.value ? textarea.value.toString().split('\\n').length : 0;\n    return lines * lineHeight;\n  };\n  const calculatedHeight = parseInt(computed.getPropertyValue('border-top-width')) + parseInt(computed.getPropertyValue('padding-top')) + (textarea.scrollHeight || heightFromLines()) + parseInt(computed.getPropertyValue('padding-bottom')) + parseInt(computed.getPropertyValue('border-bottom-width'));\n  const minHeight = 75;\n  const maxHeight = 350;\n  const displayHeight = Math.max(Math.min(calculatedHeight || 0, maxHeight), minHeight);\n  textarea.style.height = `${displayHeight}px`;\n\n  // Overflow is hidden by default to hide scrollbar flickering\n  textarea.style.overflow = calculatedHeight > maxHeight ? 'visible' : 'hidden';\n};\nvar _path$7;\nfunction _extends$7() {\n  _extends$7 = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$7.apply(this, arguments);\n}\nvar SvgArrowDown = function SvgArrowDown(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$7({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 32 32\"\n  }, props), _path$7 || (_path$7 = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentcolor\",\n    d: \"M24.59 16.59 17 24.17V4h-2v20.17l-7.59-7.58L6 18l10 10 10-10-1.41-1.41z\"\n  })));\n};\nvar ArrowDownIcon = SvgArrowDown;\nvar _path$6;\nfunction _extends$6() {\n  _extends$6 = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$6.apply(this, arguments);\n}\nvar SvgArrowUp = function SvgArrowUp(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$6({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 32 32\"\n  }, props), _path$6 || (_path$6 = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentcolor\",\n    d: \"M16 4 6 14l1.41 1.41L15 7.83V28h2V7.83l7.59 7.58L26 14 16 4z\"\n  })));\n};\nvar ArrowUpIcon = SvgArrowUp;\nvar _path$5;\nfunction _extends$5() {\n  _extends$5 = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$5.apply(this, arguments);\n}\nvar SvgCaretLeft = function SvgCaretLeft(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$5({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlSpace: \"preserve\",\n    viewBox: \"0 0 32 32\"\n  }, props), _path$5 || (_path$5 = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentcolor\",\n    d: \"m20 24-10-8 10-8z\"\n  })));\n};\nvar CaretLeftIcon = SvgCaretLeft;\nvar _path$4;\nfunction _extends$4() {\n  _extends$4 = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$4.apply(this, arguments);\n}\nvar SvgCaretRight = function SvgCaretRight(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$4({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlSpace: \"preserve\",\n    viewBox: \"0 0 32 32\"\n  }, props), _path$4 || (_path$4 = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentcolor\",\n    d: \"m12 8 10 8-10 8z\"\n  })));\n};\nvar CaretRightIcon = SvgCaretRight;\nconst type = 'table';\n\n/**\n * @typedef {('asc'|'desc')} Direction\n *\n * @typedef Sorting\n * @property {string} key\n * @property {Direction} direction\n *\n * @typedef Column\n * @property {string} label\n * @property {string} key\n *\n * @typedef Field\n * @property {string} id\n * @property {Array<Column>} [columns]\n * @property {string} [columnsExpression]\n * @property {string} [label]\n * @property {number} [rowCount]\n * @property {string} [dataSource]\n *\n * @typedef Props\n * @property {Field} field\n *\n * @param {Props} props\n * @returns {import(\"preact\").JSX.Element}\n */\nfunction Table(props) {\n  const {\n    field\n  } = props;\n  const {\n    columns = [],\n    columnsExpression,\n    dataSource = '',\n    rowCount,\n    id,\n    label\n  } = field;\n\n  /** @type {[(null|Sorting), import(\"preact/hooks\").StateUpdater<null|Sorting>]} */\n  const [sortBy, setSortBy] = useState(null);\n  const evaluatedColumns = useEvaluatedColumns(columnsExpression || '', columns);\n  const columnKeys = evaluatedColumns.map(({\n    key\n  }) => key);\n  const evaluatedDataSource = useExpressionEvaluation(dataSource);\n  const data = Array.isArray(evaluatedDataSource) ? evaluatedDataSource : [];\n  const sortedData = sortBy === null ? data : sortByColumn(data, sortBy.key, sortBy.direction);\n\n  /** @type {unknown[][]} */\n  const chunkedData = isNumber(rowCount) ? chunk(sortedData, rowCount) : [sortedData];\n  const [currentPage, setCurrentPage] = useState(0);\n  const currentChunk = chunkedData[currentPage] || [];\n  useEffect(() => {\n    setCurrentPage(0);\n  }, [rowCount, sortBy]);\n\n  /** @param {string} key */\n  function toggleSortBy(key) {\n    setSortBy(current => {\n      if (current === null || current.key !== key) {\n        return {\n          key,\n          direction: 'asc'\n        };\n      }\n      if (current.direction === 'desc') {\n        return null;\n      }\n      return {\n        key,\n        direction: 'desc'\n      };\n    });\n  }\n  return jsxs(\"div\", {\n    class: formFieldClasses(type),\n    children: [jsx(Label, {\n      htmlFor: prefixId(id),\n      label: label\n    }), jsxs(\"div\", {\n      class: classNames('fjs-table-middle-container', {\n        'fjs-table-empty': evaluatedColumns.length === 0\n      }),\n      children: [evaluatedColumns.length === 0 ? 'Nothing to show.' : jsx(\"div\", {\n        class: \"fjs-table-inner-container\",\n        children: jsxs(\"table\", {\n          class: \"fjs-table\",\n          id: prefixId(id),\n          children: [jsx(\"thead\", {\n            class: \"fjs-table-head\",\n            children: jsx(\"tr\", {\n              class: \"fjs-table-tr\",\n              children: evaluatedColumns.map(({\n                key,\n                label\n              }) => {\n                const displayLabel = label || key;\n                return jsx(\"th\", {\n                  tabIndex: 0,\n                  class: \"fjs-table-th\",\n                  onClick: () => {\n                    toggleSortBy(key);\n                  },\n                  onKeyDown: event => {\n                    if (['Enter', 'Space'].includes(event.code)) {\n                      toggleSortBy(key);\n                    }\n                  },\n                  \"aria-label\": getHeaderAriaLabel(sortBy, key, displayLabel),\n                  children: jsxs(\"span\", {\n                    class: \"fjs-table-th-label\",\n                    children: [displayLabel, sortBy !== null && sortBy.key === key ? jsx(Fragment, {\n                      children: sortBy.direction === 'asc' ? jsx(ArrowUpIcon, {\n                        class: \"fjs-table-sort-icon-asc\"\n                      }) : jsx(ArrowDownIcon, {\n                        class: \"fjs-table-sort-icon-desc\"\n                      })\n                    }) : null]\n                  })\n                }, key);\n              })\n            })\n          }), currentChunk.length === 0 ? jsx(\"tbody\", {\n            class: \"fjs-table-body\",\n            children: jsx(\"tr\", {\n              class: \"fjs-table-tr\",\n              children: jsx(\"td\", {\n                class: \"fjs-table-td\",\n                colSpan: evaluatedColumns.length,\n                children: \"Nothing to show.\"\n              })\n            })\n          }) : jsx(\"tbody\", {\n            class: \"fjs-table-body\",\n            children: currentChunk.map((row, index) => jsx(\"tr\", {\n              class: \"fjs-table-tr\",\n              children: columnKeys.map(key => jsx(\"td\", {\n                class: \"fjs-table-td\",\n                children: row[key]\n              }, key))\n            }, index))\n          })]\n        })\n      }), isNumber(rowCount) && chunkedData.length > 1 && evaluatedColumns.length > 0 ? jsxs(\"nav\", {\n        class: \"fjs-table-nav\",\n        children: [jsxs(\"span\", {\n          class: \"fjs-table-nav-label\",\n          children: [currentPage + 1, \" of \", chunkedData.length]\n        }), jsx(\"button\", {\n          type: \"button\",\n          class: \"fjs-table-nav-button\",\n          onClick: () => {\n            setCurrentPage(page => Math.max(page - 1, 0));\n          },\n          disabled: currentPage === 0,\n          \"aria-label\": \"Previous page\",\n          children: jsx(CaretLeftIcon, {})\n        }), jsx(\"button\", {\n          type: \"button\",\n          class: \"fjs-table-nav-button\",\n          onClick: () => {\n            setCurrentPage(page => Math.min(page + 1, chunkedData.length - 1));\n          },\n          disabled: currentPage >= chunkedData.length - 1,\n          \"aria-label\": \"Next page\",\n          children: jsx(CaretRightIcon, {})\n        })]\n      }) : null]\n    })]\n  });\n}\nTable.config = {\n  type,\n  keyed: false,\n  label: 'Table',\n  group: 'presentation',\n  create: (options = {}) => {\n    const {\n      id,\n      columnsExpression,\n      columns,\n      rowCount,\n      ...remainingOptions\n    } = options;\n    if (isDefined(id) && isNumber(rowCount)) {\n      remainingOptions['rowCount'] = rowCount;\n    }\n    if (isString(columnsExpression)) {\n      return {\n        ...remainingOptions,\n        id,\n        columnsExpression\n      };\n    }\n    if (Array.isArray(columns) && columns.every(isColumn)) {\n      return {\n        ...remainingOptions,\n        id,\n        columns\n      };\n    }\n    return {\n      ...remainingOptions,\n      rowCount: 10,\n      columns: [{\n        label: 'ID',\n        key: 'id'\n      }, {\n        label: 'Name',\n        key: 'name'\n      }, {\n        label: 'Date',\n        key: 'date'\n      }]\n    };\n  },\n  /**\n   * @experimental\n   *\n   * A function that generates demo data for a new field on the form playground.\n   * @param {Field} field\n   */\n  generateInitialDemoData: field => {\n    const demoData = [{\n      id: 1,\n      name: 'John Doe',\n      date: '31.01.2023'\n    }, {\n      id: 2,\n      name: 'Erika Muller',\n      date: '20.02.2023'\n    }, {\n      id: 3,\n      name: 'Dominic Leaf',\n      date: '11.03.2023'\n    }];\n    const demoDataKeys = Object.keys(demoData[0]);\n    const {\n      columns,\n      id,\n      dataSource\n    } = field;\n    if (!Array.isArray(columns) || columns.length === 0 || dataSource !== `=${id}`) {\n      return;\n    }\n    if (!columns.map(({\n      key\n    }) => key).every(key => demoDataKeys.includes(key))) {\n      return;\n    }\n    return demoData;\n  }\n};\n\n// helpers /////////////////////////////\n\n/**\n * @param {string|void} columnsExpression\n * @param {Column[]} fallbackColumns\n * @returns {Column[]}\n */\nfunction useEvaluatedColumns(columnsExpression, fallbackColumns) {\n  /** @type {Column[]|null} */\n  const evaluation = useExpressionEvaluation(columnsExpression || '');\n  return Array.isArray(evaluation) && evaluation.every(isColumn) ? evaluation : fallbackColumns;\n}\n\n/**\n * @param {any} column\n * @returns {column is Column}\n */\nfunction isColumn(column) {\n  return isObject(column) && isString(column['label']) && isString(column['key']);\n}\n\n/**\n * @param {Array} array\n * @param {number} size\n * @returns {Array}\n */\nfunction chunk(array, size) {\n  return array.reduce((chunks, item, index) => {\n    if (index % size === 0) {\n      chunks.push([item]);\n    } else {\n      chunks[chunks.length - 1].push(item);\n    }\n    return chunks;\n  }, []);\n}\n\n/**\n * @param {unknown[]} array\n * @param {string} key\n * @param {Direction} direction\n * @returns {unknown[]}\n */\nfunction sortByColumn(array, key, direction) {\n  return [...array].sort((a, b) => {\n    if (!isObject(a) || !isObject(b)) {\n      return 0;\n    }\n    if (direction === 'asc') {\n      return a[key] > b[key] ? 1 : -1;\n    }\n    return a[key] < b[key] ? 1 : -1;\n  });\n}\n\n/**\n * @param {null|Sorting} sortBy\n * @param {string} key\n * @param {string} label\n */\nfunction getHeaderAriaLabel(sortBy, key, label) {\n  if (sortBy === null || sortBy.key !== key) {\n    return `Click to sort by ${label} descending`;\n  }\n  if (sortBy.direction === 'asc') {\n    return 'Click to remove sorting';\n  }\n  return `Click to sort by ${label} ascending`;\n}\n\n/**\n * This file must not be changed or exchanged.\n *\n * @see http://bpmn.io/license for more information.\n */\nfunction Logo() {\n  return jsxs(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 14.02 5.57\",\n    width: \"53\",\n    height: \"21\",\n    style: \"vertical-align:middle\",\n    children: [jsx(\"path\", {\n      fill: \"currentColor\",\n      d: \"M1.88.92v.14c0 .41-.13.68-.4.8.33.14.46.44.46.86v.33c0 .61-.33.95-.95.95H0V0h.95c.65 0 .93.3.93.92zM.63.57v1.06h.24c.24 0 .38-.1.38-.43V.98c0-.28-.1-.4-.32-.4zm0 1.63v1.22h.36c.2 0 .32-.1.32-.39v-.35c0-.37-.12-.48-.4-.48H.63zM4.18.99v.52c0 .64-.31.98-.94.98h-.3V4h-.62V0h.92c.63 0 .94.35.94.99zM2.94.57v1.35h.3c.2 0 .3-.09.3-.37v-.6c0-.29-.1-.38-.3-.38h-.3zm2.89 2.27L6.25 0h.88v4h-.6V1.12L6.1 3.99h-.6l-.46-2.82v2.82h-.55V0h.87zM8.14 1.1V4h-.56V0h.79L9 2.4V0h.56v4h-.64zm2.49 2.29v.6h-.6v-.6zM12.12 1c0-.63.33-1 .95-1 .61 0 .95.37.95 1v2.04c0 .64-.34 1-.95 1-.62 0-.95-.37-.95-1zm.62 2.08c0 .28.13.39.33.39s.32-.1.32-.4V.98c0-.29-.12-.4-.32-.4s-.33.11-.33.4z\"\n    }), jsx(\"path\", {\n      fill: \"currentColor\",\n      d: \"M0 4.53h14.02v1.04H0zM11.08 0h.63v.62h-.63zm.63 4V1h-.63v2.98z\"\n    })]\n  });\n}\nfunction Lightbox(props) {\n  const {\n    open\n  } = props;\n  if (!open) {\n    return null;\n  }\n  return jsxs(\"div\", {\n    class: \"fjs-powered-by-lightbox\",\n    style: \"z-index: 100; position: fixed; top: 0; left: 0;right: 0; bottom: 0\",\n    children: [jsx(\"div\", {\n      class: \"backdrop\",\n      style: \"width: 100%; height: 100%; background: rgba(40 40 40 / 20%)\",\n      onClick: props.onBackdropClick\n    }), jsxs(\"div\", {\n      class: \"notice\",\n      style: \"position: absolute; left: 50%; top: 40%; transform: translate(-50%); width: 260px; padding: 10px; background: white; box-shadow: 0  1px 4px rgba(0 0 0 / 30%); font-family: Helvetica, Arial, sans-serif; font-size: 14px; display: flex; line-height: 1.3\",\n      children: [jsx(\"a\", {\n        href: \"https://bpmn.io\",\n        target: \"_blank\",\n        rel: \"noopener\",\n        style: \"margin: 15px 20px 15px 10px; align-self: center; color: var(--cds-icon-primary, #404040)\",\n        children: jsx(Logo, {})\n      }), jsxs(\"span\", {\n        children: [\"Web-based tooling for BPMN, DMN, and forms powered by \", jsx(\"a\", {\n          href: \"https://bpmn.io\",\n          target: \"_blank\",\n          rel: \"noopener\",\n          children: \"bpmn.io\"\n        }), \".\"]\n      })]\n    })]\n  });\n}\nfunction Link(props) {\n  return jsx(\"div\", {\n    class: \"fjs-powered-by fjs-form-field\",\n    style: \"text-align: right\",\n    children: jsx(\"a\", {\n      href: \"https://bpmn.io\",\n      target: \"_blank\",\n      rel: \"noopener\",\n      class: \"fjs-powered-by-link\",\n      title: \"Powered by bpmn.io\",\n      style: \"color: var(--cds-text-primary, #404040)\",\n      onClick: props.onClick,\n      children: jsx(Logo, {})\n    })\n  });\n}\nfunction PoweredBy(props) {\n  const [open, setOpen] = useState(false);\n  function toggleOpen(open) {\n    return event => {\n      event.preventDefault();\n      setOpen(open);\n    };\n  }\n  return jsxs(Fragment$1, {\n    children: [createPortal(jsx(Lightbox, {\n      open: open,\n      onBackdropClick: toggleOpen(false)\n    }), document.body), jsx(Link, {\n      onClick: toggleOpen(true)\n    })]\n  });\n}\nconst noop = () => {};\nfunction FormComponent(props) {\n  const form = useService('form');\n  const {\n    schema,\n    properties\n  } = form._getState();\n  const {\n    ariaLabel\n  } = properties;\n  const {\n    onSubmit = noop,\n    onReset = noop,\n    onChange = noop\n  } = props;\n  const handleSubmit = event => {\n    event.preventDefault();\n    onSubmit();\n  };\n  const handleReset = event => {\n    event.preventDefault();\n    onReset();\n  };\n  const filteredFormData = useFilteredFormData();\n  const localExpressionContext = useMemo(() => ({\n    data: filteredFormData,\n    parent: null,\n    this: filteredFormData,\n    i: []\n  }), [filteredFormData]);\n  return jsxs(\"form\", {\n    class: \"fjs-form\",\n    onSubmit: handleSubmit,\n    onReset: handleReset,\n    \"aria-label\": ariaLabel,\n    noValidate: true,\n    children: [jsx(LocalExpressionContext.Provider, {\n      value: localExpressionContext,\n      children: jsx(FormField, {\n        field: schema,\n        onChange: onChange\n      })\n    }), jsx(PoweredBy, {})]\n  });\n}\nconst formFields = [Button, Checkbox, Checklist, Default, DynamicList, Numberfield, Datetime, Radio, Select, Taglist, Textfield, Textarea, Text, Image, Table, Html, Spacer, Separator, Group, DynamicList, IFrame];\nclass FormFields {\n  constructor() {\n    this._formFields = {};\n    formFields.forEach(formField => {\n      this.register(formField.config.type, formField);\n    });\n  }\n  register(type, formField) {\n    this._formFields[type] = formField;\n  }\n  get(type) {\n    return this._formFields[type];\n  }\n}\nconst EXPRESSION_PROPERTIES = ['alt', 'appearance.prefixAdorner', 'appearance.suffixAdorner', 'conditional.hide', 'description', 'label', 'source', 'readonly', 'text', 'validate.min', 'validate.max', 'validate.minLength', 'validate.maxLength', 'valuesExpression', 'url', 'dataSource', 'columnsExpression'];\nconst TEMPLATE_PROPERTIES = ['alt', 'appearance.prefixAdorner', 'appearance.suffixAdorner', 'description', 'label', 'source', 'text', 'content', 'url'];\n\n/**\n * @typedef { import('../types').Schema } Schema\n */\n\n/**\n * Parse the schema for variables a form might make use of.\n *\n * @example\n *\n * // retrieve variables from schema\n * const variables = getSchemaVariables(schema);\n *\n * @example\n *\n * // retrieve input variables from schema\n * const inputVariables = getSchemaVariables(schema, { outputs: false });\n *\n * @example\n *\n * // retrieve output variables from schema\n * const outputVariables = getSchemaVariables(schema, { inputs: false });\n *\n * @param {Schema} schema\n * @param {object} [options]\n * @param {any} [options.expressionLanguage]\n * @param {any} [options.templating]\n * @param {any} [options.formFields]\n * @param {boolean} [options.inputs=true]\n * @param {boolean} [options.outputs=true]\n *\n * @return {string[]}\n */\nfunction getSchemaVariables(schema, options = {}) {\n  const {\n    formFields = new FormFields(),\n    expressionLanguage = new FeelExpressionLanguage(null),\n    templating = new FeelersTemplating(),\n    inputs = true,\n    outputs = true\n  } = options;\n  if (!schema.components) {\n    return [];\n  }\n  const getAllComponents = node => {\n    const components = [];\n    if (node.components) {\n      node.components.forEach(component => {\n        components.push(component);\n        components.push(...getAllComponents(component));\n      });\n    }\n    return components;\n  };\n  const variables = getAllComponents(schema).reduce((variables, component) => {\n    const {\n      valuesKey\n    } = component;\n\n    // collect input-only variables\n    if (inputs) {\n      if (valuesKey) {\n        variables = [...variables, valuesKey];\n      }\n      EXPRESSION_PROPERTIES.forEach(prop => {\n        const property = get(component, prop.split('.'));\n        if (property && expressionLanguage.isExpression(property)) {\n          const expressionVariables = expressionLanguage.getVariableNames(property, {\n            type: 'expression'\n          });\n          variables = [...variables, ...expressionVariables];\n        }\n      });\n      TEMPLATE_PROPERTIES.forEach(prop => {\n        const property = get(component, prop.split('.'));\n        if (property && !expressionLanguage.isExpression(property) && templating.isTemplate(property)) {\n          const templateVariables = templating.getVariableNames(property);\n          variables = [...variables, ...templateVariables];\n        }\n      });\n    }\n    return variables.filter(variable => typeof variable === 'string');\n  }, []);\n  const getBindingVariables = node => {\n    const bindingVariable = [];\n    const formField = formFields.get(node.type);\n    if (formField && formField.config.keyed && node.key) {\n      return [node.key.split('.')[0]];\n    } else if (formField && formField.config.pathed && node.path) {\n      return [node.path.split('.')[0]];\n    } else if (node.components) {\n      node.components.forEach(component => {\n        bindingVariable.push(...getBindingVariables(component));\n      });\n    }\n    return bindingVariable;\n  };\n\n  // collect binding variables\n  if (inputs || outputs) {\n    variables.push(...getBindingVariables(schema));\n  }\n\n  // remove duplicates\n  return Array.from(new Set(variables));\n}\n\n/**\n * Get the ancestry list of a form field.\n *\n * @param {string} formFieldId\n * @param {import('../core/FormFieldRegistry').FormFieldRegistry} formFieldRegistry\n *\n * @return {Array<string>} ancestry list\n */\nconst getAncestryList = (formFieldId, formFieldRegistry) => {\n  const ids = [];\n  let currentFormField = formFieldRegistry.get(formFieldId);\n  while (currentFormField) {\n    ids.push(currentFormField.id);\n    currentFormField = formFieldRegistry.get(currentFormField._parent);\n  }\n  return ids;\n};\n\n/**\n * @typedef {object} Condition\n * @property {string} [hide]\n */\n\nclass ConditionChecker {\n  constructor(formFieldRegistry, pathRegistry, eventBus) {\n    this._formFieldRegistry = formFieldRegistry;\n    this._pathRegistry = pathRegistry;\n    this._eventBus = eventBus;\n  }\n\n  /**\n   * For given data, remove properties based on condition.\n   *\n   * @param {Object<string, any>} data\n   * @param {Object<string, any>} contextData\n   * @param {Object} [options]\n   * @param {Function} [options.getFilterPath]\n   * @param {boolean} [options.leafNodeDeletionOnly]\n   */\n  applyConditions(data, contextData = {}, options = {}) {\n    const workingData = clone(data);\n    const {\n      getFilterPath = (field, indexes) => this._pathRegistry.getValuePath(field, {\n        indexes\n      }),\n      leafNodeDeletionOnly = false\n    } = options;\n    const _applyConditionsWithinScope = (rootField, scopeContext, startHidden = false) => {\n      const {\n        indexes = {},\n        expressionIndexes = [],\n        scopeData = contextData,\n        parentScopeData = null\n      } = scopeContext;\n      this._pathRegistry.executeRecursivelyOnFields(rootField, ({\n        field,\n        isClosed,\n        isRepeatable,\n        context\n      }) => {\n        const {\n          conditional,\n          components,\n          id\n        } = field;\n\n        // build the expression context in the right format\n        const localExpressionContext = buildExpressionContext({\n          this: scopeData,\n          data: contextData,\n          i: expressionIndexes,\n          parent: parentScopeData\n        });\n        context.isHidden = startHidden || context.isHidden || conditional && this._checkHideCondition(conditional, localExpressionContext);\n\n        // if a field is repeatable and visible, we need to implement custom recursion on its children\n        if (isRepeatable && (!context.isHidden || leafNodeDeletionOnly)) {\n          // prevent the regular recursion behavior of executeRecursivelyOnFields\n          context.preventRecursion = true;\n          const repeaterValuePath = this._pathRegistry.getValuePath(field, {\n            indexes\n          });\n          const repeaterValue = get(contextData, repeaterValuePath);\n\n          // quit early if there are no children or data associated with the repeater\n          if (!Array.isArray(repeaterValue) || !repeaterValue.length || !Array.isArray(components) || !components.length) {\n            return;\n          }\n          for (let i = 0; i < repeaterValue.length; i++) {\n            // create a new scope context for each index\n            const newScopeContext = {\n              indexes: {\n                ...indexes,\n                [id]: i\n              },\n              expressionIndexes: [...expressionIndexes, i + 1],\n              scopeData: repeaterValue[i],\n              parentScopeData: scopeData\n            };\n\n            // for each child component, apply conditions within the new repetition scope\n            components.forEach(component => {\n              _applyConditionsWithinScope(component, newScopeContext, context.isHidden);\n            });\n          }\n        }\n\n        // if we have a hidden repeatable field, and the data structure allows, we clear it directly at the root and stop recursion\n        if (context.isHidden && !leafNodeDeletionOnly && isRepeatable) {\n          context.preventRecursion = true;\n          this._cleanlyClearDataAtPath(getFilterPath(field, indexes), workingData);\n        }\n\n        // for simple leaf fields, we always clear\n        if (context.isHidden && isClosed) {\n          this._cleanlyClearDataAtPath(getFilterPath(field, indexes), workingData);\n        }\n      });\n    };\n\n    // apply conditions starting with the root of the form\n    const form = this._formFieldRegistry.getForm();\n    if (!form) {\n      throw new Error('form field registry has no form');\n    }\n    _applyConditionsWithinScope(form, {\n      scopeData: contextData\n    });\n    return workingData;\n  }\n\n  /**\n   * Check if given condition is met. Returns null for invalid/missing conditions.\n   *\n   * @param {string} condition\n   * @param {import('../../types').Data} [data]\n   *\n   * @returns {boolean|null}\n   */\n  check(condition, data = {}) {\n    if (!condition) {\n      return null;\n    }\n    if (!isString(condition) || !condition.startsWith('=')) {\n      return null;\n    }\n    try {\n      // cut off initial '='\n      const result = unaryTest(condition.slice(1), data);\n      return result;\n    } catch (error) {\n      this._eventBus.fire('error', {\n        error\n      });\n      return null;\n    }\n  }\n\n  /**\n   * Check if hide condition is met.\n   *\n   * @param {Condition} condition\n   * @param {Object<string, any>} data\n   * @returns {boolean}\n   */\n  _checkHideCondition(condition, data) {\n    if (!condition.hide) {\n      return false;\n    }\n    const result = this.check(condition.hide, data);\n    return result === true;\n  }\n  _cleanlyClearDataAtPath(valuePath, obj) {\n    const workingValuePath = [...valuePath];\n    let recurse = false;\n    do {\n      set(obj, workingValuePath, undefined);\n      workingValuePath.pop();\n      const parentObject = get(obj, workingValuePath);\n      recurse = !!workingValuePath.length && (this._isEmptyObject(parentObject) || this._isEmptyArray(parentObject));\n    } while (recurse);\n  }\n  _isEmptyObject(parentObject) {\n    return isObject(parentObject) && !values(parentObject).length;\n  }\n  _isEmptyArray(parentObject) {\n    return Array.isArray(parentObject) && (!parentObject.length || parentObject.every(item => item === undefined));\n  }\n}\nConditionChecker.$inject = ['formFieldRegistry', 'pathRegistry', 'eventBus'];\nconst ExpressionLanguageModule = {\n  __init__: ['expressionLanguage', 'templating', 'conditionChecker'],\n  expressionLanguage: ['type', FeelExpressionLanguage],\n  templating: ['type', FeelersTemplating],\n  conditionChecker: ['type', ConditionChecker]\n};\n\n// bootstrap showdown to support github flavored markdown\nshowdown.setFlavor('github');\nclass MarkdownRenderer {\n  constructor() {\n    this._converter = new showdown.Converter();\n  }\n\n  /**\n   * Render markdown to HTML.\n   *\n   * @param {string} markdown - The markdown to render\n   *\n   * @returns {string} HTML\n   */\n  render(markdown) {\n    return this._converter.makeHtml(markdown);\n  }\n}\nMarkdownRenderer.$inject = [];\nconst MarkdownRendererModule = {\n  __init__: ['markdownRenderer'],\n  markdownRenderer: ['type', MarkdownRenderer]\n};\n\n/**\n * @typedef {import('didi').Injector} Injector\n *\n * @typedef {import('../core/Types').ElementLike} ElementLike\n *\n * @typedef {import('../core/EventBus').default} EventBus\n * @typedef {import('./CommandHandler').default} CommandHandler\n *\n * @typedef { any } CommandContext\n * @typedef { {\n *   new (...args: any[]) : CommandHandler\n * } } CommandHandlerConstructor\n * @typedef { {\n *   [key: string]: CommandHandler;\n * } } CommandHandlerMap\n * @typedef { {\n *   command: string;\n *   context: any;\n *   id?: any;\n * } } CommandStackAction\n * @typedef { {\n *   actions: CommandStackAction[];\n *   dirty: ElementLike[];\n *   trigger: 'execute' | 'undo' | 'redo' | 'clear' | null;\n *   atomic?: boolean;\n * } } CurrentExecution\n */\n\n/**\n * A service that offers un- and redoable execution of commands.\n *\n * The command stack is responsible for executing modeling actions\n * in a un- and redoable manner. To do this it delegates the actual\n * command execution to {@link CommandHandler}s.\n *\n * Command handlers provide {@link CommandHandler#execute(ctx)} and\n * {@link CommandHandler#revert(ctx)} methods to un- and redo a command\n * identified by a command context.\n *\n *\n * ## Life-Cycle events\n *\n * In the process the command stack fires a number of life-cycle events\n * that other components to participate in the command execution.\n *\n *    * preExecute\n *    * preExecuted\n *    * execute\n *    * executed\n *    * postExecute\n *    * postExecuted\n *    * revert\n *    * reverted\n *\n * A special event is used for validating, whether a command can be\n * performed prior to its execution.\n *\n *    * canExecute\n *\n * Each of the events is fired as `commandStack.{eventName}` and\n * `commandStack.{commandName}.{eventName}`, respectively. This gives\n * components fine grained control on where to hook into.\n *\n * The event object fired transports `command`, the name of the\n * command and `context`, the command context.\n *\n *\n * ## Creating Command Handlers\n *\n * Command handlers should provide the {@link CommandHandler#execute(ctx)}\n * and {@link CommandHandler#revert(ctx)} methods to implement\n * redoing and undoing of a command.\n *\n * A command handler _must_ ensure undo is performed properly in order\n * not to break the undo chain. It must also return the shapes that\n * got changed during the `execute` and `revert` operations.\n *\n * Command handlers may execute other modeling operations (and thus\n * commands) in their `preExecute(d)` and `postExecute(d)` phases. The command\n * stack will properly group all commands together into a logical unit\n * that may be re- and undone atomically.\n *\n * Command handlers must not execute other commands from within their\n * core implementation (`execute`, `revert`).\n *\n *\n * ## Change Tracking\n *\n * During the execution of the CommandStack it will keep track of all\n * elements that have been touched during the command's execution.\n *\n * At the end of the CommandStack execution it will notify interested\n * components via an 'elements.changed' event with all the dirty\n * elements.\n *\n * The event can be picked up by components that are interested in the fact\n * that elements have been changed. One use case for this is updating\n * their graphical representation after moving / resizing or deletion.\n *\n * @see CommandHandler\n *\n * @param {EventBus} eventBus\n * @param {Injector} injector\n */\nfunction CommandStack(eventBus, injector) {\n  /**\n   * A map of all registered command handlers.\n   *\n   * @type {CommandHandlerMap}\n   */\n  this._handlerMap = {};\n\n  /**\n   * A stack containing all re/undoable actions on the diagram\n   *\n   * @type {CommandStackAction[]}\n   */\n  this._stack = [];\n\n  /**\n   * The current index on the stack\n   *\n   * @type {number}\n   */\n  this._stackIdx = -1;\n\n  /**\n   * Current active commandStack execution\n   *\n   * @type {CurrentExecution}\n   */\n  this._currentExecution = {\n    actions: [],\n    dirty: [],\n    trigger: null\n  };\n\n  /**\n   * @type {Injector}\n   */\n  this._injector = injector;\n\n  /**\n   * @type EventBus\n   */\n  this._eventBus = eventBus;\n\n  /**\n   * @type { number }\n   */\n  this._uid = 1;\n  eventBus.on(['diagram.destroy', 'diagram.clear'], function () {\n    this.clear(false);\n  }, this);\n}\nCommandStack.$inject = ['eventBus', 'injector'];\n\n/**\n * Execute a command.\n *\n * @param {string} command The command to execute.\n * @param {CommandContext} context The context with which to execute the command.\n */\nCommandStack.prototype.execute = function (command, context) {\n  if (!command) {\n    throw new Error('command required');\n  }\n  this._currentExecution.trigger = 'execute';\n  const action = {\n    command: command,\n    context: context\n  };\n  this._pushAction(action);\n  this._internalExecute(action);\n  this._popAction();\n};\n\n/**\n * Check whether a command can be executed.\n *\n * Implementors may hook into the mechanism on two ways:\n *\n *   * in event listeners:\n *\n *     Users may prevent the execution via an event listener.\n *     It must prevent the default action for `commandStack.(<command>.)canExecute` events.\n *\n *   * in command handlers:\n *\n *     If the method {@link CommandHandler#canExecute} is implemented in a handler\n *     it will be called to figure out whether the execution is allowed.\n *\n * @param {string} command The command to execute.\n * @param {CommandContext} context The context with which to execute the command.\n *\n * @return {boolean} Whether the command can be executed with the given context.\n */\nCommandStack.prototype.canExecute = function (command, context) {\n  const action = {\n    command: command,\n    context: context\n  };\n  const handler = this._getHandler(command);\n  let result = this._fire(command, 'canExecute', action);\n\n  // handler#canExecute will only be called if no listener\n  // decided on a result already\n  if (result === undefined) {\n    if (!handler) {\n      return false;\n    }\n    if (handler.canExecute) {\n      result = handler.canExecute(context);\n    }\n  }\n  return result;\n};\n\n/**\n * Clear the command stack, erasing all undo / redo history.\n *\n * @param {boolean} [emit=true] Whether to fire an event. Defaults to `true`.\n */\nCommandStack.prototype.clear = function (emit) {\n  this._stack.length = 0;\n  this._stackIdx = -1;\n  if (emit !== false) {\n    this._fire('changed', {\n      trigger: 'clear'\n    });\n  }\n};\n\n/**\n * Undo last command(s)\n */\nCommandStack.prototype.undo = function () {\n  let action = this._getUndoAction(),\n    next;\n  if (action) {\n    this._currentExecution.trigger = 'undo';\n    this._pushAction(action);\n    while (action) {\n      this._internalUndo(action);\n      next = this._getUndoAction();\n      if (!next || next.id !== action.id) {\n        break;\n      }\n      action = next;\n    }\n    this._popAction();\n  }\n};\n\n/**\n * Redo last command(s)\n */\nCommandStack.prototype.redo = function () {\n  let action = this._getRedoAction(),\n    next;\n  if (action) {\n    this._currentExecution.trigger = 'redo';\n    this._pushAction(action);\n    while (action) {\n      this._internalExecute(action, true);\n      next = this._getRedoAction();\n      if (!next || next.id !== action.id) {\n        break;\n      }\n      action = next;\n    }\n    this._popAction();\n  }\n};\n\n/**\n * Register a handler instance with the command stack.\n *\n * @param {string} command Command to be executed.\n * @param {CommandHandler} handler Handler to execute the command.\n */\nCommandStack.prototype.register = function (command, handler) {\n  this._setHandler(command, handler);\n};\n\n/**\n * Register a handler type with the command stack  by instantiating it and\n * injecting its dependencies.\n *\n * @param {string} command Command to be executed.\n * @param {CommandHandlerConstructor} handlerCls Constructor to instantiate a {@link CommandHandler}.\n */\nCommandStack.prototype.registerHandler = function (command, handlerCls) {\n  if (!command || !handlerCls) {\n    throw new Error('command and handlerCls must be defined');\n  }\n  const handler = this._injector.instantiate(handlerCls);\n  this.register(command, handler);\n};\n\n/**\n * @return {boolean}\n */\nCommandStack.prototype.canUndo = function () {\n  return !!this._getUndoAction();\n};\n\n/**\n * @return {boolean}\n */\nCommandStack.prototype.canRedo = function () {\n  return !!this._getRedoAction();\n};\n\n// stack access  //////////////////////\n\nCommandStack.prototype._getRedoAction = function () {\n  return this._stack[this._stackIdx + 1];\n};\nCommandStack.prototype._getUndoAction = function () {\n  return this._stack[this._stackIdx];\n};\n\n// internal functionality //////////////////////\n\nCommandStack.prototype._internalUndo = function (action) {\n  const command = action.command,\n    context = action.context;\n  const handler = this._getHandler(command);\n\n  // guard against illegal nested command stack invocations\n  this._atomicDo(() => {\n    this._fire(command, 'revert', action);\n    if (handler.revert) {\n      this._markDirty(handler.revert(context));\n    }\n    this._revertedAction(action);\n    this._fire(command, 'reverted', action);\n  });\n};\nCommandStack.prototype._fire = function (command, qualifier, event) {\n  if (arguments.length < 3) {\n    event = qualifier;\n    qualifier = null;\n  }\n  const names = qualifier ? [command + '.' + qualifier, qualifier] : [command];\n  let result;\n  event = this._eventBus.createEvent(event);\n  for (const name of names) {\n    result = this._eventBus.fire('commandStack.' + name, event);\n    if (event.cancelBubble) {\n      break;\n    }\n  }\n  return result;\n};\nCommandStack.prototype._createId = function () {\n  return this._uid++;\n};\nCommandStack.prototype._atomicDo = function (fn) {\n  const execution = this._currentExecution;\n  execution.atomic = true;\n  try {\n    fn();\n  } finally {\n    execution.atomic = false;\n  }\n};\nCommandStack.prototype._internalExecute = function (action, redo) {\n  const command = action.command,\n    context = action.context;\n  const handler = this._getHandler(command);\n  if (!handler) {\n    throw new Error('no command handler registered for <' + command + '>');\n  }\n  this._pushAction(action);\n  if (!redo) {\n    this._fire(command, 'preExecute', action);\n    if (handler.preExecute) {\n      handler.preExecute(context);\n    }\n    this._fire(command, 'preExecuted', action);\n  }\n\n  // guard against illegal nested command stack invocations\n  this._atomicDo(() => {\n    this._fire(command, 'execute', action);\n    if (handler.execute) {\n      // actual execute + mark return results as dirty\n      this._markDirty(handler.execute(context));\n    }\n\n    // log to stack\n    this._executedAction(action, redo);\n    this._fire(command, 'executed', action);\n  });\n  if (!redo) {\n    this._fire(command, 'postExecute', action);\n    if (handler.postExecute) {\n      handler.postExecute(context);\n    }\n    this._fire(command, 'postExecuted', action);\n  }\n  this._popAction();\n};\nCommandStack.prototype._pushAction = function (action) {\n  const execution = this._currentExecution,\n    actions = execution.actions;\n  const baseAction = actions[0];\n  if (execution.atomic) {\n    throw new Error('illegal invocation in <execute> or <revert> phase (action: ' + action.command + ')');\n  }\n  if (!action.id) {\n    action.id = baseAction && baseAction.id || this._createId();\n  }\n  actions.push(action);\n};\nCommandStack.prototype._popAction = function () {\n  const execution = this._currentExecution,\n    trigger = execution.trigger,\n    actions = execution.actions,\n    dirty = execution.dirty;\n  actions.pop();\n  if (!actions.length) {\n    this._eventBus.fire('elements.changed', {\n      elements: uniqueBy('id', dirty.reverse())\n    });\n    dirty.length = 0;\n    this._fire('changed', {\n      trigger: trigger\n    });\n    execution.trigger = null;\n  }\n};\nCommandStack.prototype._markDirty = function (elements) {\n  const execution = this._currentExecution;\n  if (!elements) {\n    return;\n  }\n  elements = isArray(elements) ? elements : [elements];\n  execution.dirty = execution.dirty.concat(elements);\n};\nCommandStack.prototype._executedAction = function (action, redo) {\n  const stackIdx = ++this._stackIdx;\n  if (!redo) {\n    this._stack.splice(stackIdx, this._stack.length, action);\n  }\n};\nCommandStack.prototype._revertedAction = function (action) {\n  this._stackIdx--;\n};\nCommandStack.prototype._getHandler = function (command) {\n  return this._handlerMap[command];\n};\nCommandStack.prototype._setHandler = function (command, handler) {\n  if (!command || !handler) {\n    throw new Error('command and handler required');\n  }\n  if (this._handlerMap[command]) {\n    throw new Error('overriding handler for command <' + command + '>');\n  }\n  this._handlerMap[command] = handler;\n};\n\n/**\n * @type { import('didi').ModuleDeclaration }\n */\nvar commandModule = {\n  commandStack: ['type', CommandStack]\n};\nclass UpdateFieldValidationHandler {\n  constructor(form, validator) {\n    this._form = form;\n    this._validator = validator;\n  }\n  execute(context) {\n    const {\n      field,\n      value,\n      indexes\n    } = context;\n    const {\n      errors\n    } = this._form._getState();\n    context.oldErrors = clone(errors);\n    const fieldErrors = this._validator.validateField(field, value);\n    const updatedErrors = set(errors, [field.id, ...Object.values(indexes || {})], fieldErrors.length ? fieldErrors : undefined);\n    this._form._setState({\n      errors: updatedErrors\n    });\n  }\n  revert(context) {\n    this._form._setState({\n      errors: context.oldErrors\n    });\n  }\n}\nUpdateFieldValidationHandler.$inject = ['form', 'validator'];\nclass ViewerCommands {\n  constructor(commandStack, eventBus) {\n    this._commandStack = commandStack;\n    eventBus.on('form.init', () => {\n      this.registerHandlers();\n    });\n  }\n  registerHandlers() {\n    Object.entries(this.getHandlers()).forEach(([id, handler]) => {\n      this._commandStack.registerHandler(id, handler);\n    });\n  }\n  getHandlers() {\n    return {\n      'formField.validation.update': UpdateFieldValidationHandler\n    };\n  }\n  updateFieldValidation(field, value, indexes) {\n    const context = {\n      field,\n      value,\n      indexes\n    };\n    this._commandStack.execute('formField.validation.update', context);\n  }\n}\nViewerCommands.$inject = ['commandStack', 'eventBus'];\nconst ViewerCommandsModule = {\n  __depends__: [commandModule],\n  __init__: ['viewerCommands'],\n  viewerCommands: ['type', ViewerCommands]\n};\nvar _path$3;\nfunction _extends$3() {\n  _extends$3 = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$3.apply(this, arguments);\n}\nvar SvgExpand = function SvgExpand(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$3({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 16,\n    height: 16,\n    fill: \"none\"\n  }, props), _path$3 || (_path$3 = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentColor\",\n    d: \"M2 9h5.5v3.086l-1.293-1.293-.707.707L8 14l2.5-2.5-.707-.707L8.5 12.086V9H14V8H2v1Zm11-7H3a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1Zm0 3H3V3h10v2Z\"\n  })));\n};\nvar ExpandSvg = SvgExpand;\nvar _path$2;\nfunction _extends$2() {\n  _extends$2 = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$2.apply(this, arguments);\n}\nvar SvgCollapse = function SvgCollapse(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$2({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 16,\n    height: 16,\n    fill: \"none\"\n  }, props), _path$2 || (_path$2 = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentColor\",\n    d: \"M13 10H3a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1Zm0 3H3v-2h10v2ZM8.5 3.914l1.293 1.293.707-.707L8 2 5.5 4.5l.707.707L7.5 3.914V7H2v1h12V7H8.5V3.914Z\"\n  })));\n};\nvar CollapseSvg = SvgCollapse;\nvar _path$1, _path2;\nfunction _extends$1() {\n  _extends$1 = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends$1.apply(this, arguments);\n}\nvar SvgAdd = function SvgAdd(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends$1({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 16,\n    height: 16,\n    fill: \"none\"\n  }, props), _path$1 || (_path$1 = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentColor\",\n    d: \"M8 2c3.3 0 6 2.7 6 6s-2.7 6-6 6-6-2.7-6-6 2.7-6 6-6Zm0-1C4.15 1 1 4.15 1 8s3.15 7 7 7 7-3.15 7-7-3.15-7-7-7Z\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentColor\",\n    d: \"M12 7.5H8.5V4h-1v3.5H4v1h3.5V12h1V8.5H12v-1Z\"\n  })));\n};\nvar AddSvg = SvgAdd;\nvar _path;\nfunction _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\nvar SvgDelete = function SvgDelete(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 16,\n    height: 16,\n    fill: \"none\"\n  }, props), _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentColor\",\n    d: \"m12 4.7-.7-.7L8 7.3 4.7 4l-.7.7L7.3 8 4 11.3l.7.7L8 8.7l3.3 3.3.7-.7L8.7 8 12 4.7Z\"\n  })));\n};\nvar DeleteSvg = SvgDelete;\n\n// disable react hook rules as the linter is confusing the functional components within a class as class components\nclass RepeatRenderManager {\n  constructor(form, formFields, formFieldRegistry, pathRegistry) {\n    this._form = form;\n    this._formFields = formFields;\n    this._formFieldRegistry = formFieldRegistry;\n    this._pathRegistry = pathRegistry;\n    this.Repeater = this.Repeater.bind(this);\n    this.RepeatFooter = this.RepeatFooter.bind(this);\n  }\n\n  /**\n   * Checks whether a field is currently repeating its children.\n   *\n   * @param {string} id - The id of the field to check\n   * @returns {boolean} - True if repeatable, false otherwise\n   */\n  isFieldRepeating(id) {\n    if (!id) {\n      return false;\n    }\n    const formField = this._formFieldRegistry.get(id);\n    const formFieldDefinition = this._formFields.get(formField.type);\n    return formFieldDefinition.config.repeatable && formField.isRepeating;\n  }\n  Repeater(props) {\n    const {\n      RowsRenderer,\n      indexes,\n      useSharedState,\n      ...restProps\n    } = props;\n    const [sharedRepeatState] = useSharedState;\n    const {\n      data\n    } = this._form._getState();\n    const repeaterField = props.field;\n    const dataPath = this._pathRegistry.getValuePath(repeaterField, {\n      indexes\n    });\n    const values = get(data, dataPath) || [];\n    const nonCollapsedItems = this._getNonCollapsedItems(repeaterField);\n    const collapseEnabled = !repeaterField.disableCollapse && values.length > nonCollapsedItems;\n    const isCollapsed = collapseEnabled && sharedRepeatState.isCollapsed;\n    const hasChildren = repeaterField.components && repeaterField.components.length > 0;\n    const showRemove = repeaterField.allowAddRemove && hasChildren;\n    const displayValues = isCollapsed ? values.slice(0, nonCollapsedItems) : values;\n    const onDeleteItem = index => {\n      const updatedValues = values.slice();\n      updatedValues.splice(index, 1);\n      props.onChange({\n        field: repeaterField,\n        value: updatedValues,\n        indexes\n      });\n    };\n    const parentExpressionContextInfo = useContext(LocalExpressionContext);\n    return jsx(Fragment, {\n      children: displayValues.map((itemValue, itemIndex) => jsx(RepetitionScaffold, {\n        itemIndex: itemIndex,\n        itemValue: itemValue,\n        parentExpressionContextInfo: parentExpressionContextInfo,\n        repeaterField: repeaterField,\n        RowsRenderer: RowsRenderer,\n        indexes: indexes,\n        onDeleteItem: onDeleteItem,\n        showRemove: showRemove,\n        ...restProps\n      }, itemIndex))\n    });\n  }\n  RepeatFooter(props) {\n    const addButtonRef = useRef(null);\n    const {\n      useSharedState,\n      indexes,\n      field: repeaterField,\n      readonly,\n      disabled\n    } = props;\n    const [sharedRepeatState, setSharedRepeatState] = useSharedState;\n    const {\n      data\n    } = this._form._getState();\n    const dataPath = this._pathRegistry.getValuePath(repeaterField, {\n      indexes\n    });\n    const values = get(data, dataPath) || [];\n    const nonCollapsedItems = this._getNonCollapsedItems(repeaterField);\n    const collapseEnabled = !repeaterField.disableCollapse && values.length > nonCollapsedItems;\n    const isCollapsed = collapseEnabled && sharedRepeatState.isCollapsed;\n    const hasChildren = repeaterField.components && repeaterField.components.length > 0;\n    const showAdd = repeaterField.allowAddRemove && hasChildren;\n    const toggle = () => {\n      setSharedRepeatState(state => ({\n        ...state,\n        isCollapsed: !isCollapsed\n      }));\n    };\n    const shouldScroll = useRef(false);\n    const onAddItem = () => {\n      const updatedValues = values.slice();\n      const newItem = this._form._getInitializedFieldData(this._form._getState().data, {\n        container: repeaterField,\n        indexes: {\n          ...indexes,\n          [repeaterField.id]: updatedValues.length\n        }\n      });\n      updatedValues.push(newItem);\n      shouldScroll.current = true;\n      props.onChange({\n        field: repeaterField,\n        value: updatedValues,\n        indexes\n      });\n      setSharedRepeatState(state => ({\n        ...state,\n        isCollapsed: false\n      }));\n    };\n    useScrollIntoView(addButtonRef, [values.length], {\n      align: 'bottom',\n      behavior: 'auto',\n      offset: 20\n    }, [shouldScroll]);\n    return jsxs(\"div\", {\n      className: classNames('fjs-repeat-render-footer', {\n        'fjs-remove-allowed': repeaterField.allowAddRemove\n      }),\n      children: [showAdd ? jsx(\"button\", {\n        type: \"button\",\n        readOnly: readonly,\n        disabled: disabled || readonly,\n        class: \"fjs-repeat-render-add\",\n        ref: addButtonRef,\n        onClick: onAddItem,\n        children: jsxs(Fragment, {\n          children: [jsx(AddSvg, {}), \" \", 'Add new']\n        })\n      }) : null, collapseEnabled ? jsx(\"button\", {\n        type: \"button\",\n        class: \"fjs-repeat-render-collapse\",\n        onClick: toggle,\n        children: isCollapsed ? jsxs(Fragment, {\n          children: [jsx(ExpandSvg, {}), \" \", `Expand all (${values.length})`]\n        }) : jsxs(Fragment, {\n          children: [jsx(CollapseSvg, {}), \" \", 'Collapse']\n        })\n      }) : null]\n    });\n  }\n  _getNonCollapsedItems(field) {\n    const DEFAULT_NON_COLLAPSED_ITEMS = 5;\n    const {\n      nonCollapsedItems\n    } = field;\n    return nonCollapsedItems ? nonCollapsedItems : DEFAULT_NON_COLLAPSED_ITEMS;\n  }\n}\n\n/**\n * Individual repetition of a repeated field and context scaffolding.\n *\n * @param {Object} props\n * @param {number} props.itemIndex\n * @param {Object} props.itemValue\n * @param {Object} props.parentExpressionContextInfo\n * @param {Object} props.repeaterField\n * @param {Function} props.RowsRenderer\n * @param {Object} props.indexes\n * @param {Function} props.onDeleteItem\n * @param {boolean} props.showRemove\n */\n\nconst RepetitionScaffold = props => {\n  const {\n    itemIndex,\n    itemValue,\n    parentExpressionContextInfo,\n    repeaterField,\n    RowsRenderer,\n    indexes,\n    onDeleteItem,\n    showRemove,\n    ...restProps\n  } = props;\n  const elementProps = useMemo(() => ({\n    ...restProps,\n    indexes: {\n      ...(indexes || {}),\n      [repeaterField.id]: itemIndex\n    }\n  }), [itemIndex, indexes, repeaterField.id, restProps]);\n  const localExpressionContextInfo = useMemo(() => ({\n    data: parentExpressionContextInfo.data,\n    this: itemValue,\n    parent: buildExpressionContext(parentExpressionContextInfo),\n    i: [...parentExpressionContextInfo.i, itemIndex + 1]\n  }), [itemIndex, parentExpressionContextInfo, itemValue]);\n  return !showRemove ? jsx(LocalExpressionContext.Provider, {\n    value: localExpressionContextInfo,\n    children: jsx(RowsRenderer, {\n      ...elementProps\n    })\n  }) : jsxs(\"div\", {\n    class: \"fjs-repeat-row-container\",\n    children: [jsx(\"div\", {\n      class: \"fjs-repeat-row-rows\",\n      children: jsx(LocalExpressionContext.Provider, {\n        value: localExpressionContextInfo,\n        children: jsx(RowsRenderer, {\n          ...elementProps\n        })\n      })\n    }), jsx(\"button\", {\n      type: \"button\",\n      class: \"fjs-repeat-row-remove\",\n      \"aria-label\": `Remove list item ${itemIndex + 1}`,\n      onClick: () => onDeleteItem(itemIndex),\n      children: jsx(\"div\", {\n        class: \"fjs-repeat-row-remove-icon-container\",\n        children: jsx(DeleteSvg, {})\n      })\n    })]\n  });\n};\nRepeatRenderManager.$inject = ['form', 'formFields', 'formFieldRegistry', 'pathRegistry'];\nconst RepeatRenderModule = {\n  __init__: ['repeatRenderManager'],\n  repeatRenderManager: ['type', RepeatRenderManager]\n};\nvar FN_REF = '__fn';\nvar DEFAULT_PRIORITY = 1000;\nvar slice = Array.prototype.slice;\n\n/**\n * @typedef { {\n *   stopPropagation(): void;\n *   preventDefault(): void;\n *   cancelBubble: boolean;\n *   defaultPrevented: boolean;\n *   returnValue: any;\n * } } Event\n */\n\n/**\n * @template E\n *\n * @typedef { (event: E & Event, ...any) => any } EventBusEventCallback\n */\n\n/**\n * @typedef { {\n *  priority: number;\n *  next: EventBusListener | null;\n *  callback: EventBusEventCallback<any>;\n * } } EventBusListener\n */\n\n/**\n * A general purpose event bus.\n *\n * This component is used to communicate across a diagram instance.\n * Other parts of a diagram can use it to listen to and broadcast events.\n *\n *\n * ## Registering for Events\n *\n * The event bus provides the {@link EventBus#on} and {@link EventBus#once}\n * methods to register for events. {@link EventBus#off} can be used to\n * remove event registrations. Listeners receive an instance of {@link Event}\n * as the first argument. It allows them to hook into the event execution.\n *\n * ```javascript\n *\n * // listen for event\n * eventBus.on('foo', function(event) {\n *\n *   // access event type\n *   event.type; // 'foo'\n *\n *   // stop propagation to other listeners\n *   event.stopPropagation();\n *\n *   // prevent event default\n *   event.preventDefault();\n * });\n *\n * // listen for event with custom payload\n * eventBus.on('bar', function(event, payload) {\n *   console.log(payload);\n * });\n *\n * // listen for event returning value\n * eventBus.on('foobar', function(event) {\n *\n *   // stop event propagation + prevent default\n *   return false;\n *\n *   // stop event propagation + return custom result\n *   return {\n *     complex: 'listening result'\n *   };\n * });\n *\n *\n * // listen with custom priority (default=1000, higher is better)\n * eventBus.on('priorityfoo', 1500, function(event) {\n *   console.log('invoked first!');\n * });\n *\n *\n * // listen for event and pass the context (`this`)\n * eventBus.on('foobar', function(event) {\n *   this.foo();\n * }, this);\n * ```\n *\n *\n * ## Emitting Events\n *\n * Events can be emitted via the event bus using {@link EventBus#fire}.\n *\n * ```javascript\n *\n * // false indicates that the default action\n * // was prevented by listeners\n * if (eventBus.fire('foo') === false) {\n *   console.log('default has been prevented!');\n * };\n *\n *\n * // custom args + return value listener\n * eventBus.on('sum', function(event, a, b) {\n *   return a + b;\n * });\n *\n * // you can pass custom arguments + retrieve result values.\n * var sum = eventBus.fire('sum', 1, 2);\n * console.log(sum); // 3\n * ```\n */\nfunction EventBus() {\n  /**\n   * @type { Record<string, EventBusListener> }\n   */\n  this._listeners = {};\n\n  // cleanup on destroy on lowest priority to allow\n  // message passing until the bitter end\n  this.on('diagram.destroy', 1, this._destroy, this);\n}\n\n/**\n * Register an event listener for events with the given name.\n *\n * The callback will be invoked with `event, ...additionalArguments`\n * that have been passed to {@link EventBus#fire}.\n *\n * Returning false from a listener will prevent the events default action\n * (if any is specified). To stop an event from being processed further in\n * other listeners execute {@link Event#stopPropagation}.\n *\n * Returning anything but `undefined` from a listener will stop the listener propagation.\n *\n * @template T\n *\n * @param {string|string[]} events to subscribe to\n * @param {number} [priority=1000] listen priority\n * @param {EventBusEventCallback<T>} callback\n * @param {any} [that] callback context\n */\nEventBus.prototype.on = function (events, priority, callback, that) {\n  events = isArray(events) ? events : [events];\n  if (isFunction(priority)) {\n    that = callback;\n    callback = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n  if (!isNumber(priority)) {\n    throw new Error('priority must be a number');\n  }\n  var actualCallback = callback;\n  if (that) {\n    actualCallback = bind(callback, that);\n\n    // make sure we remember and are able to remove\n    // bound callbacks via {@link #off} using the original\n    // callback\n    actualCallback[FN_REF] = callback[FN_REF] || callback;\n  }\n  var self = this;\n  events.forEach(function (e) {\n    self._addListener(e, {\n      priority: priority,\n      callback: actualCallback,\n      next: null\n    });\n  });\n};\n\n/**\n * Register an event listener that is called only once.\n *\n * @template T\n *\n * @param {string|string[]} events to subscribe to\n * @param {number} [priority=1000] the listen priority\n * @param {EventBusEventCallback<T>} callback\n * @param {any} [that] callback context\n */\nEventBus.prototype.once = function (events, priority, callback, that) {\n  var self = this;\n  if (isFunction(priority)) {\n    that = callback;\n    callback = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n  if (!isNumber(priority)) {\n    throw new Error('priority must be a number');\n  }\n  function wrappedCallback() {\n    wrappedCallback.__isTomb = true;\n    var result = callback.apply(that, arguments);\n    self.off(events, wrappedCallback);\n    return result;\n  }\n\n  // make sure we remember and are able to remove\n  // bound callbacks via {@link #off} using the original\n  // callback\n  wrappedCallback[FN_REF] = callback;\n  this.on(events, priority, wrappedCallback);\n};\n\n/**\n * Removes event listeners by event and callback.\n *\n * If no callback is given, all listeners for a given event name are being removed.\n *\n * @param {string|string[]} events\n * @param {EventBusEventCallback} [callback]\n */\nEventBus.prototype.off = function (events, callback) {\n  events = isArray(events) ? events : [events];\n  var self = this;\n  events.forEach(function (event) {\n    self._removeListener(event, callback);\n  });\n};\n\n/**\n * Create an event recognized be the event bus.\n *\n * @param {Object} data Event data.\n *\n * @return {Event} An event that will be recognized by the event bus.\n */\nEventBus.prototype.createEvent = function (data) {\n  var event = new InternalEvent();\n  event.init(data);\n  return event;\n};\n\n/**\n * Fires an event.\n *\n * @example\n *\n * ```javascript\n * // fire event by name\n * events.fire('foo');\n *\n * // fire event object with nested type\n * var event = { type: 'foo' };\n * events.fire(event);\n *\n * // fire event with explicit type\n * var event = { x: 10, y: 20 };\n * events.fire('element.moved', event);\n *\n * // pass additional arguments to the event\n * events.on('foo', function(event, bar) {\n *   alert(bar);\n * });\n *\n * events.fire({ type: 'foo' }, 'I am bar!');\n * ```\n *\n * @param {string} [type] event type\n * @param {Object} [data] event or event data\n * @param {...any} [args] additional arguments the callback will be called with.\n *\n * @return {any} The return value. Will be set to `false` if the default was prevented.\n */\nEventBus.prototype.fire = function (type, data) {\n  var event, firstListener, returnValue, args;\n  args = slice.call(arguments);\n  if (typeof type === 'object') {\n    data = type;\n    type = data.type;\n  }\n  if (!type) {\n    throw new Error('no event type specified');\n  }\n  firstListener = this._listeners[type];\n  if (!firstListener) {\n    return;\n  }\n\n  // we make sure we fire instances of our home made\n  // events here. We wrap them only once, though\n  if (data instanceof InternalEvent) {\n    // we are fine, we alread have an event\n    event = data;\n  } else {\n    event = this.createEvent(data);\n  }\n\n  // ensure we pass the event as the first parameter\n  args[0] = event;\n\n  // original event type (in case we delegate)\n  var originalType = event.type;\n\n  // update event type before delegation\n  if (type !== originalType) {\n    event.type = type;\n  }\n  try {\n    returnValue = this._invokeListeners(event, args, firstListener);\n  } finally {\n    // reset event type after delegation\n    if (type !== originalType) {\n      event.type = originalType;\n    }\n  }\n\n  // set the return value to false if the event default\n  // got prevented and no other return value exists\n  if (returnValue === undefined && event.defaultPrevented) {\n    returnValue = false;\n  }\n  return returnValue;\n};\n\n/**\n * Handle an error by firing an event.\n *\n * @param {Error} error The error to be handled.\n *\n * @return {boolean} Whether the error was handled.\n */\nEventBus.prototype.handleError = function (error) {\n  return this.fire('error', {\n    error: error\n  }) === false;\n};\nEventBus.prototype._destroy = function () {\n  this._listeners = {};\n};\n\n/**\n * @param {Event} event\n * @param {any[]} args\n * @param {EventBusListener} listener\n *\n * @return {any}\n */\nEventBus.prototype._invokeListeners = function (event, args, listener) {\n  var returnValue;\n  while (listener) {\n    // handle stopped propagation\n    if (event.cancelBubble) {\n      break;\n    }\n    returnValue = this._invokeListener(event, args, listener);\n    listener = listener.next;\n  }\n  return returnValue;\n};\n\n/**\n * @param {Event} event\n * @param {any[]} args\n * @param {EventBusListener} listener\n *\n * @return {any}\n */\nEventBus.prototype._invokeListener = function (event, args, listener) {\n  var returnValue;\n  if (listener.callback.__isTomb) {\n    return returnValue;\n  }\n  try {\n    // returning false prevents the default action\n    returnValue = invokeFunction(listener.callback, args);\n\n    // stop propagation on return value\n    if (returnValue !== undefined) {\n      event.returnValue = returnValue;\n      event.stopPropagation();\n    }\n\n    // prevent default on return false\n    if (returnValue === false) {\n      event.preventDefault();\n    }\n  } catch (error) {\n    if (!this.handleError(error)) {\n      console.error('unhandled error in event listener', error);\n      throw error;\n    }\n  }\n  return returnValue;\n};\n\n/**\n * Add new listener with a certain priority to the list\n * of listeners (for the given event).\n *\n * The semantics of listener registration / listener execution are\n * first register, first serve: New listeners will always be inserted\n * after existing listeners with the same priority.\n *\n * Example: Inserting two listeners with priority 1000 and 1300\n *\n *    * before: [ 1500, 1500, 1000, 1000 ]\n *    * after: [ 1500, 1500, (new=1300), 1000, 1000, (new=1000) ]\n *\n * @param {string} event\n * @param {EventBusListener} newListener\n */\nEventBus.prototype._addListener = function (event, newListener) {\n  var listener = this._getListeners(event),\n    previousListener;\n\n  // no prior listeners\n  if (!listener) {\n    this._setListeners(event, newListener);\n    return;\n  }\n\n  // ensure we order listeners by priority from\n  // 0 (high) to n > 0 (low)\n  while (listener) {\n    if (listener.priority < newListener.priority) {\n      newListener.next = listener;\n      if (previousListener) {\n        previousListener.next = newListener;\n      } else {\n        this._setListeners(event, newListener);\n      }\n      return;\n    }\n    previousListener = listener;\n    listener = listener.next;\n  }\n\n  // add new listener to back\n  previousListener.next = newListener;\n};\n\n/**\n * @param {string} name\n *\n * @return {EventBusListener}\n */\nEventBus.prototype._getListeners = function (name) {\n  return this._listeners[name];\n};\n\n/**\n * @param {string} name\n * @param {EventBusListener} listener\n */\nEventBus.prototype._setListeners = function (name, listener) {\n  this._listeners[name] = listener;\n};\nEventBus.prototype._removeListener = function (event, callback) {\n  var listener = this._getListeners(event),\n    nextListener,\n    previousListener,\n    listenerCallback;\n  if (!callback) {\n    // clear listeners\n    this._setListeners(event, null);\n    return;\n  }\n  while (listener) {\n    nextListener = listener.next;\n    listenerCallback = listener.callback;\n    if (listenerCallback === callback || listenerCallback[FN_REF] === callback) {\n      if (previousListener) {\n        previousListener.next = nextListener;\n      } else {\n        // new first listener\n        this._setListeners(event, nextListener);\n      }\n    }\n    previousListener = listener;\n    listener = nextListener;\n  }\n};\n\n/**\n * A event that is emitted via the event bus.\n */\nfunction InternalEvent() {}\nInternalEvent.prototype.stopPropagation = function () {\n  this.cancelBubble = true;\n};\nInternalEvent.prototype.preventDefault = function () {\n  this.defaultPrevented = true;\n};\nInternalEvent.prototype.init = function (data) {\n  assign(this, data || {});\n};\n\n/**\n * Invoke function. Be fast...\n *\n * @param {Function} fn\n * @param {any[]} args\n *\n * @return {any}\n */\nfunction invokeFunction(fn, args) {\n  return fn.apply(null, args);\n}\nconst EMAIL_PATTERN = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;\nconst PHONE_PATTERN = /(\\+|00)(297|93|244|1264|358|355|376|971|54|374|1684|1268|61|43|994|257|32|229|226|880|359|973|1242|387|590|375|501|1441|591|55|1246|673|975|267|236|1|61|41|56|86|225|237|243|242|682|57|269|238|506|53|5999|61|1345|357|420|49|253|1767|45|1809|1829|1849|213|593|20|291|212|34|372|251|358|679|500|33|298|691|241|44|995|44|233|350|224|590|220|245|240|30|1473|299|502|594|1671|592|852|504|385|509|36|62|44|91|246|353|98|964|354|972|39|1876|44|962|81|76|77|254|996|855|686|1869|82|383|965|856|961|231|218|1758|423|94|266|370|352|371|853|590|212|377|373|261|960|52|692|389|223|356|95|382|976|1670|258|222|1664|596|230|265|60|262|264|687|227|672|234|505|683|31|47|977|674|64|968|92|507|64|51|63|680|675|48|1787|1939|850|351|595|970|689|974|262|40|7|250|966|249|221|65|500|4779|677|232|503|378|252|508|381|211|239|597|421|386|46|268|1721|248|963|1649|235|228|66|992|690|993|670|676|1868|216|90|688|886|255|256|380|598|1|998|3906698|379|1784|58|1284|1340|84|678|681|685|967|27|260|263)(9[976]\\d|8[987530]\\d|6[987]\\d|5[90]\\d|42\\d|3[875]\\d|2[98654321]\\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)\\d{4,20}$/;\nconst VALIDATE_FEEL_PROPERTIES = ['min', 'max', 'minLength', 'maxLength'];\nclass Validator {\n  constructor(expressionLanguage, conditionChecker, form) {\n    this._expressionLanguage = expressionLanguage;\n    this._conditionChecker = conditionChecker;\n    this._form = form;\n  }\n  validateField(field, value) {\n    const {\n      type,\n      validate\n    } = field;\n    let errors = [];\n    if (type === 'number') {\n      const {\n        decimalDigits,\n        increment\n      } = field;\n      if (value === 'NaN') {\n        errors = [...errors, 'Value is not a number.'];\n      } else if (value) {\n        if (decimalDigits >= 0 && countDecimals(value) > decimalDigits) {\n          errors = [...errors, 'Value is expected to ' + (decimalDigits === 0 ? 'be an integer' : `have at most ${decimalDigits} decimal digit${decimalDigits > 1 ? 's' : ''}`) + '.'];\n        }\n        if (increment) {\n          const bigValue = Big(value);\n          const bigIncrement = Big(increment);\n          const offset = bigValue.mod(bigIncrement);\n          if (offset.cmp(0) !== 0) {\n            const previousValue = bigValue.minus(offset);\n            const nextValue = previousValue.plus(bigIncrement);\n            errors = [...errors, `Please select a valid value, the two nearest valid values are ${previousValue} and ${nextValue}.`];\n          }\n        }\n      }\n    }\n    if (!validate) {\n      return errors;\n    }\n    const evaluatedValidation = evaluateFEELValues(validate, this._expressionLanguage, this._conditionChecker, this._form);\n    if (evaluatedValidation.pattern && value && !new RegExp(evaluatedValidation.pattern).test(value)) {\n      errors = [...errors, `Field must match pattern ${evaluatedValidation.pattern}.`];\n    }\n    if (evaluatedValidation.required) {\n      const isUncheckedCheckbox = type === 'checkbox' && value === false;\n      const isUnsetValue = isNil(value) || value === '';\n      const isEmptyMultiselect = Array.isArray(value) && value.length === 0;\n      if (isUncheckedCheckbox || isUnsetValue || isEmptyMultiselect) {\n        errors = [...errors, 'Field is required.'];\n      }\n    }\n    if ('min' in evaluatedValidation && (value || value === 0) && value < evaluatedValidation.min) {\n      errors = [...errors, `Field must have minimum value of ${evaluatedValidation.min}.`];\n    }\n    if ('max' in evaluatedValidation && (value || value === 0) && value > evaluatedValidation.max) {\n      errors = [...errors, `Field must have maximum value of ${evaluatedValidation.max}.`];\n    }\n    if ('minLength' in evaluatedValidation && value && value.trim().length < evaluatedValidation.minLength) {\n      errors = [...errors, `Field must have minimum length of ${evaluatedValidation.minLength}.`];\n    }\n    if ('maxLength' in evaluatedValidation && value && value.trim().length > evaluatedValidation.maxLength) {\n      errors = [...errors, `Field must have maximum length of ${evaluatedValidation.maxLength}.`];\n    }\n    if ('validationType' in evaluatedValidation && value && evaluatedValidation.validationType === 'phone' && !PHONE_PATTERN.test(value)) {\n      errors = [...errors, 'Field must be a valid  international phone number. (e.g. +4930664040900)'];\n    }\n    if ('validationType' in evaluatedValidation && value && evaluatedValidation.validationType === 'email' && !EMAIL_PATTERN.test(value)) {\n      errors = [...errors, 'Field must be a valid email.'];\n    }\n    return errors;\n  }\n}\nValidator.$inject = ['expressionLanguage', 'conditionChecker', 'form'];\n\n// helpers //////////\n\n/**\n * Helper function to evaluate optional FEEL validation values.\n */\nfunction evaluateFEELValues(validate, expressionLanguage, conditionChecker, form) {\n  const evaluatedValidate = {\n    ...validate\n  };\n  VALIDATE_FEEL_PROPERTIES.forEach(property => {\n    const path = property.split('.');\n    const value = get(evaluatedValidate, path);\n\n    // mirroring FEEL evaluation of our hooks\n    if (!expressionLanguage || !expressionLanguage.isExpression(value)) {\n      return value;\n    }\n    const {\n      initialData,\n      data\n    } = form._getState();\n    const newData = conditionChecker ? conditionChecker.applyConditions(data, data) : data;\n    const filteredData = {\n      ...initialData,\n      ...newData\n    };\n    const evaluatedValue = expressionLanguage.evaluate(value, filteredData);\n\n    // replace validate property with evaluated value\n    if (evaluatedValue) {\n      set(evaluatedValidate, path, evaluatedValue);\n    }\n  });\n  return evaluatedValidate;\n}\nclass Importer {\n  /**\n   * @constructor\n   * @param { import('./FormFieldRegistry').FormFieldRegistry } formFieldRegistry\n   * @param { import('./PathRegistry').PathRegistry } pathRegistry\n   * @param { import('./FieldFactory').FieldFactory } fieldFactory\n   * @param { import('./FormLayouter').FormLayouter } formLayouter\n   */\n  constructor(formFieldRegistry, pathRegistry, fieldFactory, formLayouter) {\n    this._formFieldRegistry = formFieldRegistry;\n    this._pathRegistry = pathRegistry;\n    this._fieldFactory = fieldFactory;\n    this._formLayouter = formLayouter;\n  }\n\n  /**\n   * Import schema creating rows, fields, attaching additional\n   * information to each field and adding fields to the\n   * field registry.\n   *\n   * Additional information attached:\n   *\n   *   * `id` (unless present)\n   *   * `_parent`\n   *   * `_path`\n   *\n   * @param {any} schema\n   *\n   * @typedef {{ warnings: Error[], schema: any }} ImportResult\n   * @returns {ImportResult}\n   */\n  importSchema(schema) {\n    // TODO: Add warnings\n    const warnings = [];\n    try {\n      this._cleanup();\n      const importedSchema = this.importFormField(clone(schema));\n      this._formLayouter.calculateLayout(clone(importedSchema));\n      return {\n        schema: importedSchema,\n        warnings\n      };\n    } catch (err) {\n      this._cleanup();\n      err.warnings = warnings;\n      throw err;\n    }\n  }\n  _cleanup() {\n    this._formLayouter.clear();\n    this._formFieldRegistry.clear();\n    this._pathRegistry.clear();\n  }\n\n  /**\n   * @param {{[x: string]: any}} fieldAttrs\n   * @param {String} [parentId]\n   * @param {number} [index]\n   *\n   * @return {any} field\n   */\n  importFormField(fieldAttrs, parentId, index) {\n    const {\n      components\n    } = fieldAttrs;\n    let parent, path;\n    if (parentId) {\n      parent = this._formFieldRegistry.get(parentId);\n    }\n\n    // set form field path\n    path = parent ? [...parent._path, 'components', index] : [];\n    const field = this._fieldFactory.create({\n      ...fieldAttrs,\n      _path: path,\n      _parent: parentId\n    }, false);\n    this._formFieldRegistry.add(field);\n    if (components) {\n      field.components = this.importFormFields(components, field.id);\n    }\n    return field;\n  }\n\n  /**\n   * @param {Array<any>} components\n   * @param {string} parentId\n   *\n   * @return {Array<any>} imported components\n   */\n  importFormFields(components, parentId) {\n    return components.map((component, index) => {\n      return this.importFormField(component, parentId, index);\n    });\n  }\n}\nImporter.$inject = ['formFieldRegistry', 'pathRegistry', 'fieldFactory', 'formLayouter'];\nclass FieldFactory {\n  /**\n   * @constructor\n   *\n   * @param  formFieldRegistry\n   * @param  formFields\n   */\n  constructor(formFieldRegistry, pathRegistry, formFields) {\n    this._formFieldRegistry = formFieldRegistry;\n    this._pathRegistry = pathRegistry;\n    this._formFields = formFields;\n  }\n  create(attrs, applyDefaults = true) {\n    const {\n      id,\n      type,\n      key,\n      path,\n      _parent\n    } = attrs;\n    const fieldDefinition = this._formFields.get(type);\n    if (!fieldDefinition) {\n      throw new Error(`form field of type <${type}> not supported`);\n    }\n    const {\n      config\n    } = fieldDefinition;\n    if (!config) {\n      throw new Error(`form field of type <${type}> has no config`);\n    }\n    if (id && this._formFieldRegistry._ids.assigned(id)) {\n      throw new Error(`form field with id <${id}> already exists`);\n    }\n\n    // ensure that we can claim the path\n\n    const parent = _parent && this._formFieldRegistry.get(_parent);\n    const parentPath = parent && this._pathRegistry.getValuePath(parent) || [];\n    const knownAncestorIds = getAncestryList(_parent, this._formFieldRegistry);\n    if (config.keyed && key && !this._pathRegistry.canClaimPath([...parentPath, ...key.split('.')], {\n      isClosed: true,\n      knownAncestorIds\n    })) {\n      throw new Error(`binding path '${[...parentPath, key].join('.')}' is already claimed`);\n    }\n    if (config.pathed && path && !this._pathRegistry.canClaimPath([...parentPath, ...path.split('.')], {\n      isRepeatable: config.repeatable,\n      knownAncestorIds\n    })) {\n      throw new Error(`binding path '${[...parentPath, ...path.split('.')].join('.')}' is already claimed`);\n    }\n    const labelAttrs = applyDefaults && config.label ? {\n      label: config.label\n    } : {};\n    const field = config.create({\n      ...labelAttrs,\n      ...attrs\n    });\n    this._ensureId(field);\n    if (config.keyed) {\n      this._ensureKey(field);\n      this._pathRegistry.claimPath(this._pathRegistry.getValuePath(field), {\n        isClosed: true,\n        claimerId: field.id,\n        knownAncestorIds: getAncestryList(_parent, this._formFieldRegistry)\n      });\n    }\n    if (config.pathed) {\n      if (config.repeatable) {\n        this._enforceDefaultPath(field);\n      }\n      if (field.path) {\n        this._pathRegistry.claimPath(this._pathRegistry.getValuePath(field), {\n          isRepeatable: config.repeatable,\n          claimerId: field.id,\n          knownAncestorIds: getAncestryList(_parent, this._formFieldRegistry)\n        });\n      }\n    }\n    return field;\n  }\n  _ensureId(field) {\n    if (field.id) {\n      this._formFieldRegistry._ids.claim(field.id, field);\n      return;\n    }\n    let prefix = 'Field';\n    if (field.type === 'default') {\n      prefix = 'Form';\n    }\n    field.id = this._formFieldRegistry._ids.nextPrefixed(`${prefix}_`, field);\n  }\n  _ensureKey(field) {\n    if (!field.key) {\n      field.key = this._getUniqueKeyPath(field);\n    }\n  }\n  _enforceDefaultPath(field) {\n    if (!field.path) {\n      field.path = this._getUniqueKeyPath(field);\n    }\n  }\n  _getUniqueKeyPath(field) {\n    let random;\n    const parent = this._formFieldRegistry.get(field._parent);\n\n    // ensure key uniqueness at level\n    do {\n      random = Math.random().toString(36).substring(7);\n    } while (parent && parent.components.some(child => child.key === random));\n    return `${field.type}_${random}`;\n  }\n}\nFieldFactory.$inject = ['formFieldRegistry', 'pathRegistry', 'formFields'];\n\n/**\n * The PathRegistry class manages a hierarchical structure of paths associated with form fields.\n * It enables claiming, unclaiming, and validating paths within this structure.\n *\n * Example Tree Structure:\n *\n *   [\n *     {\n *       segment: 'root',\n *       claimCount: 1,\n *       children: [\n *         {\n *           segment: 'child1',\n *           claimCount: 2,\n *           children: null  // A leaf node (closed path)\n *         },\n *         {\n *           segment: 'child2',\n *           claimCount: 1,\n *           children: [\n *             {\n *               segment: 'subChild1',\n *               claimCount: 1,\n *               children: []  // An open node (open path)\n *             }\n *           ]\n *         }\n *       ]\n *     }\n *   ]\n */\nclass PathRegistry {\n  constructor(formFieldRegistry, formFields, injector) {\n    this._formFieldRegistry = formFieldRegistry;\n    this._formFields = formFields;\n    this._injector = injector;\n    this._dataPaths = [];\n  }\n  canClaimPath(path, options = {}) {\n    const {\n      isClosed = false,\n      isRepeatable = false,\n      skipAncestryCheck = false,\n      claimerId = null,\n      knownAncestorIds = []\n    } = options;\n    let node = {\n      children: this._dataPaths\n    };\n\n    // (1) if we reach a leaf node, we cannot claim it, if we reach an open node, we can\n    // if we reach a repeatable node, we need to ensure that the claimer is (or will be) an ancestor of the repeater\n    for (const segment of path) {\n      node = _getNextSegment(node, segment);\n      if (!node) {\n        return true;\n      }\n      if (node.isRepeatable && !skipAncestryCheck) {\n        if (!(claimerId || knownAncestorIds.length)) {\n          throw new Error('cannot claim a path that contains a repeater without specifying a claimerId or knownAncestorIds');\n        }\n        const isValidRepeatClaim = knownAncestorIds.includes(node.repeaterId) || claimerId && getAncestryList(claimerId, this._formFieldRegistry).includes(node.repeaterId);\n        if (!isValidRepeatClaim) {\n          return false;\n        }\n      }\n      if (node.children === null) {\n        return false;\n      }\n    }\n\n    // (2) if the path lands in the middle of the tree, we can only claim an open, non-repeatable path\n    return !(isClosed || isRepeatable);\n  }\n  claimPath(path, options = {}) {\n    const {\n      isClosed = false,\n      isRepeatable = false,\n      claimerId = null,\n      knownAncestorIds = []\n    } = options;\n    if (!this.canClaimPath(path, {\n      isClosed,\n      isRepeatable,\n      claimerId,\n      knownAncestorIds\n    })) {\n      throw new Error(`cannot claim path '${path.join('.')}'`);\n    }\n    let node = {\n      children: this._dataPaths\n    };\n    for (const segment of path) {\n      let child = _getNextSegment(node, segment);\n      if (!child) {\n        child = {\n          segment,\n          claimCount: 1,\n          children: []\n        };\n        node.children.push(child);\n      } else {\n        child.claimCount++;\n      }\n      node = child;\n    }\n    if (isClosed) {\n      node.children = null;\n    }\n\n    // add some additional info when we make a repeatable path claim\n    if (isRepeatable) {\n      node.isRepeatable = true;\n      node.repeaterId = claimerId;\n    }\n  }\n  unclaimPath(path) {\n    // verification Pass\n    let node = {\n      children: this._dataPaths\n    };\n    for (const segment of path) {\n      const child = _getNextSegment(node, segment);\n      if (!child) {\n        throw new Error(`no open path found for '${path.join('.')}'`);\n      }\n      node = child;\n    }\n\n    // mutation Pass\n    node = {\n      children: this._dataPaths\n    };\n    for (const segment of path) {\n      const child = _getNextSegment(node, segment);\n      child.claimCount--;\n      if (child.claimCount === 0) {\n        node.children.splice(node.children.indexOf(child), 1);\n        break; // Abort early if claimCount reaches zero\n      }\n      node = child;\n    }\n  }\n\n  /**\n   * Applies a function (fn) recursively on a given field and its children.\n   *\n   * - `field`: Starting field object.\n   * - `fn`: Function to apply.\n   * - `context`: Optional object for passing data between calls.\n   *\n   * Stops early if `fn` returns `false`. Useful for traversing the form field tree.\n   *\n   * @returns {boolean} Success status based on function execution.\n   */\n  executeRecursivelyOnFields(field, fn, context = {}) {\n    let result = true;\n    const formFieldConfig = this._formFields.get(field.type).config;\n    if (formFieldConfig.keyed) {\n      const callResult = fn({\n        field,\n        isClosed: true,\n        isRepeatable: false,\n        context\n      });\n      return result && callResult;\n    } else if (formFieldConfig.pathed) {\n      const callResult = fn({\n        field,\n        isClosed: false,\n        isRepeatable: formFieldConfig.repeatable,\n        context\n      });\n      result = result && callResult;\n    }\n\n    // stop executing if false is specifically returned or if preventing recursion\n    if (result === false || context.preventRecursion) {\n      return result;\n    }\n    if (Array.isArray(field.components)) {\n      for (const child of field.components) {\n        const callResult = this.executeRecursivelyOnFields(child, fn, clone(context));\n        result = result && callResult;\n\n        // stop executing if false is specifically returned\n        if (result === false) {\n          return result;\n        }\n      }\n    }\n    return result;\n  }\n\n  /**\n   * Generates an array representing the binding path to an underlying data object for a form field.\n   *\n   * @param {Object} field - The field object with properties: `key`, `path`, `id`, and optionally `_parent`.\n   * @param {Object} [options={}] - Configuration options.\n   * @param {Object} [options.replacements={}] - A map of field IDs to alternative path arrays.\n   * @param {Object} [options.indexes=null] - A map of parent IDs to the index of the field within said parent, leave null to get an unindexed path.\n   * @param {Object} [options.cutoffNode] - The ID of the parent field at which to stop generating the path.\n   *\n   * @returns {(Array<string>|undefined)} An array of strings representing the binding path, or undefined if not determinable.\n   */\n  getValuePath(field, options = {}) {\n    const {\n      replacements = {},\n      indexes = null,\n      cutoffNode = null\n    } = options;\n    let localValuePath = [];\n    const hasReplacement = Object.prototype.hasOwnProperty.call(replacements, field.id);\n    const formFieldConfig = this._formFields.get(field.type).config;\n\n    // uses path overrides instead of true path to calculate a potential value path\n    if (hasReplacement) {\n      const replacement = replacements[field.id];\n      if (replacement === null || replacement === undefined || replacement === '') {\n        localValuePath = [];\n      } else if (typeof replacement === 'string') {\n        localValuePath = replacement.split('.');\n      } else if (Array.isArray(replacement)) {\n        localValuePath = replacement;\n      } else {\n        throw new Error(`replacements for field ${field.id} must be a string, array or null/undefined`);\n      }\n    } else if (formFieldConfig.keyed) {\n      localValuePath = field.key.split('.');\n    } else if (formFieldConfig.pathed && field.path) {\n      localValuePath = field.path.split('.');\n    }\n\n    // add potential indexes of repeated fields\n    if (indexes) {\n      localValuePath = this._addIndexes(localValuePath, field, indexes);\n    }\n\n    // if parent exists and isn't cutoff node, add parent's value path\n    if (field._parent && field._parent !== cutoffNode) {\n      const parent = this._formFieldRegistry.get(field._parent);\n      return [...(this.getValuePath(parent, options) || []), ...localValuePath];\n    }\n    return localValuePath;\n  }\n  clear() {\n    this._dataPaths = [];\n  }\n  _addIndexes(localValuePath, field, indexes) {\n    const repeatRenderManager = this._injector.get('repeatRenderManager', false);\n    if (repeatRenderManager && repeatRenderManager.isFieldRepeating(field._parent)) {\n      return [indexes[field._parent], ...localValuePath];\n    }\n    return localValuePath;\n  }\n}\nconst _getNextSegment = (node, segment) => {\n  if (isArray(node.children)) {\n    return node.children.find(node => node.segment === segment) || null;\n  }\n  return null;\n};\nPathRegistry.$inject = ['formFieldRegistry', 'formFields', 'injector'];\n\n/**\n * @typedef { { id: String, components: Array<String> } } FormRow\n * @typedef { { formFieldId: String, rows: Array<FormRow> } } FormRows\n */\n\n/**\n * Maintains the Form layout in a given structure, for example\n *\n *  [\n *    {\n *      formFieldId: 'FormField_1',\n *      rows: [\n *        { id: 'Row_1', components: [ 'Text_1', 'Textdield_1', ... ]  }\n *      ]\n *    }\n *  ]\n *\n */\nclass FormLayouter {\n  constructor(eventBus) {\n    /** @type Array<FormRows>  */\n    this._rows = [];\n    this._ids = new Ids([32, 36, 1]);\n    this._eventBus = eventBus;\n  }\n\n  /**\n   * @param {FormRow} row\n   */\n  addRow(formFieldId, row) {\n    let rowsPerComponent = this._rows.find(r => r.formFieldId === formFieldId);\n    if (!rowsPerComponent) {\n      rowsPerComponent = {\n        formFieldId,\n        rows: []\n      };\n      this._rows.push(rowsPerComponent);\n    }\n    rowsPerComponent.rows.push(row);\n  }\n\n  /**\n   * @param {String} id\n   * @returns {FormRow}\n   */\n  getRow(id) {\n    const rows = allRows(this._rows);\n    return rows.find(r => r.id === id);\n  }\n\n  /**\n   * @param {any} formField\n   * @returns {FormRow}\n   */\n  getRowForField(formField) {\n    return allRows(this._rows).find(r => {\n      const {\n        components\n      } = r;\n      return components.includes(formField.id);\n    });\n  }\n\n  /**\n   * @param {String} formFieldId\n   * @returns { Array<FormRow> }\n   */\n  getRows(formFieldId) {\n    const rowsForField = this._rows.find(r => formFieldId === r.formFieldId);\n    if (!rowsForField) {\n      return [];\n    }\n    return rowsForField.rows;\n  }\n\n  /**\n   * @returns {string}\n   */\n  nextRowId() {\n    return this._ids.nextPrefixed('Row_');\n  }\n\n  /**\n   * @param {any} formField\n   */\n  calculateLayout(formField) {\n    const {\n      type,\n      components\n    } = formField;\n    if (!['default', 'group', 'dynamiclist'].includes(type) || !components) {\n      return;\n    }\n\n    // (1) calculate rows order (by component order)\n    const rowsInOrder = groupByRow(components, this._ids);\n    Object.entries(rowsInOrder).forEach(([id, components]) => {\n      // (2) add fields to rows\n      this.addRow(formField.id, {\n        id: id,\n        components: components.map(c => c.id)\n      });\n    });\n\n    // (3) traverse through nested components\n    components.forEach(field => this.calculateLayout(field));\n\n    // (4) fire event to notify interested parties\n    this._eventBus.fire('form.layoutCalculated', {\n      rows: this._rows\n    });\n  }\n  clear() {\n    this._rows = [];\n    this._ids.clear();\n\n    // fire event to notify interested parties\n    this._eventBus.fire('form.layoutCleared');\n  }\n}\nFormLayouter.$inject = ['eventBus'];\n\n// helpers //////\n\nfunction groupByRow(components, ids) {\n  return groupBy(components, c => {\n    // mitigate missing row by creating new (handle legacy)\n    const {\n      layout\n    } = c;\n    if (!layout || !layout.row) {\n      return ids.nextPrefixed('Row_');\n    }\n    return layout.row;\n  });\n}\n\n/**\n * @param {Array<FormRows>} formRows\n * @returns {Array<FormRow>}\n */\nfunction allRows(formRows) {\n  return formRows.map(r => r.rows).flat();\n}\nclass FormFieldRegistry {\n  constructor(eventBus) {\n    this._eventBus = eventBus;\n    this._formFields = {};\n    eventBus.on('form.clear', () => this.clear());\n    this._ids = new Ids([32, 36, 1]);\n  }\n  add(formField) {\n    const {\n      id\n    } = formField;\n    if (this._formFields[id]) {\n      throw new Error(`form field with ID ${id} already exists`);\n    }\n    this._eventBus.fire('formField.add', {\n      formField\n    });\n    this._formFields[id] = formField;\n  }\n  remove(formField) {\n    const {\n      id\n    } = formField;\n    if (!this._formFields[id]) {\n      return;\n    }\n    this._eventBus.fire('formField.remove', {\n      formField\n    });\n    delete this._formFields[id];\n  }\n  get(id) {\n    return this._formFields[id];\n  }\n  getAll() {\n    return Object.values(this._formFields);\n  }\n  getForm() {\n    return this.getAll().find(formField => formField.type === 'default');\n  }\n  forEach(callback) {\n    this.getAll().forEach(formField => callback(formField));\n  }\n  clear() {\n    this._formFields = {};\n    this._ids.clear();\n  }\n}\nFormFieldRegistry.$inject = ['eventBus'];\nfunction Renderer(config, eventBus, form, injector) {\n  const App = () => {\n    const [state, setState] = useState(form._getState());\n    const formContext = {\n      getService(type, strict = true) {\n        return injector.get(type, strict);\n      },\n      formId: form._id\n    };\n    eventBus.on('changed', newState => {\n      setState(newState);\n    });\n    const onChange = useCallback(update => form._update(update), []);\n    const {\n      properties\n    } = state;\n    const {\n      readOnly\n    } = properties;\n    const onSubmit = useCallback(() => {\n      if (!readOnly) {\n        form.submit();\n      }\n    }, [readOnly]);\n    const onReset = useCallback(() => form.reset(), []);\n    const {\n      schema\n    } = state;\n    if (!schema) {\n      return null;\n    }\n    return jsx(FormContext.Provider, {\n      value: formContext,\n      children: jsx(FormComponent, {\n        onChange: onChange,\n        onSubmit: onSubmit,\n        onReset: onReset\n      })\n    });\n  };\n  const {\n    container\n  } = config;\n  eventBus.on('form.init', () => {\n    render(jsx(App, {}), container);\n  });\n  eventBus.on('form.destroy', () => {\n    render(null, container);\n  });\n}\nRenderer.$inject = ['config.renderer', 'eventBus', 'form', 'injector'];\nconst RenderModule = {\n  __init__: ['formFields', 'renderer'],\n  formFields: ['type', FormFields],\n  renderer: ['type', Renderer]\n};\nconst CoreModule = {\n  __depends__: [RenderModule],\n  eventBus: ['type', EventBus],\n  importer: ['type', Importer],\n  fieldFactory: ['type', FieldFactory],\n  formFieldRegistry: ['type', FormFieldRegistry],\n  pathRegistry: ['type', PathRegistry],\n  formLayouter: ['type', FormLayouter],\n  validator: ['type', Validator]\n};\n\n/**\n * @typedef { import('./types').Injector } Injector\n * @typedef { import('./types').Data } Data\n * @typedef { import('./types').Errors } Errors\n * @typedef { import('./types').Schema } Schema\n * @typedef { import('./types').FormProperties } FormProperties\n * @typedef { import('./types').FormProperty } FormProperty\n * @typedef { import('./types').FormEvent } FormEvent\n * @typedef { import('./types').FormOptions } FormOptions\n *\n * @typedef { {\n *   data: Data,\n *   initialData: Data,\n *   errors: Errors,\n *   properties: FormProperties,\n *   schema: Schema\n * } } State\n *\n * @typedef { (type:FormEvent, priority:number, handler:Function) => void } OnEventWithPriority\n * @typedef { (type:FormEvent, handler:Function) => void } OnEventWithOutPriority\n * @typedef { OnEventWithPriority & OnEventWithOutPriority } OnEventType\n */\n\nconst ids = new Ids([32, 36, 1]);\n\n/**\n * The form.\n */\nclass Form {\n  /**\n   * @constructor\n   * @param {FormOptions} options\n   */\n  constructor(options = {}) {\n    /**\n     * @public\n     * @type {OnEventType}\n     */\n    this.on = this._onEvent;\n\n    /**\n     * @public\n     * @type {String}\n     */\n    this._id = ids.next();\n\n    /**\n     * @private\n     * @type {Element}\n     */\n    this._container = createFormContainer();\n    const {\n      container,\n      injector = this._createInjector(options, this._container),\n      properties = {}\n    } = options;\n\n    /**\n     * @private\n     * @type {State}\n     */\n    this._state = {\n      initialData: null,\n      data: null,\n      properties,\n      errors: {},\n      schema: null\n    };\n    this.get = injector.get;\n    this.invoke = injector.invoke;\n    this.get('eventBus').fire('form.init');\n    if (container) {\n      this.attachTo(container);\n    }\n  }\n  clear() {\n    // clear diagram services (e.g. EventBus)\n    this._emit('diagram.clear');\n\n    // clear form services\n    this._emit('form.clear');\n  }\n\n  /**\n   * Destroy the form, removing it from DOM,\n   * if attached.\n   */\n  destroy() {\n    // destroy form services\n    this.get('eventBus').fire('form.destroy');\n\n    // destroy diagram services (e.g. EventBus)\n    this.get('eventBus').fire('diagram.destroy');\n    this._detach(false);\n  }\n\n  /**\n   * Open a form schema with the given initial data.\n   *\n   * @param {Schema} schema\n   * @param {Data} [data]\n   *\n   * @return Promise<{ warnings: Array<any> }>\n   */\n  importSchema(schema, data = {}) {\n    return new Promise((resolve, reject) => {\n      try {\n        this.clear();\n        const {\n          schema: importedSchema,\n          warnings\n        } = this.get('importer').importSchema(schema);\n        const initializedData = this._getInitializedFieldData(clone(data));\n        this._setState({\n          data: initializedData,\n          errors: {},\n          schema: importedSchema,\n          initialData: clone(initializedData)\n        });\n        this._emit('import.done', {\n          warnings\n        });\n        return resolve({\n          warnings\n        });\n      } catch (error) {\n        this._emit('import.done', {\n          error,\n          warnings: error.warnings || []\n        });\n        return reject(error);\n      }\n    });\n  }\n\n  /**\n   * Submit the form, triggering all field validations.\n   *\n   * @returns { { data: Data, errors: Errors } }\n   */\n  submit() {\n    const {\n      properties\n    } = this._getState();\n    if (properties.readOnly || properties.disabled) {\n      throw new Error('form is read-only');\n    }\n    const data = this._getSubmitData();\n    const errors = this.validate();\n    const result = {\n      data,\n      errors\n    };\n    this._emit('submit', result);\n    return result;\n  }\n  reset() {\n    this._emit('reset');\n    this._setState({\n      data: clone(this._state.initialData),\n      errors: {}\n    });\n  }\n\n  /**\n   * @returns {Errors}\n   */\n  validate() {\n    const formFields = this.get('formFields'),\n      formFieldRegistry = this.get('formFieldRegistry'),\n      pathRegistry = this.get('pathRegistry'),\n      validator = this.get('validator');\n    const {\n      data\n    } = this._getState();\n    const getErrorPath = (field, indexes) => [field.id, ...Object.values(indexes || {})];\n    function validateFieldRecursively(errors, field, indexes) {\n      const {\n        disabled,\n        type,\n        isRepeating\n      } = field;\n      const {\n        config: fieldConfig\n      } = formFields.get(type);\n\n      // (1) Skip disabled fields\n      if (disabled) {\n        return;\n      }\n\n      // (2) Validate the field\n      const valuePath = pathRegistry.getValuePath(field, {\n        indexes\n      });\n      const valueData = get(data, valuePath);\n      const fieldErrors = validator.validateField(field, valueData);\n      if (fieldErrors.length) {\n        set(errors, getErrorPath(field, indexes), fieldErrors);\n      }\n\n      // (3) Process parents\n      if (!Array.isArray(field.components)) {\n        return;\n      }\n\n      // (4a) Recurse repeatable parents both across the indexes of repetition and the children\n      if (fieldConfig.repeatable && isRepeating) {\n        if (!Array.isArray(valueData)) {\n          return;\n        }\n        valueData.forEach((_, index) => {\n          field.components.forEach(component => {\n            validateFieldRecursively(errors, component, {\n              ...indexes,\n              [field.id]: index\n            });\n          });\n        });\n        return;\n      }\n\n      // (4b) Recurse non-repeatable parents only across the children\n      field.components.forEach(component => validateFieldRecursively(errors, component, indexes));\n    }\n    const workingErrors = {};\n    validateFieldRecursively(workingErrors, formFieldRegistry.getForm());\n    const filteredErrors = this._applyConditions(workingErrors, data, {\n      getFilterPath: getErrorPath,\n      leafNodeDeletionOnly: true\n    });\n    this._setState({\n      errors: filteredErrors\n    });\n    return filteredErrors;\n  }\n\n  /**\n   * @param {Element|string} parentNode\n   */\n  attachTo(parentNode) {\n    if (!parentNode) {\n      throw new Error('parentNode required');\n    }\n    this.detach();\n    if (isString(parentNode)) {\n      parentNode = document.querySelector(parentNode);\n    }\n    const container = this._container;\n    parentNode.appendChild(container);\n    this._emit('attach');\n  }\n  detach() {\n    this._detach();\n  }\n\n  /**\n   * @private\n   *\n   * @param {boolean} [emit]\n   */\n  _detach(emit = true) {\n    const container = this._container,\n      parentNode = container.parentNode;\n    if (!parentNode) {\n      return;\n    }\n    if (emit) {\n      this._emit('detach');\n    }\n    parentNode.removeChild(container);\n  }\n\n  /**\n   * @param {FormProperty} property\n   * @param {any} value\n   */\n  setProperty(property, value) {\n    const properties = set(this._getState().properties, [property], value);\n    this._setState({\n      properties\n    });\n  }\n\n  /**\n   * @param {FormEvent} type\n   * @param {Function} handler\n   */\n  off(type, handler) {\n    this.get('eventBus').off(type, handler);\n  }\n\n  /**\n   * @private\n   *\n   * @param {FormOptions} options\n   * @param {Element} container\n   *\n   * @returns {Injector}\n   */\n  _createInjector(options, container) {\n    const {\n      modules = this._getModules(),\n      additionalModules = [],\n      ...config\n    } = options;\n    const enrichedConfig = {\n      ...config,\n      renderer: {\n        container\n      }\n    };\n    return createInjector([{\n      config: ['value', enrichedConfig]\n    }, {\n      form: ['value', this]\n    }, CoreModule, ...modules, ...additionalModules]);\n  }\n\n  /**\n   * @private\n   */\n  _emit(type, data) {\n    this.get('eventBus').fire(type, data);\n  }\n\n  /**\n   * @internal\n   *\n   * @param { { add?: boolean, field: any, indexes: object, remove?: number, value?: any } } update\n   */\n  _update(update) {\n    const {\n      field,\n      indexes,\n      value\n    } = update;\n    const {\n      data,\n      errors\n    } = this._getState();\n    const validator = this.get('validator'),\n      pathRegistry = this.get('pathRegistry');\n    const fieldErrors = validator.validateField(field, value);\n    const valuePath = pathRegistry.getValuePath(field, {\n      indexes\n    });\n    set(data, valuePath, value);\n    set(errors, [field.id, ...Object.values(indexes || {})], fieldErrors.length ? fieldErrors : undefined);\n    this._setState({\n      data: clone(data),\n      errors: clone(errors)\n    });\n  }\n\n  /**\n   * @internal\n   */\n  _getState() {\n    return this._state;\n  }\n\n  /**\n   * @internal\n   */\n  _setState(state) {\n    this._state = {\n      ...this._state,\n      ...state\n    };\n    this._emit('changed', this._getState());\n  }\n\n  /**\n  * @internal\n  */\n  _getModules() {\n    return [ExpressionLanguageModule, MarkdownRendererModule, ViewerCommandsModule, RepeatRenderModule];\n  }\n\n  /**\n   * @internal\n   */\n  _onEvent(type, priority, handler) {\n    this.get('eventBus').on(type, priority, handler);\n  }\n\n  /**\n   * @internal\n   */\n  _getSubmitData() {\n    const formFieldRegistry = this.get('formFieldRegistry');\n    const formFields = this.get('formFields');\n    const pathRegistry = this.get('pathRegistry');\n    const formData = this._getState().data;\n    function collectSubmitDataRecursively(submitData, formField, indexes) {\n      const {\n        disabled,\n        type\n      } = formField;\n      const {\n        config: fieldConfig\n      } = formFields.get(type);\n\n      // (1) Process keyed fields\n      if (!disabled && fieldConfig.keyed) {\n        const valuePath = pathRegistry.getValuePath(formField, {\n          indexes\n        });\n        const value = get(formData, valuePath);\n        set(submitData, valuePath, value);\n      }\n\n      // (2) Process parents\n      if (!Array.isArray(formField.components)) {\n        return;\n      }\n\n      // (3a) Recurse repeatable parents both across the indexes of repetition and the children\n      if (fieldConfig.repeatable && formField.isRepeating) {\n        const valueData = get(formData, pathRegistry.getValuePath(formField, {\n          indexes\n        }));\n        if (!Array.isArray(valueData)) {\n          return;\n        }\n        valueData.forEach((_, index) => {\n          formField.components.forEach(component => {\n            collectSubmitDataRecursively(submitData, component, {\n              ...indexes,\n              [formField.id]: index\n            });\n          });\n        });\n        return;\n      }\n\n      // (3b) Recurse non-repeatable parents only across the children\n      formField.components.forEach(component => collectSubmitDataRecursively(submitData, component, indexes));\n    }\n    const workingSubmitData = {};\n    collectSubmitDataRecursively(workingSubmitData, formFieldRegistry.getForm(), {});\n    return this._applyConditions(workingSubmitData, formData);\n  }\n\n  /**\n   * @internal\n   */\n  _applyConditions(toFilter, data, options = {}) {\n    const conditionChecker = this.get('conditionChecker');\n    return conditionChecker.applyConditions(toFilter, data, options);\n  }\n\n  /**\n   * @internal\n   */\n  _getInitializedFieldData(data, options = {}) {\n    const formFieldRegistry = this.get('formFieldRegistry');\n    const formFields = this.get('formFields');\n    const pathRegistry = this.get('pathRegistry');\n    function initializeFieldDataRecursively(initializedData, formField, indexes) {\n      const {\n        defaultValue,\n        type,\n        isRepeating\n      } = formField;\n      const {\n        config: fieldConfig\n      } = formFields.get(type);\n      const valuePath = pathRegistry.getValuePath(formField, {\n        indexes\n      });\n      let valueData = get(data, valuePath);\n\n      // (1) Process keyed fields\n      if (fieldConfig.keyed) {\n        // (a) Retrieve and sanitize data from input\n        if (!isUndefined(valueData) && fieldConfig.sanitizeValue) {\n          valueData = fieldConfig.sanitizeValue({\n            formField,\n            data,\n            value: valueData\n          });\n        }\n\n        // (b) Initialize field value in output data\n        const initializedFieldValue = !isUndefined(valueData) ? valueData : !isUndefined(defaultValue) ? defaultValue : fieldConfig.emptyValue;\n        set(initializedData, valuePath, initializedFieldValue);\n      }\n\n      // (2) Process parents\n      if (!Array.isArray(formField.components)) {\n        return;\n      }\n      if (fieldConfig.repeatable && isRepeating) {\n        // (a) Sanitize repeatable parents data if it is not an array\n        if (!valueData || !Array.isArray(valueData)) {\n          valueData = new Array(isUndefined(formField.defaultRepetitions) ? 1 : formField.defaultRepetitions).fill().map(_ => ({})) || [];\n        }\n\n        // (b) Ensure all elements of the array are objects\n        valueData = valueData.map(val => isObject(val) ? val : {});\n\n        // (c) Initialize field value in output data\n        set(initializedData, valuePath, valueData);\n\n        // (d) If indexed ahead of time, recurse repeatable simply across the children\n        if (!isUndefined(indexes[formField.id])) {\n          formField.components.forEach(component => initializeFieldDataRecursively(initializedData, component, {\n            ...indexes\n          }));\n          return;\n        }\n\n        // (e1) Recurse repeatable parents both across the indexes of repetition and the children\n        valueData.forEach((_, index) => {\n          formField.components.forEach(component => initializeFieldDataRecursively(initializedData, component, {\n            ...indexes,\n            [formField.id]: index\n          }));\n        });\n        return;\n      }\n\n      // (e2) Recurse non-repeatable parents only across the children\n      formField.components.forEach(component => initializeFieldDataRecursively(initializedData, component, indexes));\n    }\n\n    // allows definition of a specific subfield to generate the data for\n    const container = options.container || formFieldRegistry.getForm();\n    const indexes = options.indexes || {};\n    const basePath = pathRegistry.getValuePath(container, {\n      indexes\n    }) || [];\n\n    // if indexing ahead of time, we must add this index to the data path at the end\n    const path = !isUndefined(indexes[container.id]) ? [...basePath, indexes[container.id]] : basePath;\n    const workingData = clone(data);\n    initializeFieldDataRecursively(workingData, container, indexes);\n    return get(workingData, path, {});\n  }\n}\nconst schemaVersion = 15;\n\n/**\r\n * @typedef { import('./types').CreateFormOptions } CreateFormOptions\r\n */\n\n/**\r\n * Create a form.\r\n *\r\n * @param {CreateFormOptions} options\r\n *\r\n * @return {Promise<Form>}\r\n */\nfunction createForm(options) {\n  const {\n    data,\n    schema,\n    ...formOptions\n  } = options;\n  const form = new Form(formOptions);\n  return form.importSchema(schema, data).then(function () {\n    return form;\n  });\n}\nexport { ALLOW_ATTRIBUTE, Button, Checkbox, Checklist, ConditionChecker, DATETIME_SUBTYPES, DATETIME_SUBTYPES_LABELS, DATETIME_SUBTYPE_PATH, DATE_DISALLOW_PAST_PATH, DATE_LABEL_PATH, Datetime, Default, Description, DynamicList, Errors, ExpressionLanguageModule, FeelExpressionLanguage, FeelersTemplating, FieldFactory, Form, FormComponent, FormContext, FormField, FormFieldRegistry, FormFields, FormLayouter, FormRenderContext, Group, Html, IFrame, Image, Importer, Label, LocalExpressionContext, MINUTES_IN_DAY, MarkdownRenderer, MarkdownRendererModule, Numberfield, OPTIONS_SOURCES, OPTIONS_SOURCES_DEFAULTS, OPTIONS_SOURCES_LABELS, OPTIONS_SOURCES_PATHS, OPTIONS_SOURCE_DEFAULT, PathRegistry, Radio, RenderModule, RepeatRenderManager, RepeatRenderModule, SANDBOX_ATTRIBUTE, SECURITY_ATTRIBUTES_DEFINITIONS, Select, Separator, Spacer, TIME_INTERVAL_PATH, TIME_LABEL_PATH, TIME_SERIALISINGFORMAT_LABELS, TIME_SERIALISING_FORMATS, TIME_SERIALISING_FORMAT_PATH, TIME_USE24H_PATH, Table, Taglist, Text, Textarea, Textfield, ViewerCommands, ViewerCommandsModule, buildExpressionContext, clone, createForm, createFormContainer, createInjector, escapeHTML, formFields, generateIdForType, generateIndexForType, getAncestryList, getOptionsSource, getSchemaVariables, hasEqualValue, iconsByType, isRequired, pathParse, pathsEqual, runRecursively, sanitizeDateTimePickerValue, sanitizeHTML, sanitizeIFrameSource, sanitizeImageSource, sanitizeMultiSelectValue, sanitizeSingleSelectValue, schemaVersion, useExpressionEvaluation, useSingleLineTemplateEvaluation, useTemplateEvaluation };","map":{"version":3,"names":["getFlavouredFeelVariableNames","feelString","feelFlavour","options","depth","specialDepthAccessors","includes","tree","parseExpression","parseUnaryTests","simpleExpressionTree","_buildSimpleFeelStructureTree","variables","_unfoldVariables","node","name","pathRoot","_linearizePathExpression","Object","keys","length","_getVariableNameAtPathIndex","Array","from","_smartExtractVariableNames","variableName","children","reduce","acc","child","concat","filter","Set","root","index","nodes","initialDepth","accessorDepthInfos","previous","current","extractedVariables","pathNodes","i","currentAccessor","depthOffsets","accumulator","offset","map","depthInfo","some","add","parts","push","reverse","parseTree","stack","iterate","enter","nodeRepresentation","type","slice","to","leave","result","pop","parent","_extractFilterExpressions","flattenedExpressionTree","x","filterTarget","filterExpression","taggedFilterExpression","FeelExpressionLanguage","constructor","eventBus","_eventBus","isExpression","value","isString","startsWith","getVariableNames","expression","Error","evaluate","data","error","fire","$inject","FeelersTemplating","isTemplate","test","template","expressions","_extractExpressionsWithDepth","_parent_","this","_this_","context","debug","strict","buildDebugString","err","sanitizer","evaluate$1","parser","parse","buildSimpleTree","_traverse","n","content","loopExpression","childResults","MINUTES_IN_DAY","DATETIME_SUBTYPES","DATE","TIME","DATETIME","TIME_SERIALISING_FORMATS","UTC_OFFSET","UTC_NORMALIZED","NO_TIMEZONE","DATETIME_SUBTYPES_LABELS","TIME_SERIALISINGFORMAT_LABELS","DATETIME_SUBTYPE_PATH","DATE_LABEL_PATH","DATE_DISALLOW_PAST_PATH","TIME_LABEL_PATH","TIME_USE24H_PATH","TIME_INTERVAL_PATH","TIME_SERIALISING_FORMAT_PATH","OPTIONS_SOURCES","STATIC","INPUT","EXPRESSION","OPTIONS_SOURCE_DEFAULT","OPTIONS_SOURCES_LABELS","OPTIONS_SOURCES_PATHS","OPTIONS_SOURCES_DEFAULTS","label","getOptionsSource","field","source","values","get","undefined","SANDBOX_ATTRIBUTE","ALLOW_ATTRIBUTE","SECURITY_ATTRIBUTES_DEFINITIONS","attribute","directive","property","createInjector","bootstrapModules","injector","Injector","init","createFormContainer","prefix","container","document","createElement","classList","formFieldClasses","errors","disabled","readonly","classNames","gridColumnClasses","formField","layout","columns","prefixId","id","formId","indexes","forEach","type$g","Button","props","onFocus","onBlur","action","jsx","class","config","keyed","group","create","FormRenderContext","createContext","Empty","Hidden","Children","style","Element","Row","Column","hoverInfo","cleanup","LocalExpressionContext","getService","FormContext","useService","useContext","isRequired","required","pathParse","path","split","key","isNaN","parseInt","pathsEqual","a","b","every","indices","generateIndexForType","generateIdForType","clone","replacer","JSON","stringify","buildExpressionContext","specialContextKeys","_wrapObjectKeysWithUnderscores","runRecursively","fn","components","component","obj","newObj","entries","useCondition","condition","conditionChecker","expressionContextInfo","useMemo","check","getSimpleOptionsData","formData","valuesExpression","optionsExpression","valuesKey","optionsKey","staticOptions","normalizeOptionsData","optionsData","_isAllowedValue","_normalizeOption","o","isNil","createEmptyOptions","defaults","option","_isAllowedPrimitive","isObject","isValidLabel","_isValidLabel","isAllowedPrimitiveType","isValid","useExpressionEvaluation","expressionLanguage","useDeepCompareMemoize","ref","useRef","isEqual","LOAD_STATES","LOADING","LOADED","ERROR","useOptionsAsync","initialData","_getState","expressionEvaluation","evaluatedOptions","optionsGetter","keyedOptions","isArray","buildErrorState","buildLoadedState","loadState","useDangerousHTMLWrapper","html","transform","sanitize","sanitizeStyleTags","sanitizedHtml","DOMPurify","getDOMPurifyConfig","transformedHtml","__html","FORCE_BODY","FORBID_TAGS","useSecurityAttributesMap","security","securityMemoized","sandbox","join","allow","useGetLabelCorrelation","labelMap","assign","_getValueHash","useCallback","useScrollIntoView","targetRef","deps","scrollOptions","flagRefs","useEffect","itemToBeScrolled","scrollContainer","_getNearestScrollableAncestor","itemRect","getBoundingClientRect","containerRect","shouldScroll","scrollIfVisible","top","bottom","align","behavior","topOffset","_getTopOffset","scroll","el","scrollHeight","clientHeight","parentElement","item","scrollTop","height","useFilteredFormData","newData","applyConditions","useKeyDownAction","targetKey","listenerElement","window","downHandler","addEventListener","removeEventListener","useReadonly","properties","readOnly","usePrevious","defaultValue","useFlushDebounce","func","timeoutRef","lastArgsRef","debounce","shouldDebounce","delay","debounceFunc","args","clearTimeout","setTimeout","flushFunc","useTemplateEvaluation","templating","useSingleLineTemplateEvaluation","evaluatedTemplate","ENTER_KEYDOWN_EVENT","KeyboardEvent","code","charCode","keyCode","bubbles","focusRelevantFlatpickerDay","flatpickrInstance","isOpen","open","calendarContainer","dayToFocus","querySelector","focus","formatTime","use24h","minutes","wrappedMinutes","minute","hour","Math","floor","_getZeroPaddedString","isPM","parseInputTime","stringTime","workingString","toLowerCase","is12h","digits","match","displayHour","isValidDisplayHour","isNumber","isValidMinute","isValidHour","serializeTime","timeSerializingFormat","normalizedMinutes","baseTime","addUTCOffset","formatTimezoneOffset","parseIsoTime","isoTimeString","parseBasicMinutes","timeString","timeSegments","localOffset","Date","getTimezoneOffset","replace","offsetString","inboundOffset","serializeDate","date","d","month","getMonth","day","getDate","year","getFullYear","isDateTimeInputInformationSufficient","segments","dateNumbers","isDateInputInformationMatching","serializeDateTime","time","workingDate","setFullYear","setHours","timezoneOffsetMinutes","dayOffset","getHours","_getSignedPaddedHours","abs","isInvalidDateString","getTime","toString","padStart","ALLOWED_IMAGE_SRC_PATTERN","ALLOWED_IFRAME_SRC_PATTERN","sanitizeDateTimePickerValue","subtype","hasEqualValue","array","element","sanitizeSingleSelectValue","validValues","v","sanitizeMultiSelectValue","sanitizeImageSource","src","valid","sanitizeIFrameSource","escapeHTML","escapeMap","useCleanupSingleSelectValue","onChange","optionValues","hasValueNotInOptions","useCleanupMultiSelectValue","memoizedValues","hasValuesNotInOptions","Description","description","evaluatedDescription","Errors","Label","htmlFor","collapseOnEmpty","evaluatedLabel","jsxs","for","type$f","Checkbox","domId","validate","target","checked","descriptionId","errorMessageId","emptyValue","sanitizeValue","type$e","Checklist","outerDivRef","toggleCheckbox","toggledValue","newValues","onCheckboxBlur","e","contains","relatedTarget","onCheckboxFocus","itemDomId","isChecked","onClick","noop$1","FormField","formFields","viewerCommands","pathRegistry","form","initialValidationTrigger","setInitialValidationTrigger","useState","FormFieldComponent","valuePath","getValuePath","initialValue","resetValidation","on","off","updateFieldValidation","hidden","conditional","hide","onChangeIndexed","update","fieldErrors","ChildrenRenderer","repeatRenderManager","isRepeating","isFieldRepeating","Repeater","RepeatFooter","RepeatChildrenRenderer","ChildrenRoot","SimpleChildrenRenderer","isEmpty","RowsRenderer","restProps","useSharedState","isCollapsed","Fragment","parentId","verticalAlignment","formLayouter","formFieldRegistry","rows","getRows","row","alignItems","childId","childField","Default","fullProps","_path$v","_extends$w","_extends","bind","arguments","prototype","hasOwnProperty","call","apply","SvgCalendar","React","xmlns","width","fill","viewBox","fillRule","clipRule","CalendarIcon","getLocaleDateFormat","locale","Intl","DateTimeFormat","formatToParts","UTC","part","len","repeat","getLocaleReadableDateFormat","format","getLocaleDateFlatpickrConfig","flatpickerizeDateFormat","dateFormat","useLeadingZero","InputAdorner","pre","post","rootRef","inputRef","hasErrors","onAdornmentClick","Datepicker","collapseLabelOnEmpty","onDateTimeBlur","onDateTimeFocus","disallowPassedDates","dateObject","setDate","dateInputRef","focusScopeRef","setFlatpickrInstance","isInputDirty","setIsInputDirty","forceFocusCalendar","setForceFocusCalendar","allowInput","static","clickOpens","minDate","errorHandler","instance","flatpickr","onCalendarFocusOut","close","onCalendarMouseDown","onOpen","onClose","onInputKeyDown","dispatchEvent","preventDefault","onInputFocus","onInputBlur","isFalseBlur","placeholder","autoComplete","onKeyDown","onMouseDown","onInput","_path$u","_path2$5","_extends$v","SvgClock","ClockIcon","DEFAULT_LABEL_GETTER","NOOP","DropdownList","getLabel","onValueSelected","emptyListMessage","initialFocusIndex","mouseControl","setMouseControl","focusedValueIndex","setFocusedValueIndex","smoothScrolling","setSmoothScrolling","dropdownContainer","mouseScreenPos","focusedItem","changeFocusedValueIndex","delta","min","max","individualEntries","focusedEntry","scrollIntoView","block","inline","onMouseMovedInKeyboardMode","event","valueIndex","userMovedCursor","screenX","y","screenY","tabIndex","maxHeight","scrollBehavior","onMouseMove","onMouseEnter","Timepicker","timeInterval","setTime","safeTimeInterval","allowedIntervals","timeInputRef","dropdownIsOpen","setDropdownIsOpen","useDropdown","rawValue","setRawValue","intervalAdjustedTime","propagateRawToMinute","newRawValue","localRawValue","correctedMinutes","timeOptions","minutesInDay","intervalCount","intervalIndex","cacheTime","flooredCacheTime","onDropdownValueSelected","type$d","Datetime","dateLabel","timeLabel","dateTimeGroupRef","getNullDateTime","dateTime","setDateTime","dateTimeUpdateRequest","setDateTimeUpdateRequest","isValidDate","isValidTime","useDatePicker","useTimePicker","getMinutes","computeAndSetState","newDateTimeValue","refreshOnly","newDateTime","allErrors","isOnlyOneFieldSet","prev","datePickerProps","timePickerProps","set","Group","showOutline","className","role","pathed","type$c","DEFAULT_HEIGHT","IFrame","url","evaluatedUrl","safeUrl","iframeRefresh","setIframeRefresh","count","IFramePlaceholder","text","title","allowScripts","_path$t","_extends$u","SvgButton","ButtonIcon","_path$s","_extends$t","SvgCheckbox","CheckboxIcon","_path$r","_extends$s","SvgChecklist","ChecklistIcon","_path$q","_path2$4","_path3","_extends$r","SvgDatetime","DatetimeIcon","_path$p","_path2$3","_extends$q","SvgTaglist","TaglistIcon","_rect","_rect2","_rect3","_extends$p","SvgForm","rx","FormIcon","_path$o","_extends$o","SvgGroup","GroupIcon","_path$n","_extends$n","SvgNumber","NumberIcon","_path$m","_extends$m","SvgRadio","RadioIcon","_path$l","_extends$l","SvgSelect","SelectIcon","_path$k","_extends$k","SvgSeparator","SeparatorIcon","_path$j","_extends$j","SvgSpacer","SpacerIcon","_path$i","_extends$i","SvgDynamicList","DynamicListIcon","_path$h","_extends$h","SvgText","TextIcon","_path$g","_extends$g","SvgHtml","HTMLIcon","_path$f","_extends$f","SvgTextfield","TextfieldIcon","_path$e","_extends$e","SvgTextarea","TextareaIcon","_path$d","_path2$2","_extends$d","SvgIFrame","IFrameIcon","_path$c","_path2$1","_extends$c","SvgImage","ImageIcon","_path$b","_extends$b","SvgTable","TableIcon","iconsByType","button","checkbox","checklist","datetime","iframe","image","number","radio","select","separator","spacer","dynamiclist","taglist","textfield","textarea","table","default","type$b","Image","alt","Icon","evaluatedImageSource","safeSource","altText","TemplatedInputAdorner","evaluatedPre","evaluatedPost","_path$a","_extends$a","SvgAngelDown","stroke","strokeWidth","AngelDownIcon","_path$9","_extends$9","SvgAngelUp","AngelUpIcon","countDecimals","num","Big","toFixed","isValidNumber","Number","willKeyProduceValidNumber","previousValue","caretIndex","selectionWidth","decimalDigits","isFirstDot","isFirstMinus","keypressIsNumeric","dotIndex","indexOf","overflowsDecimalSpace","keypressIsAllowedChar","isNullEquivalentValue","type$a","Numberfield","appearance","increment","incrementValue","prefixAdorner","suffixAdorner","cachedValue","setCachedValue","displayValue","setDisplayValue","debouncedOnChange","flushOnChange","previousCachedValue","setValue","stringValue","replaceAll","outerValueChanged","outerValueEqualsCache","incrementAmount","base","stepFlooredValue","minus","mod","plus","decrement","cmp","onKeyPress","selectionStart","selectionEnd","onPaste","step","serializeToString","type$9","Radio","onRadioBlur","onRadioFocus","_path$8","_extends$8","SvgXMark","XMarkIcon","SearchableSelect","setFilter","isDropdownExpanded","setIsDropdownExpanded","isFilterActive","setIsFilterActive","isEscapeClosed","setIsEscapeClose","searchbarRef","getLabelCorrelation","filteredOptions","displayState","ds","componentReady","displayCross","displayDropdown","onAngelMouseDown","searchbar","blur","onInputChange","keyDownEvent","onInputMouseDown","SimpleSelect","selectRef","valueLabel","input","findIndex","stopPropagation","type$8","Select","searchable","selectProps","type$7","Separator","type$6","Spacer","DynamicList","repeatable","allowAddRemove","defaultRepetitions","SkipLink","onSkip","href","type$5","Taglist","hasOptionsLeft","isValidFilteredOption","filterMatches","selectValue","at","deselectValue","onElementBlur","onElementFocus","onTagRemoveClick","nextTag","closest","nextSibling","onSkipToSearch","shouldDisplayDropdown","NODE_TYPE_TEXT","NODE_TYPE_ELEMENT","ALLOWED_NODES","ALLOWED_ATTRIBUTES","ALLOWED_URI_PATTERN","ATTR_WHITESPACE_PATTERN","FORM_ELEMENT","sanitizeHTML","doc","DOMParser","parseFromString","normalize","body","firstChild","sanitizeNode","innerHTML","nodeType","remove","lcTag","tagName","attributes","lcName","trim","removeAttribute","isValidAttribute","setAttribute","getAttribute","childNodes","type$4","Text","textLinkTarget","disableLinks","markdownRenderer","markdown","render","sanitizeAndTransformLinks","unsafeHtml","tempDiv","links","querySelectorAll","link","dangerouslySetInnerHTML","wrapCSSStyles","rootNode","styleTags","styleTag","topLevelRules","extractTopLevelRules","textContent","scopedCss","rule","selector","styles","splitRule","scopedSelector","scopeSelector","cssString","cursor","start","level","substring","firstBracket","sel","type$3","Html","styleScope","type$2","Textfield","String","type$1","Textarea","textareaRef","autoSizeTextarea","useLayoutEffect","computed","getComputedStyle","heightFromLines","lineHeight","getPropertyValue","lines","calculatedHeight","minHeight","displayHeight","overflow","_path$7","_extends$7","SvgArrowDown","ArrowDownIcon","_path$6","_extends$6","SvgArrowUp","ArrowUpIcon","_path$5","_extends$5","SvgCaretLeft","xmlSpace","CaretLeftIcon","_path$4","_extends$4","SvgCaretRight","CaretRightIcon","Table","columnsExpression","dataSource","rowCount","sortBy","setSortBy","evaluatedColumns","useEvaluatedColumns","columnKeys","evaluatedDataSource","sortedData","sortByColumn","direction","chunkedData","chunk","currentPage","setCurrentPage","currentChunk","toggleSortBy","displayLabel","getHeaderAriaLabel","colSpan","page","remainingOptions","isDefined","isColumn","generateInitialDemoData","demoData","demoDataKeys","fallbackColumns","evaluation","column","size","chunks","sort","Logo","Lightbox","onBackdropClick","rel","Link","PoweredBy","setOpen","toggleOpen","Fragment$1","createPortal","noop","FormComponent","schema","ariaLabel","onSubmit","onReset","handleSubmit","handleReset","filteredFormData","localExpressionContext","noValidate","Provider","FormFields","_formFields","register","EXPRESSION_PROPERTIES","TEMPLATE_PROPERTIES","getSchemaVariables","inputs","outputs","getAllComponents","prop","expressionVariables","templateVariables","variable","getBindingVariables","bindingVariable","getAncestryList","formFieldId","ids","currentFormField","_parent","ConditionChecker","_formFieldRegistry","_pathRegistry","contextData","workingData","getFilterPath","leafNodeDeletionOnly","_applyConditionsWithinScope","rootField","scopeContext","startHidden","expressionIndexes","scopeData","parentScopeData","executeRecursivelyOnFields","isClosed","isRepeatable","isHidden","_checkHideCondition","preventRecursion","repeaterValuePath","repeaterValue","newScopeContext","_cleanlyClearDataAtPath","getForm","unaryTest","workingValuePath","recurse","parentObject","_isEmptyObject","_isEmptyArray","ExpressionLanguageModule","__init__","showdown","setFlavor","MarkdownRenderer","_converter","Converter","makeHtml","MarkdownRendererModule","CommandStack","_handlerMap","_stack","_stackIdx","_currentExecution","actions","dirty","trigger","_injector","_uid","clear","execute","command","_pushAction","_internalExecute","_popAction","canExecute","handler","_getHandler","_fire","emit","undo","_getUndoAction","next","_internalUndo","redo","_getRedoAction","_setHandler","registerHandler","handlerCls","instantiate","canUndo","canRedo","_atomicDo","revert","_markDirty","_revertedAction","qualifier","names","createEvent","cancelBubble","_createId","execution","atomic","preExecute","_executedAction","postExecute","baseAction","elements","uniqueBy","stackIdx","splice","commandModule","commandStack","UpdateFieldValidationHandler","validator","_form","_validator","oldErrors","validateField","updatedErrors","_setState","ViewerCommands","_commandStack","registerHandlers","getHandlers","ViewerCommandsModule","__depends__","_path$3","_extends$3","SvgExpand","ExpandSvg","_path$2","_extends$2","SvgCollapse","CollapseSvg","_path$1","_path2","_extends$1","SvgAdd","AddSvg","_path","SvgDelete","DeleteSvg","RepeatRenderManager","formFieldDefinition","sharedRepeatState","repeaterField","dataPath","nonCollapsedItems","_getNonCollapsedItems","collapseEnabled","disableCollapse","hasChildren","showRemove","displayValues","onDeleteItem","updatedValues","parentExpressionContextInfo","itemValue","itemIndex","RepetitionScaffold","addButtonRef","setSharedRepeatState","showAdd","toggle","state","onAddItem","newItem","_getInitializedFieldData","DEFAULT_NON_COLLAPSED_ITEMS","elementProps","localExpressionContextInfo","RepeatRenderModule","FN_REF","DEFAULT_PRIORITY","EventBus","_listeners","_destroy","events","priority","callback","that","isFunction","actualCallback","self","_addListener","once","wrappedCallback","__isTomb","_removeListener","InternalEvent","firstListener","returnValue","originalType","_invokeListeners","defaultPrevented","handleError","listener","_invokeListener","invokeFunction","console","newListener","_getListeners","previousListener","_setListeners","nextListener","listenerCallback","EMAIL_PATTERN","PHONE_PATTERN","VALIDATE_FEEL_PROPERTIES","Validator","_expressionLanguage","_conditionChecker","bigValue","bigIncrement","nextValue","evaluatedValidation","evaluateFEELValues","pattern","RegExp","isUncheckedCheckbox","isUnsetValue","isEmptyMultiselect","minLength","maxLength","validationType","evaluatedValidate","filteredData","evaluatedValue","Importer","fieldFactory","_fieldFactory","_formLayouter","importSchema","warnings","_cleanup","importedSchema","importFormField","calculateLayout","fieldAttrs","importFormFields","FieldFactory","attrs","applyDefaults","fieldDefinition","_ids","assigned","parentPath","knownAncestorIds","canClaimPath","labelAttrs","_ensureId","_ensureKey","claimPath","claimerId","_enforceDefaultPath","claim","nextPrefixed","_getUniqueKeyPath","random","PathRegistry","_dataPaths","skipAncestryCheck","segment","_getNextSegment","isValidRepeatClaim","repeaterId","claimCount","unclaimPath","formFieldConfig","callResult","replacements","cutoffNode","localValuePath","hasReplacement","replacement","_addIndexes","find","FormLayouter","_rows","Ids","addRow","rowsPerComponent","r","getRow","allRows","getRowForField","rowsForField","nextRowId","rowsInOrder","groupByRow","c","groupBy","formRows","flat","FormFieldRegistry","getAll","Renderer","App","setState","formContext","_id","newState","_update","submit","reset","RenderModule","renderer","CoreModule","importer","Form","_onEvent","_container","_createInjector","_state","invoke","attachTo","_emit","destroy","_detach","Promise","resolve","reject","initializedData","_getSubmitData","getErrorPath","validateFieldRecursively","fieldConfig","valueData","_","workingErrors","filteredErrors","_applyConditions","parentNode","detach","appendChild","removeChild","setProperty","modules","_getModules","additionalModules","enrichedConfig","collectSubmitDataRecursively","submitData","workingSubmitData","toFilter","initializeFieldDataRecursively","isUndefined","initializedFieldValue","val","basePath","schemaVersion","createForm","formOptions","then"],"sources":["/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/features/expressionLanguage/variableExtractionHelpers.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/features/expressionLanguage/FeelExpressionLanguage.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/features/expressionLanguage/FeelersTemplating.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/util/constants/DatetimeConstants.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/util/constants/OptionsSourceConstants.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/util/constants/IFrameConstants.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/util/injector.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/util/form.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/Util.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/Button.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/context/FormRenderContext.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/context/LocalExpressionContext.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/context/FormContext.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/hooks/useService.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/util/simple.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/hooks/useCondition.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/util/optionsUtil.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/hooks/useExpressionEvaluation.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/hooks/useDeepCompareMemoize.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/hooks/useOptionsAsync.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/hooks/useDangerousHTMLWrapper.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/hooks/useSecurityAttributesMap.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/hooks/useGetLabelCorrelation.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/hooks/useScrollIntoView.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/hooks/useFilteredFormData.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/hooks/useKeyDownAction.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/hooks/useReadonly.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/hooks/usePrevious.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/hooks/useFlushDebounce.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/hooks/useTemplateEvaluation.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/hooks/useSingleLineTemplateEvaluation.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/util/dateTimeUtil.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/util/sanitizerUtil.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/hooks/useCleanupSingleSelectValue.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/hooks/useCleanupMultiSelectValue.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/Description.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/Errors.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/Label.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/Checkbox.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/Checklist.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/FormField.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/parts/ChildrenRenderer.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/Default.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/icons/Calendar.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/util/localisationUtil.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/parts/InputAdorner.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/parts/Datepicker.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/icons/Clock.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/parts/DropdownList.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/parts/Timepicker.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/Datetime.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/Group.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/IFrame.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/icons/Button.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/icons/Checkbox.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/icons/Checklist.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/icons/Datetime.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/icons/Taglist.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/icons/Form.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/icons/Group.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/icons/Number.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/icons/Radio.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/icons/Select.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/icons/Separator.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/icons/Spacer.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/icons/DynamicList.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/icons/Text.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/icons/HTML.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/icons/Textfield.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/icons/Textarea.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/icons/IFrame.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/icons/Image.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/icons/Table.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/icons/index.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/Image.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/parts/TemplatedInputAdorner.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/icons/AngelDown.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/icons/AngelUp.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/util/numberFieldUtil.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/Number.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/Radio.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/icons/XMark.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/parts/SearchableSelect.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/parts/SimpleSelect.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/Select.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/Separator.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/Spacer.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/DynamicList.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/parts/SkipLink.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/Taglist.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/Sanitizer.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/Text.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/util/domUtil.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/Html.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/Textfield.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/Textarea.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/icons/ArrowDown.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/icons/ArrowUp.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/icons/CaretLeft.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/icons/CaretRight.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/Table.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/PoweredBy.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/FormComponent.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/index.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/FormFields.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/util/getSchemaVariables.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/util/structure.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/features/expressionLanguage/ConditionChecker.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/features/expressionLanguage/index.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/features/markdown/MarkdownRenderer.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/features/markdown/index.js","/Users/Shivaji/Workspace/Play/cta/node_modules/node_modules/diagram-js/lib/command/CommandStack.js","/Users/Shivaji/Workspace/Play/cta/node_modules/node_modules/diagram-js/lib/command/index.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/features/viewerCommands/cmd/UpdateFieldValidationHandler.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/features/viewerCommands/ViewerCommands.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/features/viewerCommands/index.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/icons/Expand.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/icons/Collapse.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/icons/Add.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/components/form-fields/icons/Delete.svg","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/features/repeatRender/RepeatRenderManager.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/features/repeatRender/index.js","/Users/Shivaji/Workspace/Play/cta/node_modules/node_modules/diagram-js/lib/core/EventBus.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/core/Validator.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/core/Importer.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/core/FieldFactory.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/core/PathRegistry.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/core/FormLayouter.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/core/FormFieldRegistry.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/Renderer.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/render/index.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/core/index.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/Form.js","/Users/Shivaji/Workspace/Play/cta/node_modules/@bpmn-io/form-js-viewer/src/index.js"],"sourcesContent":["import { parseExpression, parseUnaryTests } from 'feelin';\n\nexport const getFlavouredFeelVariableNames = (feelString, feelFlavour = 'expression', options = {}) => {\n\n  const {\n    depth = 0,\n    specialDepthAccessors = {}\n  } = options;\n\n  if (![ 'expression', 'unaryTest' ].includes(feelFlavour)) return [];\n\n  const tree = feelFlavour === 'expression' ? parseExpression(feelString) : parseUnaryTests(feelString);\n\n  const simpleExpressionTree = _buildSimpleFeelStructureTree(tree, feelString);\n\n  const variables = (function _unfoldVariables(node) {\n\n    if (node.name === 'PathExpression') {\n\n      // if the path is built on top of a context, we process that context and\n      // ignore the rest of the path expression, as it is not relevant for variable extraction\n      const pathRoot = _linearizePathExpression(node)[0];\n      if (pathRoot.name === 'Context') {\n        return _unfoldVariables(pathRoot);\n      }\n\n      if (Object.keys(specialDepthAccessors).length === 0) {\n        return depth === 0 ? [ _getVariableNameAtPathIndex(node, 0) ] : [ ];\n      }\n\n      // if using special depth accessors, use a more complex extraction\n      return Array.from(_smartExtractVariableNames(node, depth, specialDepthAccessors));\n    }\n\n    if (depth === 0 && node.name === 'VariableName') return [ node.variableName ];\n\n    // for any other kind of node, traverse its children and flatten the result\n    if (node.children) {\n      const variables = node.children.reduce((acc, child) => {\n        return acc.concat(_unfoldVariables(child));\n      }, []);\n\n      // if we are within a filter context, we need to remove the item variable as it is used for iteration there\n      return node.name === 'FilterContext' ? variables.filter((name) => name !== 'item') : variables;\n    }\n\n    return [];\n  })(simpleExpressionTree);\n\n  return [ ...new Set(variables) ];\n\n};\n\n\n/**\n * Get the variable name at the specified index in a given path expression.\n *\n * @param {Object} root - The root node of the path expression tree.\n * @param {number} index - The index of the variable name to retrieve.\n * @returns {string|null} The variable name at the specified index or null if index is out of bounds.\n */\nconst _getVariableNameAtPathIndex = (root, index) => {\n  const nodes = _linearizePathExpression(root);\n  return nodes[index].variableName || null;\n};\n\n\n/**\n * Extracts the variables which are required of the external context for a given path expression.\n * This is done by traversing the path expression tree and keeping track of the current depth relative to the external context.\n *\n * @param {Object} node - The root node of the path expression tree.\n * @param {number} initialDepth - The depth at which the root node is located in the outer context.\n * @param {Object} specialDepthAccessors - Definitions of special keywords which represent more complex accesses of the outer context.\n * @returns {Set} - A set containing the extracted variable names.\n */\nconst _smartExtractVariableNames = (node, initialDepth, specialDepthAccessors) => {\n\n  // depth info represents the previous (initialised as null) and current depth of the current accessor in the path expression\n  // we track multiple of these to account for the fact that a path expression may be ambiguous due to special keywords\n  let accessorDepthInfos = [ { previous: null, current: initialDepth - 1 } ];\n  const extractedVariables = new Set();\n  const pathNodes = _linearizePathExpression(node);\n\n  for (let i = 0; i < pathNodes.length; i++) {\n    const currentAccessor = pathNodes[i].variableName;\n\n    if (currentAccessor in specialDepthAccessors) {\n      const depthOffsets = specialDepthAccessors[currentAccessor];\n\n      // if the current accessor is a special keyword, we need to expand the current depth info set\n      // this is done to account for the ambiguity of keywords like parent, which may be used to access\n      // the parent of the current node, or a child variable of the same name\n      accessorDepthInfos = depthOffsets.reduce((accumulator, offset) => {\n        return [\n          ...accumulator,\n          ...accessorDepthInfos.map(depthInfo => ({ previous: depthInfo.current, current: depthInfo.current + offset })),\n        ];\n      }, []).filter(depthInfo => depthInfo.current >= -1); // discard all depth infos which are out of bounds\n\n    } else {\n\n      // if the current accessor is not a special keyword, we know it's simply accessing a child\n      // hence we are now one level deeper in the tree and simply increment\n      accessorDepthInfos = accessorDepthInfos.map(depthInfo => ({ previous: depthInfo.current, current: depthInfo.current + 1 }));\n    }\n\n    // finally, we check if for the current accessor, there is a scenario where:\n    // previous it was at depth -1 (i.e. the root context), and is now at depth 0 (i.e. a variable)\n    // these are the variables we need to request, so we add them to the set\n    if (accessorDepthInfos.some(depthInfo => depthInfo.previous === -1 && depthInfo.current === 0)) {\n      extractedVariables.add(currentAccessor);\n    }\n  }\n\n  // we return a set to avoid duplicates\n  return new Set(extractedVariables);\n};\n\n\n/**\n * Deconstructs a path expression tree into an array of components.\n *\n * @param {Object} root - The root node of the path expression tree.\n * @returns {Array<object>} An array of components in the path expression, in the correct order.\n */\nconst _linearizePathExpression = (root) => {\n\n  let node = root;\n  let parts = [];\n\n  // Traverse the tree and collect path components\n  while (node.name === 'PathExpression') {\n    parts.push(node.children[1]);\n    node = node.children[0];\n  }\n\n  // Add the last component to the array\n  parts.push(node);\n\n  // Reverse and return the array to get the correct order\n  return parts.reverse();\n};\n\n\n/**\n * Builds a simplified feel structure tree from the given parse tree and feel string.\n * The nodes follow this structure: `{ name: string, children: Array, variableName?: string }`\n *\n * @param {Object} parseTree - The parse tree generated by a parser.\n * @param {string} feelString - The feel string used for parsing.\n * @returns {Object} The simplified feel structure tree.\n */\nconst _buildSimpleFeelStructureTree = (parseTree, feelString) => {\n\n  const stack = [ { children: [] } ];\n  parseTree.iterate({\n    enter: (node) => {\n\n      const nodeRepresentation = {\n        name: node.type.name,\n        children: [],\n      };\n\n      if (node.type.name === 'VariableName') {\n        nodeRepresentation.variableName = feelString.slice(node.from, node.to);\n      }\n\n      stack.push(nodeRepresentation);\n    },\n    leave: () => {\n      const result = stack.pop();\n      const parent = stack[stack.length - 1];\n      parent.children.push(result);\n    }\n  });\n\n  return _extractFilterExpressions(stack[0].children[0]);\n};\n\n/**\n * Restructure the tree in such a way to bring filters (which create new contexts) to the root of the tree.\n * This is done to simplify the extraction of variables and match the context hierarchy.\n */\nconst _extractFilterExpressions = (tree) => {\n\n  const flattenedExpressionTree = {\n    name: 'Root',\n    children: [ tree ]\n  };\n\n  const iterate = (node) => {\n\n    if (node.children) {\n      for (let x = 0; x < node.children.length; x++) {\n\n        if (node.children[x].name === 'FilterExpression') {\n\n          const filterTarget = node.children[x].children[0];\n          const filterExpression = node.children[x].children[2];\n\n          // bypass the filter expression\n          node.children[x] = filterTarget;\n\n          const taggedFilterExpression = {\n            name: 'FilterContext',\n            children: [ filterExpression ]\n          };\n\n          // append the filter expression to the root\n          flattenedExpressionTree.children.push(taggedFilterExpression);\n\n          // recursively iterate the expression\n          iterate(filterExpression);\n\n        } else {\n          iterate(node.children[x]);\n        }\n      }\n\n    }\n\n  };\n\n  iterate(tree);\n\n  return flattenedExpressionTree;\n};\n","import { evaluate } from 'feelin';\nimport { isString } from 'min-dash';\nimport { getFlavouredFeelVariableNames } from './variableExtractionHelpers';\n\nexport class FeelExpressionLanguage {\n  constructor(eventBus) {\n    this._eventBus = eventBus;\n  }\n\n  /**\n   * Determines if the given value is a FEEL expression.\n   *\n   * @param {any} value\n   * @returns {boolean}\n   *\n   */\n  isExpression(value) { return isString(value) && value.startsWith('='); }\n\n  /**\n   * Retrieve variable names from a given FEEL expression.\n   *\n   * @param {string} expression\n   * @param {object} [options]\n   * @param {string} [options.type]\n   *\n   * @returns {string[]}\n   */\n  getVariableNames(expression, options = {}) {\n\n    const {\n      type = 'expression'\n    } = options;\n\n    if (!this.isExpression(expression)) {\n      return [];\n    }\n\n    if (![ 'unaryTest', 'expression' ].includes(type)) {\n      throw new Error('Unknown expression type: ' + type);\n    }\n\n    return getFlavouredFeelVariableNames(expression, type);\n  }\n\n  /**\n   * Evaluate an expression.\n   *\n   * @param {string} expression\n   * @param {import('../../types').Data} [data]\n   *\n   * @returns {any}\n   */\n  evaluate(expression, data = {}) {\n    if (!expression) {\n      return null;\n    }\n\n    if (!isString(expression) || !expression.startsWith('=')) {\n      return null;\n    }\n\n    try {\n      const result = evaluate(expression.slice(1), data);\n\n      return result;\n    } catch (error) {\n      this._eventBus.fire('error', { error });\n      return null;\n    }\n  }\n}\n\nFeelExpressionLanguage.$inject = [\n  'eventBus'\n];","import { parser as feelersParser, buildSimpleTree, evaluate as evaluateFeelers } from 'feelers';\nimport { isString } from 'min-dash';\nimport { getFlavouredFeelVariableNames } from './variableExtractionHelpers';\n\nexport class FeelersTemplating {\n\n  constructor() { }\n\n  /**\n   * Determines if the given value is a feelers template.\n   *\n   * @param {any} value\n   * @returns {boolean}\n   *\n   */\n  isTemplate(value) { return isString(value) && (value.startsWith('=') || /{{.*?}}/.test(value)); }\n\n\n  /**\n   * Retrieve variable names from a given feelers template.\n   *\n   * @param {string} template\n   *\n   * @returns {string[]}\n   */\n  getVariableNames(template) {\n\n    if (!this.isTemplate(template)) {\n      return [];\n    }\n\n    const expressions = this._extractExpressionsWithDepth(template);\n\n    // defines special accessors, and the change(s) in depth they could imply (e.g. parent can be used to access the parent context (depth - 1) or a child variable named parent (depth + 1)\n    const specialDepthAccessors = {\n      parent: [ -1, 1 ],\n      _parent_: [ -1 ],\n      this: [ 0, 1 ],\n      _this_: [ 0 ],\n    };\n\n    return expressions.reduce((variables, { expression, depth }) => {\n      return variables.concat(getFlavouredFeelVariableNames(expression, 'expression', { depth, specialDepthAccessors }));\n    }, []);\n  }\n\n\n  /**\n   * Evaluate a template.\n   *\n   * @param {string} template\n   * @param {Object<string, any>} context\n   * @param {Object} options\n   * @param {boolean} [options.debug = false]\n   * @param {boolean} [options.strict = false]\n   * @param {Function} [options.buildDebugString]\n   * @param {Function} [options.sanitizer]\n   *\n   * @returns\n   */\n  evaluate(template, context = {}, options = {}) {\n\n    const {\n      debug = false,\n      strict = false,\n      buildDebugString = (err) => ' {{⚠}} ',\n      sanitizer = (value) => value\n    } = options;\n\n    return evaluateFeelers(template, context, { debug, strict, buildDebugString, sanitizer });\n  }\n\n\n  /**\n * @typedef {Object} ExpressionWithDepth\n * @property {number} depth - The depth of the expression in the syntax tree.\n * @property {string} expression - The extracted expression\n */\n\n  /**\n * Extracts all feel expressions in the template along with their depth in the syntax tree.\n * The depth is incremented for child expressions of loops to account for context drilling.\n\n * @name extractExpressionsWithDepth\n * @param {string} template - A feelers template string.\n * @returns {Array<ExpressionWithDepth>} An array of objects, each containing the depth and the extracted expression.\n *\n * @example\n * const template = \"Hello {{user}}, you have:{{#loop items}}\\n- {{amount}} {{name}}{{/loop}}.\";\n * const extractedExpressions = _extractExpressionsWithDepth(template);\n */\n  _extractExpressionsWithDepth(template) {\n\n    // build simplified feelers syntax tree\n    const parseTree = feelersParser.parse(template);\n    const tree = buildSimpleTree(parseTree, template);\n\n    return (function _traverse(n, depth = 0) {\n\n      if ([ 'Feel', 'FeelBlock' ].includes(n.name)) {\n        return [ { depth, expression: n.content } ];\n      }\n\n      if (n.name === 'LoopSpanner') {\n        const loopExpression = n.children[0].content;\n        const childResults = n.children.slice(1).reduce((acc, child) => {\n          return acc.concat(_traverse(child, depth + 1));\n        }, []);\n        return [ { depth, expression: loopExpression }, ...childResults ];\n      }\n\n      return n.children.reduce((acc, child) => {\n        return acc.concat(_traverse(child, depth));\n      }, []);\n\n    })(tree);\n\n  }\n}\n\nFeelersTemplating.$inject = [];","// config  ///////////////////\n\nexport const MINUTES_IN_DAY = 60 * 24;\n\nexport const DATETIME_SUBTYPES = {\n  DATE: 'date',\n  TIME: 'time',\n  DATETIME: 'datetime'\n};\n\nexport const TIME_SERIALISING_FORMATS = {\n  UTC_OFFSET: 'utc_offset',\n  UTC_NORMALIZED: 'utc_normalized',\n  NO_TIMEZONE: 'no_timezone'\n};\n\nexport const DATETIME_SUBTYPES_LABELS = {\n  [DATETIME_SUBTYPES.DATE]: 'Date',\n  [DATETIME_SUBTYPES.TIME]: 'Time',\n  [DATETIME_SUBTYPES.DATETIME]: 'Date & Time'\n};\n\nexport const TIME_SERIALISINGFORMAT_LABELS = {\n  [TIME_SERIALISING_FORMATS.UTC_OFFSET]: 'UTC offset',\n  [TIME_SERIALISING_FORMATS.UTC_NORMALIZED]: 'UTC normalized',\n  [TIME_SERIALISING_FORMATS.NO_TIMEZONE]: 'No timezone'\n};\n\nexport const DATETIME_SUBTYPE_PATH = [ 'subtype' ];\nexport const DATE_LABEL_PATH = [ 'dateLabel' ];\nexport const DATE_DISALLOW_PAST_PATH = [ 'disallowPassedDates' ];\nexport const TIME_LABEL_PATH = [ 'timeLabel' ];\nexport const TIME_USE24H_PATH = [ 'use24h' ];\nexport const TIME_INTERVAL_PATH = [ 'timeInterval' ];\nexport const TIME_SERIALISING_FORMAT_PATH = [ 'timeSerializingFormat' ];\n","import { get } from 'min-dash';\n\n// config  ///////////////////\n\nexport const OPTIONS_SOURCES = {\n  STATIC: 'static',\n  INPUT: 'input',\n  EXPRESSION: 'expression',\n};\n\nexport const OPTIONS_SOURCE_DEFAULT = OPTIONS_SOURCES.STATIC;\n\nexport const OPTIONS_SOURCES_LABELS = {\n  [OPTIONS_SOURCES.STATIC]: 'Static',\n  [OPTIONS_SOURCES.INPUT]: 'Input data',\n  [OPTIONS_SOURCES.EXPRESSION]: 'Expression',\n};\n\nexport const OPTIONS_SOURCES_PATHS = {\n  [OPTIONS_SOURCES.STATIC]: [ 'values' ],\n  [OPTIONS_SOURCES.INPUT]: [ 'valuesKey' ],\n  [OPTIONS_SOURCES.EXPRESSION]: [ 'valuesExpression' ],\n};\n\nexport const OPTIONS_SOURCES_DEFAULTS = {\n  [OPTIONS_SOURCES.STATIC]: [\n    {\n      label: 'Value',\n      value: 'value'\n    }\n  ],\n  [OPTIONS_SOURCES.INPUT]: '',\n  [OPTIONS_SOURCES.EXPRESSION]: '='\n};\n\n// helpers ///////////////////\n\nexport function getOptionsSource(field) {\n\n  for (const source of Object.values(OPTIONS_SOURCES)) {\n    if (get(field, OPTIONS_SOURCES_PATHS[source]) !== undefined) {\n      return source;\n    }\n  }\n\n  return OPTIONS_SOURCE_DEFAULT;\n}\n","export const SANDBOX_ATTRIBUTE = 'sandbox';\nexport const ALLOW_ATTRIBUTE = 'allow';\n\n// Cf. https://developer.mozilla.org/en-US/docs/Web/HTTP/Permissions_Policy#iframe_syntax\nexport const SECURITY_ATTRIBUTES_DEFINITIONS = [\n  {\n    attribute: SANDBOX_ATTRIBUTE,\n    directive: 'allow-scripts',\n    property: 'allowScripts',\n    label: 'Script execution'\n  },\n  {\n    attribute: SANDBOX_ATTRIBUTE,\n    directive: 'allow-same-origin',\n    property: 'allowSameOrigin',\n    label: 'Allow same origin'\n  },\n  {\n    attribute: ALLOW_ATTRIBUTE,\n    directive: 'fullscreen',\n    property: 'fullscreen',\n    label: 'Open in fullscreen'\n  },\n  {\n    attribute: ALLOW_ATTRIBUTE,\n    directive: 'geolocation',\n    property: 'geolocation',\n    label: 'Geolocation'\n  },\n  {\n    attribute: ALLOW_ATTRIBUTE,\n    directive: 'camera',\n    property: 'camera',\n    label: 'Camera access'\n  },\n  {\n    attribute: ALLOW_ATTRIBUTE,\n    directive: 'microphone',\n    property: 'microphone',\n    label: 'Microphone access'\n  },\n  {\n    attribute: SANDBOX_ATTRIBUTE,\n    directive: 'allow-forms',\n    property: 'allowForms',\n    label: 'Forms submission'\n  },\n  {\n    attribute: SANDBOX_ATTRIBUTE,\n    directive: 'allow-modals',\n    property: 'allowModals',\n    label: 'Open modal windows'\n  },\n  {\n    attribute: SANDBOX_ATTRIBUTE,\n    directive: 'allow-popups',\n    property: 'allowPopups',\n    label: 'Open popups'\n  },\n  {\n    attribute: SANDBOX_ATTRIBUTE,\n    directive: 'allow-top-navigation',\n    property: 'allowTopNavigation',\n    label: 'Top level navigation'\n  },\n  {\n    attribute: SANDBOX_ATTRIBUTE,\n    directive: 'allow-storage-access-by-user-activation',\n    property: 'allowStorageAccessByUserActivation',\n    label: 'Storage access by user'\n  }\n];","import { Injector } from 'didi';\n\nexport function createInjector(bootstrapModules) {\n\n  const injector = new Injector(bootstrapModules);\n\n  injector.init();\n\n  return injector;\n}","/**\n * @param {string?} prefix\n *\n * @returns Element\n */\nexport function createFormContainer(prefix = 'fjs') {\n  const container = document.createElement('div');\n\n  container.classList.add(`${ prefix }-container`);\n\n  return container;\n}","import classNames from 'classnames';\n\nexport function formFieldClasses(type, { errors = [], disabled = false, readonly = false } = {}) {\n  if (!type) {\n    throw new Error('type required');\n  }\n\n  return classNames('fjs-form-field', `fjs-form-field-${type}`, {\n    'fjs-has-errors': errors.length > 0,\n    'fjs-disabled': disabled,\n    'fjs-readonly': readonly\n  });\n}\n\nexport function gridColumnClasses(formField) {\n  const {\n    layout = {}\n  } = formField;\n\n  const {\n    columns\n  } = layout;\n\n  return classNames(\n    'fjs-layout-column',\n    `cds--col${columns ? '-lg-' + columns : ''}`,\n\n    // always fall back to top-down on smallest screens\n    'cds--col-sm-16',\n    'cds--col-md-16'\n  );\n}\n\nexport function prefixId(id, formId, indexes) {\n  let result = 'fjs-form';\n\n  if (formId) {\n    result += `-${formId}`;\n  }\n\n  result += `-${id}`;\n\n  Object.values(indexes || {}).forEach((index) => {\n    result += `_${index}`;\n  });\n\n  return result;\n}\n","import { formFieldClasses } from '../Util';\n\nconst type = 'button';\n\nexport function Button(props) {\n  const {\n    disabled,\n    onFocus,\n    onBlur,\n    field\n  } = props;\n\n  const { action = 'submit' } = field;\n\n  return <div class={ formFieldClasses(type) }>\n    <button\n      class=\"fjs-button\"\n      type={ action }\n      disabled={ disabled }\n      onFocus={ () => onFocus && onFocus() }\n      onBlur={ () => onBlur && onBlur() }>\n      { field.label }\n    </button>\n  </div>;\n}\n\nButton.config = {\n  type,\n  keyed: false,\n  label: 'Button',\n  group: 'action',\n  create: (options = {}) => ({\n    action: 'submit',\n    ...options\n  })\n};\n","import { createContext } from 'preact';\n\nexport const FormRenderContext = createContext({\n  Empty: (props) => {\n    return null;\n  },\n  Hidden: (props) => {\n    return null;\n  },\n  Children: (props) => {\n    return <div class={ props.class } style={ props.style }>{ props.children }</div>;\n  },\n  Element: (props) => {\n    return <div class={ props.class } style={ props.style }>{ props.children }</div>;\n  },\n  Row: (props) => {\n    return <div class={ props.class } style={ props.style }>{ props.children }</div>;\n  },\n  Column: (props) => {\n    if (props.field.type === 'default') {\n      return props.children;\n    }\n\n    return <div class={ props.class } style={ props.style }>{ props.children }</div>;\n  },\n  hoverInfo: {\n    cleanup: () => {}\n  },\n});\n","import { createContext } from 'preact';\n\nexport const LocalExpressionContext = createContext({\n  data: null,\n  this: null,\n  parent: null,\n  i: null\n});\n","import { createContext } from 'preact';\n\n/**\n * @param {string} type\n * @param {boolean} [strict]\n *\n * @returns {any}\n */\nfunction getService(type, strict) {}\n\nexport const FormContext = createContext({\n  getService,\n  formId: null\n});\n","import {\n  useContext\n} from 'preact/hooks';\n\nimport { FormContext } from '../context';\n\nexport function useService(type, strict) {\n  const {\n    getService\n  } = useContext(FormContext);\n\n  return getService(type, strict);\n}","export function isRequired(field) {\n  return field.required;\n}\n\nexport function pathParse(path) {\n  if (!path) {\n    return [];\n  }\n\n  return path.split('.').map(key => {\n    return isNaN(parseInt(key)) ? key : parseInt(key);\n  });\n}\n\nexport function pathsEqual(a, b) {\n  return (\n    a &&\n    b &&\n    a.length === b.length &&\n    a.every((value, index) => value === b[ index ])\n  );\n}\n\nconst indices = {};\n\nexport function generateIndexForType(type) {\n  if (type in indices) {\n    indices[ type ]++;\n  } else {\n    indices[ type ] = 1;\n  }\n\n  return indices[ type ];\n}\n\nexport function generateIdForType(type) {\n  return `${ type }${ generateIndexForType(type) }`;\n}\n\n/**\n * @template T\n * @param {T} data\n * @param {(this: any, key: string, value: any) => any} [replacer]\n * @return {T}\n */\nexport function clone(data, replacer) {\n  return JSON.parse(JSON.stringify(data, replacer));\n}\n\n/**\n * Transform a LocalExpressionContext object into a usable FEEL context.\n *\n * @param {Object} context - The LocalExpressionContext object.\n * @returns {Object} The usable FEEL context.\n */\n\nexport function buildExpressionContext(context) {\n  const {\n    data,\n    ...specialContextKeys\n  } = context;\n\n  return {\n    ...specialContextKeys,\n    ...data,\n    ..._wrapObjectKeysWithUnderscores(specialContextKeys)\n  };\n}\n\nexport function runRecursively(formField, fn) {\n  const components = formField.components || [];\n\n  components.forEach((component, index) => {\n    runRecursively(component, fn);\n  });\n\n  fn(formField);\n}\n\n// helpers //////////////////////\n\nfunction _wrapObjectKeysWithUnderscores(obj) {\n  const newObj = {};\n  for (const [ key, value ] of Object.entries(obj)) {\n    newObj[`_${key}_`] = value;\n  }\n  return newObj;\n}","import { useService } from './useService.js';\nimport { useContext, useMemo } from 'preact/hooks';\nimport { LocalExpressionContext } from '../context/LocalExpressionContext.js';\nimport { buildExpressionContext } from '../../util/simple';\n\n/**\n * Evaluate if condition is met reactively based on the conditionChecker and form data.\n *\n * @param {string | undefined} condition\n *\n * @returns {boolean} true if condition is met or no condition or condition checker exists\n */\nexport function useCondition(condition) {\n  const conditionChecker = useService('conditionChecker', false);\n  const expressionContextInfo = useContext(LocalExpressionContext);\n\n  return useMemo(() => {\n    return conditionChecker ? conditionChecker.check(condition, buildExpressionContext(expressionContextInfo)) : null;\n  }, [ conditionChecker, condition, expressionContextInfo ]);\n}\n","import { get, isObject, isString, isNil } from 'min-dash';\n\n/**\n * Returns the options data for the provided if they can be simply determined, ignoring expression defined options.\n *\n * @param {object} formField\n * @param {object} formData\n */\nfunction getSimpleOptionsData(formField, formData) {\n\n  const {\n    valuesExpression: optionsExpression,\n    valuesKey: optionsKey,\n    values: staticOptions\n  } = formField;\n\n  if (optionsExpression) {\n    return null;\n  }\n\n  return optionsKey ? get(formData, [ optionsKey ]) : staticOptions;\n}\n\n/**\n * Normalizes the provided options data to a format that can be used by the select components.\n * If the options data is not valid, it is filtered out.\n *\n * @param {any[]} optionsData\n *\n * @returns {object[]}\n */\nfunction normalizeOptionsData(optionsData) {\n  return optionsData.filter(_isAllowedValue).map(_normalizeOption).filter(o => !isNil(o));\n}\n\n/**\n * Creates an options object with default values if no options are provided.\n *\n * @param {object} options\n *\n * @returns {object}\n */\nfunction createEmptyOptions(options = {}) {\n\n  const defaults = {};\n\n  // provide default options if valuesKey and valuesExpression are not set\n  if (!options.valuesKey && !options.valuesExpression) {\n    defaults.values = [\n      {\n        label: 'Value',\n        value: 'value'\n      }\n    ];\n  }\n\n  return {\n    ...defaults,\n    ...options\n  };\n}\n\n/**\n * Converts the provided option to a normalized format.\n * If the option is not valid, null is returned.\n *\n * @param {object} option\n * @param {string} option.label\n * @param {*} option.value\n *\n * @returns\n */\nfunction _normalizeOption(option) {\n\n  // (1) simple primitive case, use it as both label and value\n  if (_isAllowedPrimitive(option)) {\n    return { value: option, label: `${ option }` };\n  }\n\n  if (isObject(option)) {\n\n    const isValidLabel = _isValidLabel(option.label);\n\n    // (2) no label provided, but value is a simple primitive, use it as label and value\n    if (!isValidLabel && _isAllowedPrimitive(option.value)) {\n      return { value: option.value, label: `${ option.value }` };\n    }\n\n    // (3) both label and value are provided, use them as is\n    if (isValidLabel && _isAllowedValue(option.value)) {\n      return option;\n    }\n  }\n\n  return null;\n}\n\nfunction _isAllowedPrimitive(value) {\n  const isAllowedPrimitiveType = [ 'number', 'string', 'boolean' ].includes(typeof(value));\n  const isValid = value || value === 0 || value === false;\n\n  return isAllowedPrimitiveType && isValid;\n}\n\nfunction _isValidLabel(label) {\n  return label && isString(label);\n}\n\nfunction _isAllowedValue(value) {\n  if (isObject(value)) {\n    return Object.keys(value).length > 0;\n  }\n\n  return _isAllowedPrimitive(value);\n}\n\nexport { getSimpleOptionsData, normalizeOptionsData, createEmptyOptions };\n","import { useService } from './useService';\nimport { LocalExpressionContext } from '../context/LocalExpressionContext';\nimport { useContext, useMemo } from 'preact/hooks';\nimport { buildExpressionContext } from '../../util/simple';\n\n/**\n * Evaluate a string reactively based on the expressionLanguage and form data.\n * If the string is not an expression, it is returned as is.\n * The function is memoized to minimize re-renders.\n *\n * @param {string} value - The string to evaluate.\n * @returns {any} - Evaluated value or the original value if not an expression.\n */\nexport function useExpressionEvaluation(value) {\n  const expressionLanguage = useService('expressionLanguage');\n  const expressionContextInfo = useContext(LocalExpressionContext);\n\n  return useMemo(() => {\n    if (expressionLanguage && expressionLanguage.isExpression(value)) {\n      return expressionLanguage.evaluate(value, buildExpressionContext(expressionContextInfo));\n    }\n    return value;\n  }, [ expressionLanguage, expressionContextInfo, value ]);\n}\n","import { useRef } from 'preact/hooks';\nimport isEqual from 'lodash/isEqual';\n\n/**\n * A custom hook to manage state changes with deep comparison.\n *\n * @template T\n * @param {T} value - The current value to manage.\n * @returns {T} - Returns the current state.\n */\nexport function useDeepCompareMemoize(value) {\n  const ref = useRef();\n\n  if (!isEqual(value, ref.current)) {\n    ref.current = value;\n  }\n\n  return ref.current;\n}","import { useMemo } from 'preact/hooks';\nimport { normalizeOptionsData } from '../components/util/optionsUtil';\nimport { useExpressionEvaluation } from './useExpressionEvaluation';\nimport { useDeepCompareMemoize } from './useDeepCompareMemoize';\nimport { useService } from './useService';\n\n/**\n * @enum { String }\n */\nexport const LOAD_STATES = {\n  LOADING: 'loading',\n  LOADED: 'loaded',\n  ERROR: 'error'\n};\n\n/**\n * @typedef {Object} OptionsGetter\n * @property {Object[]} options - The options data\n * @property {(LOAD_STATES)} loadState - The options data's loading state, to use for conditional rendering\n */\n\n/**\n * A hook to load options for single and multiselect components.\n *\n * @param {Object} field - The form field to handle options for\n * @return {OptionsGetter} optionsGetter - A options getter object providing loading state and options\n */\nexport function useOptionsAsync(field) {\n  const {\n    valuesExpression: optionsExpression,\n    valuesKey: optionsKey,\n    values: staticOptions\n  } = field;\n\n  const initialData = useService('form')._getState().initialData;\n  const expressionEvaluation = useExpressionEvaluation(optionsExpression);\n  const evaluatedOptions = useDeepCompareMemoize(expressionEvaluation || []);\n\n  const optionsGetter = useMemo(() => {\n    let options = [];\n\n    // dynamic options\n    if (optionsKey !== undefined) {\n      const keyedOptions = (initialData || {})[optionsKey];\n      if (keyedOptions && Array.isArray(keyedOptions)) {\n        options = keyedOptions;\n      }\n\n    // static options\n    } else if (staticOptions !== undefined) {\n      options = Array.isArray(staticOptions) ? staticOptions : [];\n\n    // expression\n    } else if (optionsExpression && evaluatedOptions && Array.isArray(evaluatedOptions)) {\n      options = evaluatedOptions;\n\n    // error case\n    } else {\n      return buildErrorState('No options source defined in the form definition');\n    }\n\n    // normalize data to support primitives and partially defined objects\n    return buildLoadedState(normalizeOptionsData(options));\n  }, [ optionsKey, staticOptions, initialData, optionsExpression, evaluatedOptions ]);\n\n  return optionsGetter;\n}\n\nconst buildErrorState = (error) => ({ options: [], error, loadState: LOAD_STATES.ERROR });\n\nconst buildLoadedState = (options) => ({ options, error: undefined, loadState: LOAD_STATES.LOADED });\n","import { useMemo } from 'preact/hooks';\nimport DOMPurify from 'dompurify';\n\n\n/**\n * Wrap HTML content in a configuration object for dangerouslySetInnerHTML\n * @param {Object} props\n * @param {string} props.html\n * @param {Function} [props.transform]\n * @param {boolean} [props.sanitize = true]\n * @param {boolean} [props.sanitizeStyleTags = true]\n */\nconst useDangerousHTMLWrapper = (props) => {\n\n  const {\n    html,\n    transform = (html) => html,\n    sanitize = true,\n    sanitizeStyleTags = true\n  } = props;\n\n  const sanitizedHtml = useMemo(() => sanitize ? DOMPurify.sanitize(html, getDOMPurifyConfig(sanitizeStyleTags)) : html, [ html, sanitize, sanitizeStyleTags ]);\n  const transformedHtml = useMemo(() => transform(sanitizedHtml), [ sanitizedHtml, transform ]);\n\n  // Return the configuration object for dangerouslySetInnerHTML\n  return { __html: transformedHtml };\n};\n\nconst getDOMPurifyConfig = (sanitizeStyleTags) => {\n  return {\n    FORCE_BODY: true,\n    FORBID_TAGS: (sanitizeStyleTags ? [ 'style' ] : [])\n  };\n};\n\nexport { useDangerousHTMLWrapper };\n","import { get } from 'min-dash';\r\nimport { SECURITY_ATTRIBUTES_DEFINITIONS, SANDBOX_ATTRIBUTE } from '../../util/constants';\r\nimport { useMemo } from 'preact/hooks';\r\nimport { useDeepCompareMemoize } from './useDeepCompareMemoize';\r\n\r\n/**\r\n * A custom hook to build up security attributes from form configuration.\r\n *\r\n * @param {Object} security - The security configuration.\r\n * @returns {Array} - Returns a tuple with sandbox and allow attributes.\r\n */\r\nexport function useSecurityAttributesMap(security) {\r\n\r\n  const securityMemoized = useDeepCompareMemoize(security);\r\n\r\n  const sandbox = useMemo(() =>\r\n    SECURITY_ATTRIBUTES_DEFINITIONS\r\n      .filter(({ attribute }) => attribute === SANDBOX_ATTRIBUTE)\r\n      .filter(({ property }) => get(securityMemoized, [ property ], false))\r\n      .map(({ directive }) => directive)\r\n      .join(' ')\r\n  , [ securityMemoized ]);\r\n\r\n  const allow = useMemo(() =>\r\n    SECURITY_ATTRIBUTES_DEFINITIONS\r\n      .filter(({ attribute }) => attribute !== SANDBOX_ATTRIBUTE)\r\n      .filter(({ property }) => get(securityMemoized, [ property ], false))\r\n      .map(({ directive }) => directive)\r\n      .join('; ')\r\n  , [ securityMemoized ]);\r\n\r\n  return [ sandbox, allow ];\r\n}\r\n","import { useCallback, useMemo } from 'preact/hooks';\nimport { isObject } from 'min-dash';\n\n/**\n * This hook allows us to retrieve the label from a value in linear time by caching it in a map\n * @param {Array} options\n */\nexport function useGetLabelCorrelation(options) {\n\n  // This allows us to retrieve the label from a value in linear time\n  const labelMap = useMemo(() => Object.assign({}, ...options.map((o) => ({ [_getValueHash(o.value)]:  o.label }))), [ options ]);\n  return useCallback((value) => labelMap[_getValueHash(value)], [ labelMap ]);\n}\n\nconst _getValueHash = (value) => {\n  return isObject(value) ? JSON.stringify(value) : value;\n};","import { some } from 'min-dash';\nimport { useEffect } from 'preact/hooks';\n\n/**\n * Custom hook to scroll an element into view only when it is not visible within the viewport.\n *\n * @param {Object} targetRef - A ref pointing to the DOM element to scroll into view.\n * @param {Array} deps - An array of dependencies that trigger the effect.\n * @param {Array} flagRefs - An array of refs that are used as flags to control when to scroll.\n * @param {Object} [scrollOptions={}] - Options defining the behavior of the scrolling.\n * @param {String} [scrollOptions.align='center'] - The alignment of the element within the viewport.\n * @param {String} [scrollOptions.behavior='auto'] - The scrolling behavior.\n * @param {Number} [scrollOptions.offset=0] - An offset that is added to the scroll position.\n * @param {Boolean} [scrollOptions.scrollIfVisible=false] - Whether to scroll even if the element is visible.\n */\nexport function useScrollIntoView(targetRef, deps, scrollOptions = null, flagRefs = []) {\n  useEffect(() => {\n\n    // return early if flags are not raised, or component is not mounted\n    if (some(flagRefs, ref => !ref.current) || !targetRef.current) {\n      return;\n    }\n\n    for (let i = 0; i < flagRefs.length; i++) {\n      flagRefs[i].current = false;\n    }\n\n    const itemToBeScrolled = targetRef.current;\n    const scrollContainer = _getNearestScrollableAncestor(itemToBeScrolled);\n\n    if (!scrollContainer) {\n      return;\n    }\n\n    const itemRect = itemToBeScrolled.getBoundingClientRect();\n    const containerRect = scrollContainer.getBoundingClientRect();\n\n    // should scroll if visible or scrollIfVisible option is set\n    const shouldScroll = scrollOptions.scrollIfVisible || !(itemRect.top >= containerRect.top && itemRect.bottom <= containerRect.bottom);\n\n    if (!shouldScroll) {\n      return;\n    }\n\n    const {\n      align = 'center',\n      offset = 0,\n      behavior = 'auto'\n    } = scrollOptions;\n\n    const topOffset = _getTopOffset(itemToBeScrolled, scrollContainer, { align, offset });\n    scrollContainer.scroll({\n      top: topOffset,\n      behavior,\n    });\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, deps);\n}\n\n\n// helper //////////////////////\n\nfunction _getNearestScrollableAncestor(el) {\n  while (el) {\n    if (el.scrollHeight > el.clientHeight) {\n      return el;\n    }\n    el = el.parentElement;\n  }\n}\n\nfunction _getTopOffset(item, scrollContainer, options) {\n\n  const itemRect = item.getBoundingClientRect();\n  const containerRect = scrollContainer.getBoundingClientRect();\n\n  if (options.align === 'top') {\n    return itemRect.top - containerRect.top + scrollContainer.scrollTop - options.offset;\n  }\n  else if (options.align === 'bottom') {\n    return itemRect.bottom - containerRect.top - scrollContainer.clientHeight + scrollContainer.scrollTop + options.offset;\n  }\n  else if (options.align === 'center') {\n    return itemRect.top - containerRect.top - scrollContainer.clientHeight / 2 + scrollContainer.scrollTop + itemRect.height / 2 + options.offset;\n  }\n\n  return 0;\n}","import { useService } from './useService.js';\nimport { useMemo } from 'preact/hooks';\n\n/**\n * Returns the conditionally filtered data of a form reactively.\n * Memoised to minimize re-renders\n *\n * Warning: costly operation, use with care\n */\nexport function useFilteredFormData() {\n  const { initialData, data } = useService('form')._getState();\n  const conditionChecker = useService('conditionChecker', false);\n\n  return useMemo(() => {\n    const newData = conditionChecker ? conditionChecker.applyConditions(data, data) : data;\n    return { ...initialData, ...newData };\n  }, [ conditionChecker, data, initialData ]);\n\n}\n","import { useEffect } from 'preact/hooks';\n\nexport function useKeyDownAction(targetKey, action, listenerElement = window) {\n\n  function downHandler({ key }) {\n    if (key === targetKey) {\n      action();\n    }\n  }\n\n  useEffect(() => {\n    listenerElement.addEventListener('keydown', downHandler);\n\n    return () => {\n      listenerElement.removeEventListener('keydown', downHandler);\n    };\n  });\n}","import { buildExpressionContext } from '../../util/simple';\nimport { LocalExpressionContext } from '../context/LocalExpressionContext.js';\nimport { useService } from './useService.js';\nimport { useContext } from 'preact/hooks';\n\n/**\n * Retrieve readonly value of a form field, given it can be an\n * expression optionally or configured globally.\n *\n * @typedef { import('../../types').FormProperties } FormProperties\n *\n * @param {any} formField\n * @param {FormProperties} properties\n *\n * @returns {boolean}\n */\nexport function useReadonly(formField, properties = {}) {\n  const expressionLanguage = useService('expressionLanguage');\n  const conditionChecker = useService('conditionChecker', false);\n  const expressionContextInfo = useContext(LocalExpressionContext);\n\n  const { readonly } = formField;\n\n  if (properties.readOnly) {\n    return true;\n  }\n\n  if (expressionLanguage && expressionLanguage.isExpression(readonly)) {\n    return conditionChecker ? conditionChecker.check(readonly, buildExpressionContext(expressionContextInfo)) : false;\n  }\n\n  return readonly || false;\n}\n","import {\n  useEffect,\n  useRef\n} from 'preact/hooks';\n\n\nexport function usePrevious(value, defaultValue = null) {\n  const ref = useRef(defaultValue);\n\n  useEffect(() => ref.current = value, [ value ]);\n\n  return ref.current;\n}","import { useCallback, useRef } from 'preact/hooks';\nimport { useService } from './useService';\n\nexport function useFlushDebounce(func) {\n\n  const timeoutRef = useRef(null);\n  const lastArgsRef = useRef(null);\n\n  const config = useService('config', false);\n  const debounce = config && config.debounce;\n  const shouldDebounce = debounce !== false && debounce !== 0;\n  const delay = typeof debounce === 'number' ? debounce : 300;\n\n  const debounceFunc = useCallback((...args) => {\n\n    if (!shouldDebounce) {\n      func(...args);\n      return;\n    }\n\n    lastArgsRef.current = args;\n\n    if (timeoutRef.current) {\n      clearTimeout(timeoutRef.current);\n    }\n\n    timeoutRef.current = setTimeout(() => {\n      func(...lastArgsRef.current);\n      lastArgsRef.current = null;\n    }, delay);\n\n  }, [ func, delay, shouldDebounce ]);\n\n  const flushFunc = useCallback(() => {\n\n    if (timeoutRef.current) {\n      clearTimeout(timeoutRef.current);\n      if (lastArgsRef.current !== null) {\n        func(...lastArgsRef.current);\n        lastArgsRef.current = null;\n      }\n      timeoutRef.current = null;\n    }\n\n  }, [ func ]);\n\n  return [ debounceFunc, flushFunc ];\n}\n","import { useService } from './useService';\nimport { useContext, useMemo } from 'preact/hooks';\nimport { LocalExpressionContext } from '../context/LocalExpressionContext';\nimport { buildExpressionContext } from '../../util/simple';\n\n/**\n * Template a string reactively based on form data. If the string is not a template, it is returned as is.\n * Memoised to minimize re-renders\n *\n * @param {string} value\n * @param {Object} options\n * @param {boolean} [options.debug = false]\n * @param {boolean} [options.strict = false]\n * @param {Function} [options.sanitizer]\n * @param {Function} [options.buildDebugString]\n *\n */\nexport function useTemplateEvaluation(value, options = {}) {\n  const templating = useService('templating');\n  const expressionContextInfo = useContext(LocalExpressionContext);\n\n  return useMemo(() => {\n    if (templating && templating.isTemplate(value)) {\n      return templating.evaluate(value, buildExpressionContext(expressionContextInfo), options);\n    }\n    return value;\n  }, [ templating, value, expressionContextInfo, options ]);\n}\n","import { useTemplateEvaluation } from './useTemplateEvaluation';\nimport { useMemo } from 'preact/hooks';\n\n/**\n * Template a string reactively based on form data. If the string is not a template, it is returned as is.\n * If the string contains multiple lines, only the first line is returned.\n * Memoised to minimize re-renders\n *\n * @param {string} value\n * @param {Object} [options]\n * @param {boolean} [options.debug = false]\n * @param {boolean} [options.strict = false]\n * @param {Function} [options.buildDebugString]\n *\n */\nexport function useSingleLineTemplateEvaluation(value, options = {}) {\n  const evaluatedTemplate = useTemplateEvaluation(value, options);\n  return useMemo(() => evaluatedTemplate && evaluatedTemplate.split('\\n')[0], [ evaluatedTemplate ]);\n}","import { isNumber } from 'min-dash';\nimport { MINUTES_IN_DAY, TIME_SERIALISING_FORMATS } from '../../../util/constants/DatetimeConstants';\n\nexport const ENTER_KEYDOWN_EVENT = new KeyboardEvent('keydown', {\n  code: 'Enter',\n  key: 'Enter',\n  charCode: 13,\n  keyCode: 13,\n  bubbles: true\n});\n\nexport function focusRelevantFlatpickerDay(flatpickrInstance) {\n\n  if (!flatpickrInstance) return;\n\n  !flatpickrInstance.isOpen && flatpickrInstance.open();\n\n  const container = flatpickrInstance.calendarContainer;\n  const dayToFocus =\n    container.querySelector('.flatpickr-day.selected') ||\n    container.querySelector('.flatpickr-day.today') ||\n    container.querySelector('.flatpickr-day');\n\n  dayToFocus && dayToFocus.focus();\n}\n\nexport function formatTime(use24h, minutes) {\n\n  if (minutes === null) return null;\n\n  const wrappedMinutes = minutes % (24 * 60);\n\n  const minute = minutes % 60;\n  let hour = Math.floor(wrappedMinutes / 60);\n\n  if (use24h) {\n    return _getZeroPaddedString(hour) + ':' + _getZeroPaddedString(minute);\n  }\n\n  hour = (hour % 12 || 12);\n\n  const isPM = (wrappedMinutes >= 12 * 60);\n\n  return _getZeroPaddedString(hour) + ':' + _getZeroPaddedString(minute) + ' ' + (isPM ? 'PM' : 'AM');\n}\n\nexport function parseInputTime(stringTime) {\n\n  let workingString = stringTime.toLowerCase();\n  const is12h = workingString.includes('am') || workingString.includes('pm');\n\n  if (is12h) {\n    const isPM = workingString.includes('pm');\n    const digits = workingString.match(/\\d+/g);\n    const displayHour = parseInt(digits && digits[0]);\n    const minute = parseInt(digits && digits[1]) || 0;\n\n    const isValidDisplayHour = isNumber(displayHour) && (displayHour >= 1) && (displayHour <= 12);\n    const isValidMinute = (minute >= 0) && (minute <= 59);\n\n    if (!isValidDisplayHour || !isValidMinute) return null;\n\n    const hour = (displayHour % 12) + (isPM ? 12 : 0);\n\n    return hour * 60 + minute;\n  }\n  else {\n    const digits = workingString.match(/\\d+/g);\n    const hour = parseInt(digits && digits[0]);\n    const minute = parseInt(digits && digits[1]);\n\n    const isValidHour = isNumber(hour) && (hour >= 0) && (hour <= 23);\n    const isValidMinute = isNumber(minute) && (minute >= 0) && (minute <= 59);\n\n    if (!isValidHour || !isValidMinute) return null;\n\n    return hour * 60 + minute;\n  }\n}\n\nexport function serializeTime(minutes, offset, timeSerializingFormat) {\n\n  if (timeSerializingFormat === TIME_SERIALISING_FORMATS.UTC_NORMALIZED) {\n    const normalizedMinutes = (minutes + offset + MINUTES_IN_DAY) % MINUTES_IN_DAY;\n    return _getZeroPaddedString(Math.floor(normalizedMinutes / 60)) + ':' + _getZeroPaddedString(normalizedMinutes % 60) + 'Z';\n  }\n\n  const baseTime = _getZeroPaddedString(Math.floor(minutes / 60)) + ':' + _getZeroPaddedString(minutes % 60);\n  const addUTCOffset = timeSerializingFormat === TIME_SERIALISING_FORMATS.UTC_OFFSET;\n\n  return baseTime + (addUTCOffset ? formatTimezoneOffset(offset) : '');\n}\n\nexport function parseIsoTime(isoTimeString) {\n\n  if (!isoTimeString) return null;\n\n  const parseBasicMinutes = (timeString) => {\n    const timeSegments = timeString.split(':');\n    const hour = parseInt(timeSegments[0]);\n    const minute = timeSegments.length > 1 ? parseInt(timeSegments[1]) : 0;\n    if (isNaN(hour) || hour < 0 || hour > 24 || isNaN(minute) || minute < 0 || minute > 60) return null;\n    return hour * 60 + minute;\n  };\n\n  const localOffset = new Date().getTimezoneOffset();\n\n  // Parse normalized time\n  if (isoTimeString.includes('Z')) {\n    isoTimeString = isoTimeString.replace('Z', '');\n    const minutes = parseBasicMinutes(isoTimeString);\n    if (minutes === null) return null;\n    return (minutes - localOffset + MINUTES_IN_DAY) % MINUTES_IN_DAY;\n  }\n\n  // Parse offset positive time\n  else if (isoTimeString.includes('+')) {\n    const [ timeString, offsetString ] = isoTimeString.split('+');\n\n    const minutes = parseBasicMinutes(timeString);\n    let inboundOffset = parseBasicMinutes(offsetString);\n\n    if (minutes === null || inboundOffset === null) return null;\n\n    // The offset is flipped for consistency with javascript\n    inboundOffset = -inboundOffset;\n\n    return (minutes + inboundOffset - localOffset + MINUTES_IN_DAY) % MINUTES_IN_DAY;\n  }\n\n  // Parse offset negative time\n  else if (isoTimeString.includes('-')) {\n    const [ timeString, offsetString ] = isoTimeString.split('-');\n\n    const minutes = parseBasicMinutes(timeString);\n    let inboundOffset = parseBasicMinutes(offsetString);\n\n    if (minutes === null || inboundOffset === null) return null;\n\n    return (minutes + inboundOffset - localOffset + MINUTES_IN_DAY) % MINUTES_IN_DAY;\n  }\n\n  // Default to local parsing\n  else {\n    return parseBasicMinutes(isoTimeString);\n  }\n}\n\nexport function serializeDate(date) {\n  var d = new Date(date), month = '' + (d.getMonth() + 1), day = '' + d.getDate(), year = d.getFullYear();\n\n  if (month.length < 2)\n    month = '0' + month;\n  if (day.length < 2)\n    day = '0' + day;\n\n  return [ year, month, day ].join('-');\n}\n\n// this method is used to make the `new Date(value)` parsing behavior stricter\nexport function isDateTimeInputInformationSufficient(value) {\n\n  if (!value || typeof value !== 'string') return false;\n\n  const segments = value.split('T');\n  if (segments.length != 2) return false;\n\n  const dateNumbers = segments[0].split('-');\n  if (dateNumbers.length != 3) return false;\n\n  return true;\n\n}\n\n// this method checks if the date isn't a datetime, or a partial date\nexport function isDateInputInformationMatching(value) {\n\n  if (!value || typeof value !== 'string') return false;\n\n  if (value.includes('T')) return false;\n\n  const dateNumbers = value.split('-');\n  if (dateNumbers.length != 3) return false;\n\n  return true;\n}\n\nexport function serializeDateTime(date, time, timeSerializingFormat) {\n\n  const workingDate = new Date();\n  workingDate.setFullYear(date.getFullYear(), date.getMonth(), date.getDate());\n  workingDate.setHours(Math.floor(time / 60), time % 60, 0, 0);\n\n  if (timeSerializingFormat === TIME_SERIALISING_FORMATS.UTC_NORMALIZED) {\n\n    const timezoneOffsetMinutes = workingDate.getTimezoneOffset();\n    const dayOffset = (time + timezoneOffsetMinutes < 0) ? -1 : (((time + timezoneOffsetMinutes) > MINUTES_IN_DAY) ? 1 : 0);\n\n    // Apply the date rollover pre-emptively\n    workingDate.setHours(workingDate.getHours() + dayOffset * 24);\n  }\n\n  return serializeDate(workingDate) + 'T' + serializeTime(time, workingDate.getTimezoneOffset(), timeSerializingFormat);\n\n}\n\nexport function formatTimezoneOffset(minutes) {\n  return _getSignedPaddedHours(minutes) + ':' + _getZeroPaddedString(Math.abs(minutes % 60));\n}\n\nexport function isInvalidDateString(value) {\n  return isNaN(new Date(Date.parse(value)).getTime());\n}\n\nfunction _getSignedPaddedHours(minutes) {\n  if (minutes > 0) {\n    return '-' + _getZeroPaddedString(Math.floor(minutes / 60));\n  }\n  else {\n    return '+' + _getZeroPaddedString(Math.floor((0 - minutes) / 60));\n  }\n}\n\nfunction _getZeroPaddedString(time) {\n  return time.toString().padStart(2, '0');\n}","import isEqual from 'lodash/isEqual';\nimport { DATETIME_SUBTYPES } from '../../../util/constants/DatetimeConstants';\nimport { isDateInputInformationMatching, isDateTimeInputInformationSufficient, isInvalidDateString, parseIsoTime } from './dateTimeUtil';\nimport { getSimpleOptionsData, normalizeOptionsData } from './optionsUtil';\n\nconst ALLOWED_IMAGE_SRC_PATTERN = /^(https?|data):.*/i; // eslint-disable-line no-useless-escape\nconst ALLOWED_IFRAME_SRC_PATTERN = /^(https):\\/\\/*/i; // eslint-disable-line no-useless-escape\n\nexport function sanitizeDateTimePickerValue(options) {\n  const {\n    formField,\n    value\n  } = options;\n\n  const { subtype } = formField;\n\n  if (typeof value !== 'string') return null;\n\n  if (subtype === DATETIME_SUBTYPES.DATE && (isInvalidDateString(value) || !isDateInputInformationMatching(value))) return null;\n  if (subtype === DATETIME_SUBTYPES.TIME && parseIsoTime(value) === null) return null;\n  if (subtype === DATETIME_SUBTYPES.DATETIME && (isInvalidDateString(value) || !isDateTimeInputInformationSufficient(value))) return null;\n\n  return value;\n}\n\nexport function hasEqualValue(value, array) {\n\n  if (!Array.isArray(array)) {\n    return false;\n  }\n\n  return array.some(element => isEqual(value, element));\n}\n\nexport function sanitizeSingleSelectValue(options) {\n  const {\n    formField,\n    data,\n    value\n  } = options;\n\n  const {\n    valuesExpression: optionsExpression\n  } = formField;\n\n  try {\n\n    // if options are expression evaluated, we don't need to sanitize the value against the options\n    // and defer to the field's internal validation\n    if (optionsExpression) {\n      return value;\n    }\n\n    const validValues = normalizeOptionsData(getSimpleOptionsData(formField, data)).map(v => v.value);\n    return hasEqualValue(value, validValues) ? value : null;\n  } catch (error) {\n\n    // use default value in case of formatting error\n    // TODO(@Skaiir): log a warning when this happens - https://github.com/bpmn-io/form-js/issues/289\n    return null;\n  }\n}\n\nexport function sanitizeMultiSelectValue(options) {\n  const {\n    formField,\n    data,\n    value\n  } = options;\n\n  const {\n    valuesExpression: optionsExpression\n  } = formField;\n\n  try {\n\n    // if options are expression evaluated, we don't need to sanitize the values against the options\n    // and defer to the field's internal validation\n    if (optionsExpression) {\n      return value;\n    }\n\n    const validValues = normalizeOptionsData(getSimpleOptionsData(formField, data)).map(v => v.value);\n    return value.filter(v => hasEqualValue(v, validValues));\n  } catch (error) {\n\n    // use default value in case of formatting error\n    // TODO(@Skaiir): log a warning when this happens - https://github.com/bpmn-io/form-js/issues/289\n    return [];\n  }\n}\n\n/**\n * Sanitizes an image source to ensure we only allow for data URI and links\n * that start with http(s).\n *\n * Note: Most browsers anyway do not support script execution in <img> elements.\n *\n * @param {string} src\n * @returns {string}\n */\nexport function sanitizeImageSource(src) {\n  const valid = ALLOWED_IMAGE_SRC_PATTERN.test(src);\n\n  return valid ? src : '';\n}\n\n/**\n * Sanitizes an iframe source to ensure we only allow for links\n * that start with http(s).\n *\n * @param {string} src\n * @returns {string}\n */\nexport function sanitizeIFrameSource(src) {\n  const valid = ALLOWED_IFRAME_SRC_PATTERN.test(src);\n\n  return valid ? src : '';\n}\n\n/**\n * Escapes HTML and returns pure text.\n * @param {string} html\n * @returns {string}\n */\nexport function escapeHTML(html) {\n  const escapeMap = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#039;',\n    '{': '&#123;',\n    '}': '&#125;',\n    ':': '&#58;',\n    ';': '&#59;'\n  };\n\n  return html.replace(/[&<>\"'{};:]/g, match => escapeMap[match]);\n}","import { useEffect } from 'preact/hooks';\nimport { LOAD_STATES } from './useOptionsAsync';\nimport { hasEqualValue } from '../components/util/sanitizerUtil';\n\nexport function useCleanupSingleSelectValue(props) {\n\n  const {\n    field,\n    options,\n    loadState,\n    onChange,\n    value\n  } = props;\n\n  // Ensures that the value is always one of the possible options\n  useEffect(() => {\n\n    if (loadState !== LOAD_STATES.LOADED) {\n      return;\n    }\n\n    const optionValues = options.map(o => o.value);\n    const hasValueNotInOptions = value && !hasEqualValue(value, optionValues);\n\n    if (hasValueNotInOptions) {\n      onChange({\n        field,\n        value: null\n      });\n    }\n\n  }, [ field, options, onChange, value, loadState ]);\n\n}","import { useEffect } from 'preact/hooks';\nimport { LOAD_STATES } from './useOptionsAsync';\nimport { hasEqualValue } from '../components/util/sanitizerUtil';\nimport { useDeepCompareMemoize } from './useDeepCompareMemoize';\n\nexport function useCleanupMultiSelectValue(props) {\n\n  const {\n    field,\n    options,\n    loadState,\n    onChange,\n    values\n  } = props;\n\n  const memoizedValues = useDeepCompareMemoize(values || []);\n\n  // ensures that the values are always a subset of the possible options\n  useEffect(() => {\n\n    if (loadState !== LOAD_STATES.LOADED) {\n      return;\n    }\n\n    const optionValues = options.map(o => o.value);\n    const hasValuesNotInOptions = memoizedValues.some(v => !hasEqualValue(v, optionValues));\n\n    if (hasValuesNotInOptions) {\n      onChange({\n        field,\n        value: memoizedValues.filter(v => hasEqualValue(v, optionValues))\n      });\n    }\n\n  }, [ field, options, onChange, memoizedValues, loadState ]);\n\n}","import { useSingleLineTemplateEvaluation } from '../hooks';\n\n\nexport function Description(props) {\n  const { description, id } = props;\n\n  const evaluatedDescription = useSingleLineTemplateEvaluation(description || '', { debug: true });\n\n  if (!evaluatedDescription) {\n    return null;\n  }\n\n  return <div id={ id } class=\"fjs-form-field-description\">{ evaluatedDescription }</div>;\n}","export function Errors(props) {\n  const { errors, id } = props;\n\n  if (!errors.length) {\n    return null;\n  }\n\n  return <div class=\"fjs-form-field-error\" aria-live=\"polite\" id={ id }>\n    <ul>\n      {\n        errors.map(error => {\n          return <li>{ error }</li>;\n        })\n      }\n    </ul>\n  </div>;\n}","import classNames from 'classnames';\n\nimport { useSingleLineTemplateEvaluation } from '../hooks';\n\n\n/**\n * @typedef Props\n * @property {string|undefined} [id]\n * @property {string|undefined} [htmlFor]\n * @property {string|undefined} label\n * @property {string} [class]\n * @property {boolean} [collapseOnEmpty]\n * @property {boolean} [required]\n * @property {import(\"preact\").VNode} [children]\n *\n * @param {Props} props\n * @returns {import(\"preact\").JSX.Element}\n */\nexport function Label(props) {\n  const {\n    id,\n    htmlFor,\n    label,\n    collapseOnEmpty = true,\n    required = false\n  } = props;\n\n  const evaluatedLabel = useSingleLineTemplateEvaluation(label || '', { debug: true });\n\n  return (\n    <label id={ id } for={ htmlFor } class={ classNames('fjs-form-field-label', { 'fjs-incollapsible-label': !collapseOnEmpty }, props['class']) }>\n      { props.children }\n      { evaluatedLabel }\n      {\n        required && <span class=\"fjs-asterix\" aria-hidden>*</span>\n      }\n    </label>\n  );\n}","import { Description } from '../Description';\nimport { Errors } from '../Errors';\nimport { Label } from '../Label';\n\nimport {\n  formFieldClasses\n} from '../Util';\n\nimport classNames from 'classnames';\n\nconst type = 'checkbox';\n\nexport function Checkbox(props) {\n  const {\n    disabled,\n    errors = [],\n    domId,\n    onBlur,\n    onFocus,\n    field,\n    readonly,\n    value = false\n  } = props;\n\n  const {\n    description,\n    label,\n    validate = {}\n  } = field;\n\n  const { required } = validate;\n\n  const onChange = ({ target }) => {\n    props.onChange({\n      field,\n      value: target.checked\n    });\n  };\n\n  const descriptionId = `${domId}-description`;\n  const errorMessageId = `${domId}-error-message`;\n\n  return <div class={ classNames(formFieldClasses(type, { errors, disabled, readonly }), { 'fjs-checked': value }) }>\n    <Label\n      htmlFor={ domId }\n      label={ label }\n      required={ required }>\n      <input\n        checked={ value }\n        class=\"fjs-input\"\n        disabled={ disabled }\n        readOnly={ readonly }\n        id={ domId }\n        type=\"checkbox\"\n        onChange={ onChange }\n        onBlur={ () => onBlur && onBlur() }\n        onFocus={ () => onFocus && onFocus() }\n        required={ required }\n        aria-invalid={ errors.length > 0 }\n        aria-describedby={ [ descriptionId, errorMessageId ].join(' ') } />\n    </Label>\n    <Description id={ descriptionId } description={ description } />\n    <Errors id={ errorMessageId } errors={ errors } />\n  </div>;\n}\n\nCheckbox.config = {\n  type,\n  keyed: true,\n  label: 'Checkbox',\n  group: 'selection',\n  emptyValue: false,\n  sanitizeValue: ({ value }) => value === true,\n  create: (options = {}) => ({\n    ...options\n  })\n};\n","import { useRef } from 'preact/hooks';\nimport { useOptionsAsync, LOAD_STATES } from '../../hooks/useOptionsAsync';\nimport { useCleanupMultiSelectValue } from '../../hooks/useCleanupMultiSelectValue';\nimport classNames from 'classnames';\nimport isEqual from 'lodash/isEqual';\n\nimport { Description } from '../Description';\nimport { Errors } from '../Errors';\nimport { Label } from '../Label';\n\nimport { sanitizeMultiSelectValue, hasEqualValue } from '../util/sanitizerUtil';\n\nimport { createEmptyOptions } from '../util/optionsUtil';\n\nimport {\n  formFieldClasses\n} from '../Util';\n\nconst type = 'checklist';\n\n\nexport function Checklist(props) {\n  const {\n    disabled,\n    errors = [],\n    domId,\n    onBlur,\n    onFocus,\n    field,\n    readonly,\n    value: values = [],\n  } = props;\n\n  const {\n    description,\n    label,\n    validate = {}\n  } = field;\n\n  const outerDivRef = useRef();\n\n  const { required } = validate;\n\n  const toggleCheckbox = (toggledValue) => {\n\n    const newValues = hasEqualValue(toggledValue, values)\n      ? values.filter(value => !isEqual(value, toggledValue))\n      : [ ...values, toggledValue ];\n\n    props.onChange({\n      field,\n      value: newValues,\n    });\n  };\n\n  const onCheckboxBlur = (e) => {\n\n    if (outerDivRef.current.contains(e.relatedTarget)) {\n      return;\n    }\n\n    onBlur && onBlur();\n  };\n\n  const onCheckboxFocus = (e) => {\n\n    if (outerDivRef.current.contains(e.relatedTarget)) {\n      return;\n    }\n\n    onFocus && onFocus();\n  };\n\n  const {\n    loadState,\n    options\n  } = useOptionsAsync(field);\n\n  useCleanupMultiSelectValue({\n    field,\n    loadState,\n    options,\n    values,\n    onChange: props.onChange\n  });\n\n  const descriptionId = `${domId}-description`;\n  const errorMessageId = `${domId}-error-message`;\n\n  return <div class={ classNames(formFieldClasses(type, { errors, disabled, readonly })) } ref={ outerDivRef }>\n    <Label\n      label={ label }\n      required={ required } />\n    {\n      loadState == LOAD_STATES.LOADED && options.map((o, index) => {\n\n        const itemDomId = `${domId}-${index}`;\n        const isChecked = hasEqualValue(o.value, values);\n\n        return (\n          <Label\n            htmlFor={ itemDomId }\n            label={ o.label }\n            class={ classNames({\n              'fjs-checked': isChecked\n            }) }\n            required={ false }>\n            <input\n              checked={ isChecked }\n              class=\"fjs-input\"\n              disabled={ disabled }\n              readOnly={ readonly }\n              id={ itemDomId }\n              type=\"checkbox\"\n              onClick={ () => toggleCheckbox(o.value) }\n              onBlur={ onCheckboxBlur }\n              onFocus={ onCheckboxFocus }\n              required={ required }\n              aria-invalid={ errors.length > 0 }\n              aria-describedby={ [ descriptionId, errorMessageId ].join(' ') } />\n          </Label>\n        );\n      })\n    }\n    <Description id={ descriptionId } description={ description } />\n    <Errors id={ errorMessageId } errors={ errors } />\n  </div>;\n}\n\nChecklist.config = {\n  type,\n  keyed: true,\n  label: 'Checkbox group',\n  group: 'selection',\n  emptyValue: [],\n  sanitizeValue: sanitizeMultiSelectValue,\n  create: createEmptyOptions\n};\n","import { useCallback, useContext, useEffect, useMemo, useState } from 'preact/hooks';\n\nimport { get } from 'min-dash';\n\nimport { FormContext, FormRenderContext } from '../context';\n\nimport {\n  useCondition,\n  useReadonly,\n  useService\n} from '../hooks';\n\nimport { gridColumnClasses, prefixId } from './Util';\n\nconst noop = () => false;\n\n\nexport function FormField(props) {\n  const {\n    field,\n    indexes,\n    onChange\n  } = props;\n\n  const formFields = useService('formFields'),\n        viewerCommands = useService('viewerCommands', false),\n        pathRegistry = useService('pathRegistry'),\n        eventBus = useService('eventBus'),\n        form = useService('form');\n\n  const {\n    initialData,\n    data,\n    errors,\n    properties\n  } = form._getState();\n\n  const {\n    Element,\n    Hidden,\n    Column\n  } = useContext(FormRenderContext);\n\n  const { formId } = useContext(FormContext);\n\n  // track whether we should trigger initial validation on certain actions, e.g. field blur\n  // disabled straight away, if viewerCommands are not available\n  const [ initialValidationTrigger, setInitialValidationTrigger ] = useState(!!viewerCommands);\n\n  const FormFieldComponent = formFields.get(field.type);\n\n  if (!FormFieldComponent) {\n    throw new Error(`cannot render field <${field.type}>`);\n  }\n\n  const valuePath = useMemo(() => pathRegistry.getValuePath(field, { indexes }), [ field, indexes, pathRegistry ]);\n\n  const initialValue = useMemo(() => get(initialData, valuePath), [ initialData, valuePath ]);\n\n  const readonly = useReadonly(field, properties);\n\n  const value = get(data, valuePath);\n\n  // add precedence: global readonly > form field disabled\n  const disabled = !properties.readOnly && (\n    properties.disabled || field.disabled || false\n  );\n\n  // ensures the initial validation behavior can be re-triggered upon form reset\n  useEffect(() => {\n\n    if (!viewerCommands) {\n      return;\n    }\n\n    const resetValidation = () => {\n      setInitialValidationTrigger(true);\n    };\n\n    eventBus.on('import.done', resetValidation);\n    eventBus.on('reset', resetValidation);\n\n    return () => {\n      eventBus.off('import.done', resetValidation);\n      eventBus.off('reset', resetValidation);\n    };\n\n  }, [ eventBus, viewerCommands ]);\n\n  useEffect(() => {\n\n    if (initialValidationTrigger && initialValue) {\n      setInitialValidationTrigger(false);\n      viewerCommands.updateFieldValidation(field, initialValue, indexes);\n    }\n\n  }, [ viewerCommands, field, initialValue, initialValidationTrigger, indexes ]);\n\n  const onBlur = useCallback(() => {\n\n    const value = get(data, valuePath);\n\n    if (initialValidationTrigger) {\n      setInitialValidationTrigger(false);\n      viewerCommands.updateFieldValidation(field, value, indexes);\n    }\n\n    eventBus.fire('formField.blur', { formField: field });\n\n  }, [ eventBus, field, indexes, viewerCommands, initialValidationTrigger, data, valuePath ]);\n\n  const onFocus = useCallback(() => {\n    eventBus.fire('formField.focus', { formField: field });\n  }, [ eventBus, field ]);\n\n  const hidden = useCondition(field.conditional && field.conditional.hide || null);\n\n  const onChangeIndexed = useCallback((update) => {\n\n    // any data change will trigger validation\n    setInitialValidationTrigger(false);\n\n    // add indexes of the keyed field to the update, if any\n    onChange(FormFieldComponent.config.keyed ? { ...update, indexes } : update);\n  }, [ onChange, FormFieldComponent.config.keyed, indexes ]);\n\n  if (hidden) {\n    return <Hidden field={ field } />;\n  }\n\n  const domId = `${prefixId(field.id, formId, indexes)}`;\n  const fieldErrors = get(errors, [ field.id, ...Object.values(indexes || {}) ]) || [];\n\n  return (\n    <Column field={ field } class={ gridColumnClasses(field) }>\n      <Element class=\"fjs-element\" field={ field }>\n        <FormFieldComponent\n          { ...props }\n          disabled={ disabled }\n          errors={ fieldErrors }\n          domId={ domId }\n          onChange={ disabled || readonly ? noop : onChangeIndexed }\n          onBlur={ disabled || readonly ? noop : onBlur }\n          onFocus={ disabled || readonly ? noop : onFocus }\n          readonly={ readonly }\n          value={ value } />\n      </Element>\n    </Column>\n  );\n}\n","import { useContext, useState } from 'preact/hooks';\n\nimport { useService } from '../../../hooks/useService';\n\nimport { FormField } from '../../FormField';\n\nimport { FormRenderContext } from '../../../context';\n\nexport function ChildrenRenderer(props) {\n\n  const {\n    Children\n  } = useContext(FormRenderContext);\n\n  const { field, Empty } = props;\n\n  const { id } = field;\n\n  const repeatRenderManager = useService('repeatRenderManager', false);\n\n  const isRepeating = repeatRenderManager && repeatRenderManager.isFieldRepeating(id);\n\n  const Repeater = repeatRenderManager.Repeater;\n  const RepeatFooter = repeatRenderManager.RepeatFooter;\n\n  return (\n    isRepeating\n      ? <RepeatChildrenRenderer { ...props } { ...{ ChildrenRoot: Children, Empty, Repeater, RepeatFooter, repeatRenderManager } } />\n      : <SimpleChildrenRenderer { ...props } { ...{ ChildrenRoot: Children, Empty } } />\n  );\n}\n\nfunction SimpleChildrenRenderer(props) {\n\n  const {\n    ChildrenRoot,\n    Empty,\n    field\n  } = props;\n\n  const { components = [] } = field;\n\n  const isEmpty = !components.length;\n\n  return (\n    <ChildrenRoot class=\"fjs-vertical-layout fjs-children cds--grid cds--grid--condensed\" field={ field }>\n      <RowsRenderer { ...props } />\n      { isEmpty ? <Empty field={ field } /> : null }\n    </ChildrenRoot>\n  );\n}\n\nfunction RepeatChildrenRenderer(props) {\n\n  const {\n    ChildrenRoot,\n    repeatRenderManager,\n    Empty,\n    field,\n    ...restProps\n  } = props;\n\n  const { components = [] } = field;\n\n  const useSharedState = useState({ isCollapsed: true });\n\n  const Repeater = repeatRenderManager.Repeater;\n  const RepeatFooter = repeatRenderManager.RepeatFooter;\n\n  return <>\n    <ChildrenRoot class=\"fjs-vertical-layout fjs-children cds--grid cds--grid--condensed\" field={ field }>\n      { Repeater ? <Repeater { ...{ ...restProps, useSharedState, field, RowsRenderer } } /> : <RowsRenderer { ...{ ...restProps, field } } /> }\n      { !components.length ? <Empty field={ field } /> : null }\n    </ChildrenRoot>\n    { RepeatFooter ? <RepeatFooter { ...{ ...restProps, useSharedState, field } } /> : null }\n  </>;\n}\n\nfunction RowsRenderer(props) {\n\n  const { field, indexes } = props;\n  const { id: parentId, verticalAlignment = 'start' } = field;\n\n  const formLayouter = useService('formLayouter');\n  const formFieldRegistry = useService('formFieldRegistry');\n  const rows = formLayouter.getRows(parentId);\n\n  const {\n    Row\n  } = useContext(FormRenderContext);\n\n  return <> {\n    rows.map(row => {\n      const {\n        components = []\n      } = row;\n\n      if (!components.length) {\n        return null;\n      }\n\n      return (\n        <Row row={ row } class=\"fjs-layout-row cds--row\" style={ { alignItems: verticalAlignment } }>\n          {\n            components.map(childId => {\n\n              const childField = formFieldRegistry.get(childId);\n\n              if (!childField) {\n                return null;\n              }\n\n              return (\n                <FormField\n                  { ...props }\n                  key={ childId }\n                  field={ childField }\n                  indexes={ indexes } />\n              );\n            })\n          }\n        </Row>\n      );\n    })\n  } </>;\n}\n","import { useContext } from 'preact/hooks';\nimport { FormRenderContext } from '../../context';\nimport { ChildrenRenderer } from './parts/ChildrenRenderer';\n\nexport function Default(props) {\n\n  const {\n    Empty,\n  } = useContext(FormRenderContext);\n\n  const fullProps = { ...props, Empty };\n\n  return <ChildrenRenderer { ...fullProps } />;\n}\n\nDefault.config = {\n  type: 'default',\n  keyed: false,\n  label: null,\n  group: null,\n  create: (options = {}) => ({\n    components: [],\n    ...options\n  })\n};\n","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"15\" fill=\"none\" viewBox=\"0 0 28 30\"><path fill=\"currentColor\" fill-rule=\"evenodd\" d=\"M19 2H9V0H7v2H2a2 2 0 0 0-2 2v24a2 2 0 0 0 2 2h24a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2h-5V0h-2v2ZM7 7V4H2v5h24V4h-5v3h-2V4H9v3H7Zm-5 4v17h24V11H2Z\" clip-rule=\"evenodd\"/></svg>","/**\n * Returns date format for the provided locale.\n * If the locale is not provided, uses the browser's locale.\n *\n * @param {string} [locale] - The locale to get date format for.\n * @returns {string} The date format for the locale.\n */\nexport function getLocaleDateFormat(locale = 'default') {\n  const parts = new Intl.DateTimeFormat(locale).formatToParts(new Date(Date.UTC(2020, 5, 5)));\n  return parts.map(part => {\n    const len = part.value.length;\n    switch (part.type) {\n    case 'day': return 'd'.repeat(len);\n    case 'month': return 'M'.repeat(len);\n    case 'year': return 'y'.repeat(len);\n    default: return part.value;\n    }\n  }).join('');\n}\n\n/**\n * Returns readable date format for the provided locale.\n * If the locale is not provided, uses the browser's locale.\n *\n * @param {string} [locale] - The locale to get readable date format for.\n * @returns {string} The readable date format for the locale.\n */\nexport function getLocaleReadableDateFormat(locale) {\n  let format = getLocaleDateFormat(locale).toLowerCase();\n\n  // Ensure month is in 'mm' format\n  if (!format.includes('mm')) {\n    format = format.replace('m', 'mm');\n  }\n\n  // Ensure day is in 'dd' format\n  if (!format.includes('dd')) {\n    format = format.replace('d', 'dd');\n  }\n\n  return format;\n}\n\n/**\n * Returns flatpickr config for the provided locale.\n * If the locale is not provided, uses the browser's locale.\n *\n * @param {string} [locale] - The locale to get flatpickr config for.\n * @returns {object} The flatpickr config for the locale.\n */\nexport function getLocaleDateFlatpickrConfig(locale) {\n  return flatpickerizeDateFormat(getLocaleDateFormat(locale));\n}\n\nfunction flatpickerizeDateFormat(dateFormat) {\n\n  const useLeadingZero = {\n    day: dateFormat.includes('dd'),\n    month: dateFormat.includes('MM'),\n    year: dateFormat.includes('yyyy')\n  };\n\n  dateFormat = useLeadingZero.day ? dateFormat.replace('dd', 'd') : dateFormat.replace('d', 'j');\n  dateFormat = useLeadingZero.month ? dateFormat.replace('MM', 'm') : dateFormat.replace('M', 'n');\n  dateFormat = useLeadingZero.year ? dateFormat.replace('yyyy', 'Y') : dateFormat.replace('yy', 'y');\n\n  return dateFormat;\n}\n","import classNames from 'classnames';\nimport { isString } from 'min-dash';\n\nexport function InputAdorner(props) {\n\n  const {\n    pre,\n    post,\n    rootRef,\n    inputRef,\n    children,\n    disabled,\n    readonly,\n    hasErrors\n  } = props;\n\n  const onAdornmentClick = () => inputRef && inputRef.current && inputRef.current.focus();\n\n  return <div class={ classNames('fjs-input-group', { 'fjs-disabled': disabled, 'fjs-readonly': readonly }, { 'hasErrors': hasErrors }) } ref={ rootRef }>\n    { pre && <span class=\"fjs-input-adornment border-right border-radius-left\" onClick={ onAdornmentClick }> { isString(pre) ? <span class=\"fjs-input-adornment-text\">{ pre }</span> : pre } </span> }\n    { children }\n    { post && <span class=\"fjs-input-adornment border-left border-radius-right\" onClick={ onAdornmentClick }> { isString(post) ? <span class=\"fjs-input-adornment-text\">{ post }</span> : post } </span> }\n  </div>;\n\n}","import flatpickr from 'flatpickr';\nimport CalendarIcon from '../icons/Calendar.svg';\n\nimport { ENTER_KEYDOWN_EVENT, focusRelevantFlatpickerDay } from '../../util/dateTimeUtil';\nimport { getLocaleReadableDateFormat, getLocaleDateFlatpickrConfig } from '../../util/localisationUtil';\nimport { useCallback, useEffect, useRef, useState } from 'preact/hooks';\nimport { useDeepCompareMemoize } from '../../../hooks';\n\nimport { InputAdorner } from './InputAdorner';\nimport { Label } from '../../Label';\n\nexport function Datepicker(props) {\n\n  const {\n    label,\n    domId,\n    collapseLabelOnEmpty,\n    onDateTimeBlur,\n    onDateTimeFocus,\n    required,\n    disabled,\n    disallowPassedDates,\n    date: dateObject,\n    readonly,\n    setDate\n  } = props;\n\n  const dateInputRef = useRef();\n  const focusScopeRef = useRef();\n\n  const [ flatpickrInstance, setFlatpickrInstance ] = useState(null);\n  const [ isInputDirty, setIsInputDirty ] = useState(false);\n  const [ forceFocusCalendar, setForceFocusCalendar ] = useState(false);\n\n  // ensures we render based on date value instead of reference\n  const date = useDeepCompareMemoize(dateObject);\n\n  // shorts the date value back to the source\n  useEffect(() => {\n\n    if (!flatpickrInstance || !flatpickrInstance.config) return;\n\n    flatpickrInstance.setDate(date, true);\n    setIsInputDirty(false);\n\n  }, [ flatpickrInstance, date ]);\n\n  useEffect(() => {\n\n    if (!forceFocusCalendar) return;\n\n    focusRelevantFlatpickerDay(flatpickrInstance);\n    setForceFocusCalendar(false);\n\n  }, [ flatpickrInstance, forceFocusCalendar ]);\n\n  // setup flatpickr instance\n  useEffect(() => {\n\n    let config = {\n      allowInput: true,\n      dateFormat: getLocaleDateFlatpickrConfig(),\n      static: true,\n      clickOpens: false,\n\n      // TODO: support dates prior to 1900 (https://github.com/bpmn-io/form-js/issues/533)\n      minDate: disallowPassedDates ? 'today' : '01/01/1900',\n      errorHandler: () => { /* do nothing, we expect the values to sometimes be erronous and we don't want warnings polluting the console */ }\n    };\n\n    const instance = flatpickr(dateInputRef.current, config);\n\n    setFlatpickrInstance(instance);\n\n    const onCalendarFocusOut = (e) => {\n      if (!instance.calendarContainer.contains(e.relatedTarget) && e.relatedTarget != dateInputRef.current) {\n        instance.close();\n      }\n    };\n\n    // remove dirty tag to have mouse day selection prioritize input blur\n    const onCalendarMouseDown = (e) => {\n      if (e.target.classList.contains('flatpickr-day')) {\n        setIsInputDirty(false);\n      }\n    };\n\n    // when the dropdown of the datepickr opens, we register a few event handlers to re-implement some of the\n    // flatpicker logic that was lost when setting allowInput to true\n    instance.config.onOpen = [\n      () => instance.calendarContainer.addEventListener('focusout', onCalendarFocusOut),\n      () => instance.calendarContainer.addEventListener('mousedown', onCalendarMouseDown),\n    ];\n\n    instance.config.onClose = [\n      () => instance.calendarContainer.removeEventListener('focusout', onCalendarFocusOut),\n      () => instance.calendarContainer.removeEventListener('mousedown', onCalendarMouseDown),\n    ];\n\n  }, [ disallowPassedDates ]);\n\n  // onChange is updated dynamically, so not to re-render the flatpicker every time it changes\n  useEffect(() => {\n\n    if (!flatpickrInstance || !flatpickrInstance.config) return;\n\n    flatpickrInstance.config.onChange = [ (date) => setDate(new Date(date)), () => setIsInputDirty(false) ];\n\n  }, [ flatpickrInstance, setDate ]);\n\n  const onInputKeyDown = useCallback(\n    (e) => {\n\n      if (!flatpickrInstance) return;\n\n      if (e.code === 'Escape') {\n        flatpickrInstance.close();\n      }\n\n      if (e.code === 'ArrowDown') {\n\n        if (isInputDirty) {\n\n          // trigger an enter keypress to submit the new input, then focus calendar day on the next render cycle\n          dateInputRef.current.dispatchEvent(ENTER_KEYDOWN_EVENT);\n          setIsInputDirty(false);\n          setForceFocusCalendar(true);\n        }\n        else {\n\n          // focus calendar day immediately\n          focusRelevantFlatpickerDay(flatpickrInstance);\n        }\n\n        e.preventDefault();\n      }\n\n      if (e.code === 'Enter') {\n        setIsInputDirty(false);\n      }\n    },\n    [ flatpickrInstance, isInputDirty ],\n  );\n\n  const onInputFocus = useCallback(\n    (e) => {\n\n      if (!flatpickrInstance || focusScopeRef.current.contains(e.relatedTarget) || readonly) return;\n      flatpickrInstance.open();\n      onDateTimeFocus(e);\n\n    }, [ flatpickrInstance, readonly, onDateTimeFocus ]\n  );\n\n  // simulate an enter press on blur to make sure the date value is submitted in all scenarios\n  const onInputBlur = useCallback(\n    (e) => {\n\n      const isFalseBlur = e.relatedTarget && e.relatedTarget.classList.contains('flatpickr-day');\n      if (isFalseBlur) return;\n      if (isInputDirty) {\n        dateInputRef.current.dispatchEvent(ENTER_KEYDOWN_EVENT);\n        setIsInputDirty(false);\n      }\n\n      onDateTimeBlur(e);\n\n    }, [ isInputDirty, onDateTimeBlur ]\n  );\n\n  return <div class=\"fjs-datetime-subsection\">\n    <Label\n      htmlFor={ domId }\n      label={ label }\n      collapseOnEmpty={ collapseLabelOnEmpty }\n      required={ required } />\n    <InputAdorner\n      pre={ <CalendarIcon /> }\n      disabled={ disabled }\n      readonly={ readonly }\n      rootRef={ focusScopeRef }\n      inputRef={ dateInputRef }>\n      <div class=\"fjs-datepicker\" style={ { width: '100%' } }>\n        <input ref={ dateInputRef }\n          type=\"text\"\n          id={ domId }\n          class=\"fjs-input\"\n          disabled={ disabled }\n          readOnly={ readonly }\n          placeholder={ getLocaleReadableDateFormat() }\n          autoComplete=\"off\"\n          onFocus={ onInputFocus }\n          onBlur={ onInputBlur }\n          onKeyDown={ onInputKeyDown }\n          onMouseDown={ () => !flatpickrInstance.isOpen && !readonly && flatpickrInstance.open() }\n          onInput={ () => setIsInputDirty(true) }\n          data-input\n          aria-describedby={ props['aria-describedby'] } />\n      </div>\n    </InputAdorner>\n  </div>\n  ;\n}\n","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"none\" viewBox=\"0 0 28 29\"><path fill=\"currentColor\" d=\"M13 14.41 18.59 20 20 18.59l-5-5.01V5h-2v9.41Z\"/><path fill=\"currentColor\" fill-rule=\"evenodd\" d=\"M6.222 25.64A14 14 0 1 0 21.778 2.36 14 14 0 0 0 6.222 25.64ZM7.333 4.023a12 12 0 1 1 13.334 19.955A12 12 0 0 1 7.333 4.022Z\" clip-rule=\"evenodd\"/></svg>","import classNames from 'classnames';\nimport { useState, useEffect, useCallback, useRef, useMemo } from 'preact/hooks';\nimport { useKeyDownAction } from '../../../hooks/useKeyDownAction';\n\nconst DEFAULT_LABEL_GETTER = (value) => value;\nconst NOOP = () => {};\n\nexport function DropdownList(props) {\n\n  const {\n    listenerElement = window,\n    values = [],\n    getLabel = DEFAULT_LABEL_GETTER,\n    onValueSelected = NOOP,\n    height = 235,\n    emptyListMessage = 'No results',\n    initialFocusIndex = 0\n  } = props;\n\n  const [ mouseControl, setMouseControl ] = useState(false);\n  const [ focusedValueIndex, setFocusedValueIndex ] = useState(initialFocusIndex);\n  const [ smoothScrolling, setSmoothScrolling ] = useState(false);\n  const dropdownContainer = useRef();\n  const mouseScreenPos = useRef();\n\n  const focusedItem = useMemo(() => values.length ? values[focusedValueIndex] : null, [ focusedValueIndex, values ]);\n\n  const changeFocusedValueIndex = useCallback((delta) => {\n    setFocusedValueIndex(x => Math.min(Math.max(0, x + delta), values.length - 1));\n  }, [ values.length ]);\n\n  useEffect(() => {\n    if (focusedValueIndex === 0) return;\n\n    if (!focusedValueIndex || !values.length) {\n      setFocusedValueIndex(0);\n    }\n    else if (focusedValueIndex >= values.length) {\n      setFocusedValueIndex(values.length - 1);\n    }\n  }, [ focusedValueIndex, values.length ]);\n\n  useKeyDownAction('ArrowUp', () => {\n    if (values.length) {\n      changeFocusedValueIndex(-1);\n      setMouseControl(false);\n    }\n  }, listenerElement);\n\n  useKeyDownAction('ArrowDown', () => {\n    if (values.length) {\n      changeFocusedValueIndex(1);\n      setMouseControl(false);\n    }\n  }, listenerElement);\n\n  useKeyDownAction('Enter', () => {\n    if (focusedItem) {\n      onValueSelected(focusedItem);\n    }\n  }, listenerElement);\n\n  useEffect(() => {\n    const individualEntries = dropdownContainer.current.children;\n    if (individualEntries.length && !mouseControl) {\n      const focusedEntry = individualEntries[focusedValueIndex];\n      focusedEntry && focusedEntry.scrollIntoView({ block: 'nearest', inline: 'nearest' });\n    }\n  }, [ focusedValueIndex, mouseControl ]);\n\n  useEffect(() => {\n    setSmoothScrolling(true);\n  }, []);\n\n  const onMouseMovedInKeyboardMode = (event, valueIndex) => {\n\n    const userMovedCursor = !mouseScreenPos.current || mouseScreenPos.current.x !== event.screenX && mouseScreenPos.current.y !== event.screenY;\n\n    if (userMovedCursor) {\n      mouseScreenPos.current = { x: event.screenX, y: event.screenY };\n      setMouseControl(true);\n      setFocusedValueIndex(valueIndex);\n    }\n\n  };\n\n  return <div\n    ref={ dropdownContainer }\n    tabIndex={ -1 }\n    class=\"fjs-dropdownlist\"\n    onMouseDown={ (e) => e.preventDefault() }\n    style={ { maxHeight: height, scrollBehavior: smoothScrolling ? 'smooth' : 'auto' } }>\n    {\n      values.length > 0 && values.map((v, i) => {\n        return (\n          <div\n            class={ classNames('fjs-dropdownlist-item', { 'focused': focusedValueIndex === i }) }\n            onMouseMove={ mouseControl ? undefined : (e) => onMouseMovedInKeyboardMode(e, i) }\n            onMouseEnter={ mouseControl ? () => setFocusedValueIndex(i) : undefined }\n            onMouseDown={ (e) => onValueSelected(v) }>\n            {getLabel(v)}\n          </div>\n        );\n      })\n    }\n    {\n      !values.length && <div class=\"fjs-dropdownlist-empty\">{ emptyListMessage }</div>\n    }\n  </div>;\n}","import { useCallback, useEffect, useMemo, useRef, useState } from 'preact/hooks';\nimport { formatTime, parseInputTime } from '../../util/dateTimeUtil';\nimport { isNumber } from 'min-dash';\n\nimport ClockIcon from '../icons/Clock.svg';\nimport { DropdownList } from './DropdownList';\nimport { InputAdorner } from './InputAdorner';\nimport { Label } from '../../Label';\n\nexport function Timepicker(props) {\n\n  const {\n    label,\n    collapseLabelOnEmpty,\n    onDateTimeBlur,\n    onDateTimeFocus,\n    domId,\n    required,\n    disabled,\n    readonly,\n    use24h = false,\n    timeInterval,\n    time,\n    setTime\n  } = props;\n\n  const safeTimeInterval = useMemo(() => {\n\n    const allowedIntervals = [ 1, 5, 10, 15, 30, 60 ];\n\n    if (allowedIntervals.includes(timeInterval)) {\n      return timeInterval;\n    }\n\n    return 15;\n\n  }, [ timeInterval ]);\n\n  const timeInputRef = useRef();\n  const [ dropdownIsOpen, setDropdownIsOpen ] = useState(false);\n  const useDropdown = useMemo(() => safeTimeInterval !== 1, [ safeTimeInterval ]);\n\n  const [ rawValue, setRawValue ] = useState('');\n\n  // populates values from source\n  useEffect(() => {\n    if (time === null) {\n      setRawValue('');\n      return;\n    }\n\n    const intervalAdjustedTime = time - (time % safeTimeInterval);\n    setRawValue(formatTime(use24h, intervalAdjustedTime));\n\n    if (intervalAdjustedTime != time) {\n      setTime(intervalAdjustedTime);\n    }\n\n  }, [ time, setTime, use24h, safeTimeInterval ]);\n\n  const propagateRawToMinute = useCallback((newRawValue) => {\n\n    const localRawValue = newRawValue || rawValue;\n\n    // If no raw value exists, set the minute to null\n    if (!localRawValue) {\n      setTime(null);\n      return;\n    }\n\n    const minutes = parseInputTime(localRawValue);\n\n    // If raw string couldn't be parsed, clean everything up\n    if (!isNumber(minutes)) {\n      setRawValue('');\n      setTime(null);\n      return;\n    }\n\n    // Enforce the minutes to match the timeInterval\n    const correctedMinutes = minutes - (minutes % safeTimeInterval);\n\n    // Enforce the raw text to be formatted properly\n    setRawValue(formatTime(use24h, correctedMinutes));\n    setTime(correctedMinutes);\n\n  }, [ rawValue, safeTimeInterval, use24h, setTime ]);\n\n  const timeOptions = useMemo(() => {\n\n    const minutesInDay = 24 * 60;\n    const intervalCount = Math.floor(minutesInDay / safeTimeInterval);\n    return [ ...Array(intervalCount).keys() ].map(intervalIndex => formatTime(use24h, intervalIndex * safeTimeInterval));\n\n  }, [ safeTimeInterval, use24h ]);\n\n  const initialFocusIndex = useMemo(() => {\n\n    // if there are no options, there will not be any focusing\n    if (!timeOptions || !safeTimeInterval) return null;\n\n    // if there is a set minute value, we focus it in the dropdown\n    if (time) return time / safeTimeInterval;\n\n    const cacheTime = parseInputTime(rawValue);\n\n    // if there is a valid value in the input cache, we try and focus close to it\n    if (cacheTime) {\n      const flooredCacheTime = cacheTime - cacheTime % safeTimeInterval;\n      return flooredCacheTime / safeTimeInterval;\n    }\n\n    // If there is no set value, simply focus the middle of the dropdown (12:00)\n    return Math.floor(timeOptions.length / 2);\n\n  }, [ rawValue, time, safeTimeInterval, timeOptions ]);\n\n  const onInputKeyDown = (e) => {\n    switch (e.key) {\n    case 'ArrowUp':\n      e.preventDefault();\n      break;\n    case 'ArrowDown':\n      useDropdown && setDropdownIsOpen(true);\n      e.preventDefault();\n      break;\n    case 'Escape':\n      useDropdown && setDropdownIsOpen(false);\n      break;\n    case 'Enter':\n      !dropdownIsOpen && propagateRawToMinute();\n      break;\n    }\n  };\n\n  const onInputBlur = (e) => {\n    setDropdownIsOpen(false);\n    propagateRawToMinute();\n    onDateTimeBlur(e);\n  };\n\n  const onInputFocus = (e) => {\n    onDateTimeFocus(e);\n    !readonly && useDropdown && setDropdownIsOpen(true);\n  };\n\n  const onDropdownValueSelected = (value) => {\n    setDropdownIsOpen(false);\n    propagateRawToMinute(value);\n  };\n\n  return <div class=\"fjs-datetime-subsection\">\n    <Label\n      htmlFor={ domId }\n      label={ label }\n      collapseOnEmpty={ collapseLabelOnEmpty }\n      required={ required } />\n    <InputAdorner\n      pre={ <ClockIcon /> }\n      inputRef={ timeInputRef }\n      disabled={ disabled }\n      readonly={ readonly }>\n      <div class=\"fjs-timepicker fjs-timepicker-anchor\">\n        <input ref={ timeInputRef }\n          type=\"text\"\n          id={ domId }\n          class=\"fjs-input\"\n          value={ rawValue }\n          disabled={ disabled }\n          readOnly={ readonly }\n          placeholder={ use24h ? 'hh:mm' : 'hh:mm ?m' }\n          autoComplete=\"off\"\n\n          // @ts-ignore\n          onInput={ (e) => { setRawValue(e.target.value); useDropdown && setDropdownIsOpen(false); } }\n          onBlur={ onInputBlur }\n          onFocus={ onInputFocus }\n          onClick={ () => !readonly && useDropdown && setDropdownIsOpen(true) }\n          onKeyDown={ onInputKeyDown }\n          data-input\n          aria-describedby={ props['aria-describedby'] } />\n\n        { dropdownIsOpen && <DropdownList\n          values={ timeOptions }\n          height={ 150 }\n          onValueSelected={ onDropdownValueSelected }\n          listenerElement={ timeInputRef.current }\n          initialFocusIndex={ initialFocusIndex } /> }\n\n      </div>\n    </InputAdorner>\n  </div>;\n}\n","import { useCallback, useContext, useMemo, useState, useEffect, useRef } from 'preact/hooks';\n\nimport classNames from 'classnames';\n\nimport { set } from 'min-dash';\n\nimport { FormContext } from '../../context';\n\nimport { DATETIME_SUBTYPES, DATETIME_SUBTYPE_PATH, DATE_LABEL_PATH } from '../../../util/constants/DatetimeConstants';\n\nimport { Description } from '../Description';\nimport { Errors } from '../Errors';\nimport { Datepicker } from './parts/Datepicker';\nimport { Timepicker } from './parts/Timepicker';\n\nimport { formFieldClasses, prefixId } from '../Util';\nimport { sanitizeDateTimePickerValue } from '../util/sanitizerUtil';\nimport { parseIsoTime, serializeDate, serializeDateTime, serializeTime } from '../util/dateTimeUtil';\n\nconst type = 'datetime';\n\nexport function Datetime(props) {\n  const {\n    disabled,\n    errors = [],\n    domId,\n    onBlur,\n    onFocus,\n    field,\n    onChange,\n    readonly,\n    value = ''\n  } = props;\n\n  const {\n    description,\n    id,\n    dateLabel,\n    timeLabel,\n    validate = {},\n    subtype,\n    use24h,\n    disallowPassedDates,\n    timeInterval,\n    timeSerializingFormat\n  } = field;\n\n  const { required } = validate;\n  const { formId } = useContext(FormContext);\n  const dateTimeGroupRef = useRef();\n\n  const getNullDateTime = () => ({ date: new Date(Date.parse(null)), time: null });\n\n  const [ dateTime, setDateTime ] = useState(getNullDateTime());\n  const [ dateTimeUpdateRequest, setDateTimeUpdateRequest ] = useState(null);\n\n  const isValidDate = (date) => date && !isNaN(date.getTime());\n  const isValidTime = (time) => !isNaN(parseInt(time));\n\n  const useDatePicker = useMemo(() => subtype === DATETIME_SUBTYPES.DATE || subtype === DATETIME_SUBTYPES.DATETIME, [ subtype ]);\n  const useTimePicker = useMemo(() => subtype === DATETIME_SUBTYPES.TIME || subtype === DATETIME_SUBTYPES.DATETIME, [ subtype ]);\n\n  const onDateTimeBlur = useCallback((e) => {\n    if (e.relatedTarget && dateTimeGroupRef.current.contains(e.relatedTarget)) {\n      return;\n    }\n\n    onBlur && onBlur();\n  }, [ onBlur ]);\n\n  const onDateTimeFocus = useCallback((e) => {\n    if (e.relatedTarget && dateTimeGroupRef.current.contains(e.relatedTarget)) {\n      return;\n    }\n\n    onFocus && onFocus();\n  }, [ onFocus ]);\n\n  useEffect(() => {\n\n    let { date, time } = getNullDateTime();\n\n    switch (subtype) {\n    case DATETIME_SUBTYPES.DATE: {\n      date = new Date(Date.parse(value));\n      break;\n    }\n    case DATETIME_SUBTYPES.TIME: {\n      time = parseIsoTime(value);\n      break;\n    }\n    case DATETIME_SUBTYPES.DATETIME: {\n      date = new Date(Date.parse(value));\n      time = isValidDate(date) ? 60 * date.getHours() + date.getMinutes() : null;\n      break;\n    }}\n\n    setDateTime({ date, time });\n\n  }, [ subtype, value ]);\n\n  const computeAndSetState = useCallback(({ date, time }) => {\n\n    let newDateTimeValue = null;\n\n    if (subtype === DATETIME_SUBTYPES.DATE && isValidDate(date)) {\n      newDateTimeValue = serializeDate(date);\n    }\n    else if (subtype === DATETIME_SUBTYPES.TIME && isValidTime(time)) {\n      newDateTimeValue = serializeTime(time, new Date().getTimezoneOffset(), timeSerializingFormat);\n    }\n    else if (subtype === DATETIME_SUBTYPES.DATETIME && isValidDate(date) && isValidTime(time)) {\n      newDateTimeValue = serializeDateTime(date, time, timeSerializingFormat);\n    }\n\n    onChange({ value: newDateTimeValue, field });\n\n  }, [ field, onChange, subtype, timeSerializingFormat ]);\n\n  useEffect(() => {\n    if (dateTimeUpdateRequest) {\n      if (dateTimeUpdateRequest.refreshOnly) {\n        computeAndSetState(dateTime);\n      }\n      else {\n        const newDateTime = { ...dateTime, ...dateTimeUpdateRequest };\n        setDateTime(newDateTime);\n        computeAndSetState(newDateTime);\n      }\n      setDateTimeUpdateRequest(null);\n    }\n  }, [ computeAndSetState, dateTime, dateTimeUpdateRequest ]);\n\n  useEffect(() => {\n    setDateTimeUpdateRequest({ refreshOnly: true });\n  }, [ timeSerializingFormat ]);\n\n  const allErrors = useMemo(() => {\n    if (required || subtype !== DATETIME_SUBTYPES.DATETIME) return errors;\n    const isOnlyOneFieldSet = (isValidDate(dateTime.date) && !isValidTime(dateTime.time)) || (!isValidDate(dateTime.date) && isValidTime(dateTime.time));\n    return isOnlyOneFieldSet ? [ 'Date and time must both be entered.', ...errors ] : errors;\n  }, [ required, subtype, dateTime, errors ]);\n\n  const setDate = useCallback((date) => {\n    setDateTimeUpdateRequest((prev) => (prev ? { ...prev, date } : { date }));\n  }, []);\n\n  const setTime = useCallback((time) => {\n    setDateTimeUpdateRequest((prev) => (prev ? { ...prev, time } : { time }));\n  }, []);\n\n  const errorMessageId = allErrors.length === 0 ? undefined : `${prefixId(id, formId)}-error-message`;\n  const descriptionId = `${prefixId(id, formId)}-description`;\n\n  const datePickerProps = {\n    label: dateLabel,\n    collapseLabelOnEmpty: !timeLabel,\n    onDateTimeBlur,\n    onDateTimeFocus,\n    domId: `${domId}-date`,\n    required,\n    disabled,\n    disallowPassedDates,\n    date: dateTime.date,\n    readonly,\n    setDate,\n    'aria-describedby': [ descriptionId, errorMessageId ].join(' ')\n  };\n\n  const timePickerProps = {\n    label: timeLabel,\n    collapseLabelOnEmpty: !dateLabel,\n    onDateTimeBlur,\n    onDateTimeFocus,\n    domId: `${domId}-time`,\n    required,\n    disabled,\n    readonly,\n    use24h,\n    timeInterval,\n    time: dateTime.time,\n    setTime,\n    'aria-describedby': [ descriptionId, errorMessageId ].join(' ')\n  };\n\n  return <div class={ formFieldClasses(type, { errors: allErrors, disabled, readonly }) }>\n    <div class={ classNames('fjs-vertical-group') } ref={ dateTimeGroupRef }>\n      { useDatePicker && <Datepicker { ...datePickerProps } /> }\n      { useTimePicker && useDatePicker && <div class=\"fjs-datetime-separator\" /> }\n      { useTimePicker && <Timepicker { ...timePickerProps } /> }\n    </div>\n    <Description id={ descriptionId } description={ description } />\n    <Errors errors={ allErrors } id={ errorMessageId } />\n  </div>;\n}\n\nDatetime.config = {\n  type,\n  keyed: true,\n  label: 'Date time',\n  group: 'basic-input',\n  emptyValue: null,\n  sanitizeValue: sanitizeDateTimePickerValue,\n  create: (options = {}) => {\n    const defaults = {};\n    set(defaults, DATETIME_SUBTYPE_PATH, DATETIME_SUBTYPES.DATE);\n    set(defaults, DATE_LABEL_PATH, 'Date');\n\n    return { ...defaults, ...options };\n  }\n};\n","import classNames from 'classnames';\nimport { useContext } from 'preact/hooks';\nimport { FormRenderContext } from '../../context';\nimport { formFieldClasses } from '../Util';\nimport { Label } from '../Label';\nimport { ChildrenRenderer } from './parts/ChildrenRenderer';\n\nexport function Group(props) {\n\n  const { field, domId } = props;\n  const { label, type, showOutline } = field;\n  const { Empty } = useContext(FormRenderContext);\n\n  const fullProps = { ...props, Empty };\n\n  return (\n    <div className={ classNames(formFieldClasses(type), 'fjs-form-field-grouplike' , { 'fjs-outlined' : showOutline }) } role=\"group\" aria-labelledby={ domId }>\n      <Label\n        id={ domId }\n        label={ label } />\n      <ChildrenRenderer { ...fullProps } />\n    </div>\n  );\n}\n\nGroup.config = {\n  type: 'group',\n  pathed: true,\n  label: 'Group',\n  group: 'container',\n  create: (options = {}) => ({\n    components: [],\n    showOutline: true,\n    ...options\n  })\n};\n","import { useEffect, useMemo, useState } from 'preact/hooks';\n\nimport { useSingleLineTemplateEvaluation, useSecurityAttributesMap } from '../../hooks';\nimport { sanitizeIFrameSource } from '../util/sanitizerUtil';\n\nimport { Label } from '../Label';\n\nimport { formFieldClasses } from '../Util';\n\n\nconst type = 'iframe';\n\nconst DEFAULT_HEIGHT = 300;\n\n\nexport function IFrame(props) {\n  const {\n    field,\n    disabled,\n    readonly,\n    domId\n  } = props;\n\n  const {\n    height = DEFAULT_HEIGHT,\n    label,\n    url,\n    security = {}\n  } = field;\n\n  const evaluatedUrl = useSingleLineTemplateEvaluation(url, { debug: true });\n\n  const safeUrl = useMemo(() => sanitizeIFrameSource(evaluatedUrl), [ evaluatedUrl ]);\n\n  const evaluatedLabel = useSingleLineTemplateEvaluation(label, { debug: true });\n\n  const [ sandbox, allow ] = useSecurityAttributesMap(security);\n  const [ iframeRefresh, setIframeRefresh ] = useState(0);\n\n  // forces re-render of iframe when sandbox or allow attributes change, as browsers do not do it automatically\n  useEffect(() => {\n    setIframeRefresh(count => count + 1);\n  }, [ sandbox, allow ]);\n\n  return <div class={ formFieldClasses(type, { disabled, readonly }) }>\n    <Label htmlFor={ domId } label={ evaluatedLabel } />\n    {\n      !evaluatedUrl && <IFramePlaceholder text=\"No content to show.\" />\n    }\n    {\n      evaluatedUrl && safeUrl &&\n        <iframe\n          src={ safeUrl }\n          title={ evaluatedLabel }\n          height={ height }\n          class=\"fjs-iframe\"\n          id={ domId }\n          sandbox={ sandbox }\n          key={ 'iframe-' + iframeRefresh }\n\n          /* @Note: JSX HTML attributes do not include <allow> */\n          { ...{ allow } }\n        />\n    }\n    {\n      evaluatedUrl && !safeUrl && <IFramePlaceholder text=\"External content couldn't be loaded.\" />\n    }\n  </div>;\n}\n\nfunction IFramePlaceholder(props) {\n  const { text = 'iFrame' } = props;\n\n  return <div class=\"fjs-iframe-placeholder\">\n    <p class=\"fjs-iframe-placeholder-text\">{ text }</p>\n  </div>;\n}\n\nIFrame.config = {\n  type,\n  keyed: false,\n  label: 'iFrame',\n  group: 'container',\n  create: (options = {}) => ({\n    security: {\n      allowScripts: true\n    },\n    ...options\n  })\n};\n","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"54\" height=\"54\" fill=\"currentcolor\"><path fill-rule=\"evenodd\" d=\"M45 17a3 3 0 0 1 3 3v14a3 3 0 0 1-3 3H9a3 3 0 0 1-3-3V20a3 3 0 0 1 3-3h36zm-9 8.889H18v2.222h18v-2.222z\"/></svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"54\" height=\"54\" fill=\"currentcolor\"><path d=\"M34 18H20a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V20a2 2 0 0 0-2-2zm-9 14-5-5 1.41-1.41L25 29.17l7.59-7.59L34 23l-9 9z\"/></svg>","<svg width=\"54\" height=\"54\" viewBox=\"0 0 54 54\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M14.35 24.75H19V29.4H14.35V24.75ZM12.9358 23.3358C13.3109 22.9607 13.8196 22.75 14.35 22.75H19C19.5304 22.75 20.0391 22.9607 20.4142 23.3358C20.7893 23.7109 21 24.2196 21 24.75V29.4C21 29.9304 20.7893 30.4391 20.4142 30.8142C20.0391 31.1893 19.5304 31.4 19 31.4H14.35C13.8196 31.4 13.3109 31.1893 12.9358 30.8142C12.5607 30.4391 12.35 29.9304 12.35 29.4V24.75C12.35 24.2196 12.5607 23.7109 12.9358 23.3358ZM14.35 37.05H19V41.7H14.35V37.05ZM12.9358 35.6358C13.3109 35.2607 13.8196 35.05 14.35 35.05H19C19.5304 35.05 20.0391 35.2607 20.4142 35.6358C20.7893 36.0109 21 36.5196 21 37.05V41.7C21 42.2304 20.7893 42.7391 20.4142 43.1142C20.0391 43.4893 19.5304 43.7 19 43.7H14.35C13.8196 43.7 13.3109 43.4893 12.9358 43.1142C12.5607 42.7391 12.35 42.2304 12.35 41.7V37.05C12.35 36.5196 12.5607 36.0109 12.9358 35.6358ZM14.35 12.45H19V17.1H14.35V12.45ZM12.9358 11.0358C13.3109 10.6607 13.8196 10.45 14.35 10.45H19C19.5304 10.45 20.0391 10.6607 20.4142 11.0358C20.7893 11.4109 21 11.9196 21 12.45V17.1C21 17.6304 20.7893 18.1391 20.4142 18.5142C20.0391 18.8893 19.5304 19.1 19 19.1H14.35C13.8196 19.1 13.3109 18.8893 12.9358 18.5142C12.5607 18.1391 12.35 17.6304 12.35 17.1V12.45C12.35 11.9196 12.5607 11.4109 12.9358 11.0358ZM24.9429 26.0128C24.7554 26.2004 24.65 26.4547 24.65 26.7199V27.3699C24.65 27.6352 24.7554 27.8895 24.9429 28.077C25.1304 28.2646 25.3848 28.3699 25.65 28.3699H40.65C40.9152 28.3699 41.1696 28.2646 41.3571 28.077C41.5446 27.8895 41.65 27.6352 41.65 27.3699V26.7199C41.65 26.4547 41.5446 26.2004 41.3571 26.0128C41.1696 25.8253 40.9152 25.7199 40.65 25.7199H25.65C25.3848 25.7199 25.1304 25.8253 24.9429 26.0128ZM24.9429 38.3128C24.7554 38.5004 24.65 38.7547 24.65 39.0199V39.6699C24.65 39.9352 24.7554 40.1895 24.9429 40.377C25.1304 40.5646 25.3848 40.6699 25.65 40.6699H40.65C40.9152 40.6699 41.1696 40.5646 41.3571 40.377C41.5446 40.1895 41.65 39.9352 41.65 39.6699V39.0199C41.65 38.7547 41.5446 38.5004 41.3571 38.3128C41.1696 38.1253 40.9152 38.0199 40.65 38.0199H25.65C25.3848 38.0199 25.1304 38.1253 24.9429 38.3128ZM24.9429 13.7128C24.7554 13.9004 24.65 14.1547 24.65 14.4199V15.0699C24.65 15.3352 24.7554 15.5895 24.9429 15.777C25.1304 15.9646 25.3848 16.0699 25.65 16.0699H40.65C40.9152 16.0699 41.1696 15.9646 41.3571 15.777C41.5446 15.5895 41.65 15.3352 41.65 15.0699V14.4199C41.65 14.1547 41.5446 13.9004 41.3571 13.7128C41.1696 13.5253 40.9152 13.4199 40.65 13.4199H25.65C25.3848 13.4199 25.1304 13.5253 24.9429 13.7128Z\" fill=\"currentColor\"/>\n</svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"54\" height=\"54\" fill=\"currentcolor\"><path fill-rule=\"evenodd\" d=\"M37.908 13.418h-5.004v-2.354h-1.766v2.354H21.13v-2.354h-1.766v2.354H14.36a2.07 2.07 0 0 0-2.06 2.06v23.549a2.07 2.07 0 0 0 2.06 2.06h6.77v-1.766h-6.358a.707.707 0 0 1-.706-.706V15.89c0-.39.316-.707.706-.707h4.592v2.355h1.766v-2.355h10.008v2.355h1.766v-2.355h4.592a.71.71 0 0 1 .707.707v6.358h1.765v-6.77c0-1.133-.927-2.06-2.06-2.06z\"/><path d=\"m35.13 37.603 1.237-1.237-3.468-3.475v-5.926h-1.754v6.654l3.984 3.984Z\"/><path fill-rule=\"evenodd\" d=\"M23.08 36.962a9.678 9.678 0 1 0 17.883-7.408 9.678 9.678 0 0 0-17.882 7.408Zm4.54-10.292a7.924 7.924 0 1 1 8.805 13.177A7.924 7.924 0 0 1 27.62 26.67Z\"/></svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"54\" height=\"54\" fill=\"currentcolor\"><path fill-rule=\"evenodd\" d=\"M45 16a3 3 0 0 1 3 3v16a3 3 0 0 1-3 3H9a3 3 0 0 1-3-3V19a3 3 0 0 1 3-3h36Zm0 2H9a1 1 0 0 0-1 1v16a1 1 0 0 0 1 1h36a1 1 0 0 0 1-1V19a1 1 0 0 0-1-1Z\"/><path d=\"M11 22a1 1 0 0 1 1-1h19a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H12a1 1 0 0 1-1-1V22Z\"/></svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"54\" height=\"54\"><rect width=\"24\" height=\"4\" x=\"15\" y=\"17\" rx=\"1\"/><rect width=\"24\" height=\"4\" x=\"15\" y=\"25\" rx=\"1\"/><rect width=\"13\" height=\"4\" x=\"15\" y=\"33\" rx=\"1\"/></svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"54\" height=\"54\" fill=\"currentcolor\"><path fill-rule=\"evenodd\" d=\"M8 33v5a1 1 0 0 0 1 1h4v2H9a3 3 0 0 1-3-3v-5h2Zm18 6v2H15v-2h11Zm13 0v2H28v-2h11Zm9-6v5a3 3 0 0 1-3 3h-4v-2h4a1 1 0 0 0 .993-.883L46 38v-5h2ZM8 22v9H6v-9h2Zm40 0v9h-2v-9h2Zm-35-9v2H9a1 1 0 0 0-.993.883L8 16v4H6v-4a3 3 0 0 1 3-3h4Zm32 0a3 3 0 0 1 3 3v4h-2v-4a1 1 0 0 0-.883-.993L45 15h-4v-2h4Zm-6 0v2H28v-2h11Zm-13 0v2H15v-2h11Z\"/></svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"54\" height=\"54\" fill=\"currentcolor\"><path fill-rule=\"evenodd\" d=\"M45 16a3 3 0 0 1 3 3v16a3 3 0 0 1-3 3H9a3 3 0 0 1-3-3V19a3 3 0 0 1 3-3h36zm0 2H9a1 1 0 0 0-1 1v16a1 1 0 0 0 1 1h36a1 1 0 0 0 1-1V19a1 1 0 0 0-1-1zM35 28.444h7l-3.5 4-3.5-4zM35 26h7l-3.5-4-3.5 4z\"/></svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"54\" height=\"54\" fill=\"currentcolor\"><path d=\"M27 22c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm0-5c-5.52 0-10 4.48-10 10s4.48 10 10 10 10-4.48 10-10-4.48-10-10-10zm0 18a8 8 0 1 1 0-16 8 8 0 1 1 0 16z\"/></svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"54\" height=\"54\" fill=\"currentcolor\"><path fill-rule=\"evenodd\" d=\"M45 16a3 3 0 0 1 3 3v16a3 3 0 0 1-3 3H9a3 3 0 0 1-3-3V19a3 3 0 0 1 3-3h36zm0 2H9a1 1 0 0 0-1 1v16a1 1 0 0 0 1 1h36a1 1 0 0 0 1-1V19a1 1 0 0 0-1-1zm-12 7h9l-4.5 6-4.5-6z\"/></svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"54\" height=\"54\" fill=\"none\"><path fill=\"currentColor\" d=\"M26.293 16.293a1 1 0 0 1 1.414 0l4 4a1 1 0 0 1-1.414 1.414L27 18.414l-3.293 3.293a1 1 0 0 1-1.414-1.414l4-4ZM9 26h36v2H9v-2ZM22.293 33.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0-1.414-1.414L27 35.586l-3.293-3.293a1 1 0 0 0-1.414 1.414Z\"/></svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"54\" height=\"54\" fill=\"none\"><path fill=\"currentColor\" d=\"M9 15v2h36v-2H9ZM9 37v2h36v-2H9ZM26.293 19.293a1 1 0 0 1 1.414 0l4 4a1 1 0 0 1-1.414 1.414L27 21.414l-3.293 3.293a1 1 0 0 1-1.414-1.414l4-4ZM22.293 30.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0-1.414-1.414L27 32.586l-3.293-3.293a1 1 0 0 0-1.414 1.414Z\"/></svg>","<svg width=\"54\" height=\"54\" viewBox=\"0 0 54 54\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M2.70001 43.2964V44.55C2.70001 45.2956 3.30443 45.9 4.05001 45.9H5.32501V44.1052C5.3736 44.2444 5.40001 44.3941 5.40001 44.55V43.2964H5.32501V43.2H4.05001C4.22743 43.2 4.39685 43.2342 4.55204 43.2964H2.70001ZM5.40001 40.7893V38.2821H2.70001V40.7893H5.40001ZM5.40001 35.775V33.2679H2.70001V35.775H5.40001ZM5.40001 30.7607V28.2536H2.70001V30.7607H5.40001ZM5.40001 25.7464V23.2393H2.70001V25.7464H5.40001ZM5.40001 20.7321V18.225H2.70001V20.7321H5.40001ZM5.40001 15.7179V13.2107H2.70001V15.7179H5.40001ZM2.70001 10.7036H4.55204C4.39685 10.7658 4.22743 10.8 4.05001 10.8H5.32501V10.7036H5.40001V9.45C5.40001 9.60585 5.3736 9.75554 5.32501 9.89482V8.1H4.05001C3.30443 8.1 2.70001 8.70441 2.70001 9.45V10.7036ZM7.87501 10.8H10.425V8.1H7.87501V10.8ZM12.975 10.8H15.525V8.1H12.975V10.8ZM18.075 10.8H20.625V8.1H18.075V10.8ZM23.175 10.8H25.725V8.1H23.175V10.8ZM28.275 10.8H30.825V8.1H28.275V10.8ZM33.375 10.8H35.925V8.1H33.375V10.8ZM38.475 10.8H41.025V8.1H38.475V10.8ZM43.575 10.8H46.125V8.1H43.575V10.8ZM48.675 8.1V9.89484C48.6264 9.75555 48.6 9.60586 48.6 9.45V10.7036H48.675V10.8H49.95C49.7726 10.8 49.6032 10.7658 49.448 10.7036H51.3V9.45C51.3 8.70441 50.6956 8.1 49.95 8.1H48.675ZM48.6 13.2107V15.7179H51.3V13.2107H48.6ZM48.6 18.225V20.7321H51.3V18.225H48.6ZM48.6 23.2393V25.7464H51.3V23.2393H48.6ZM48.6 28.2536V30.7607H51.3V28.2536H48.6ZM48.6 33.2679V35.775H51.3V33.2679H48.6ZM48.6 38.2821V40.7893H51.3V38.2821H48.6ZM51.3 43.2964H49.448C49.6032 43.2342 49.7726 43.2 49.95 43.2H48.675V43.2964H48.6V44.55C48.6 44.3941 48.6264 44.2445 48.675 44.1052V45.9H49.95C50.6956 45.9 51.3 45.2956 51.3 44.55V43.2964ZM46.125 43.2H43.575V45.9H46.125V43.2ZM41.025 43.2H38.475V45.9H41.025V43.2ZM35.925 43.2H33.375V45.9H35.925V43.2ZM30.825 43.2H28.275V45.9H30.825V43.2ZM25.725 43.2H23.175V45.9H25.725V43.2ZM20.625 43.2H18.075V45.9H20.625V43.2ZM15.525 43.2H12.975V45.9H15.525V43.2ZM10.425 43.2H7.87501V45.9H10.425V43.2ZM16.2 17.55C18.4368 17.55 20.25 19.3632 20.25 21.6V22.95C20.25 25.1868 18.4368 27 16.2 27H14.85C12.6133 27 10.8 25.1868 10.8 22.95V21.6C10.8 19.3632 12.6133 17.55 14.85 17.55H16.2ZM16.2 20.25H14.85C14.1044 20.25 13.5 20.8544 13.5 21.6V22.95C13.5 23.6956 14.1044 24.3 14.85 24.3H16.2C16.9456 24.3 17.55 23.6956 17.55 22.95V21.6C17.55 20.8544 16.9456 20.25 16.2 20.25ZM43.2 21.6C43.2 19.3632 41.3868 17.55 39.15 17.55H29.7C27.4633 17.55 25.65 19.3632 25.65 21.6V22.95C25.65 25.1868 27.4633 27 29.7 27H39.15C41.3868 27 43.2 25.1868 43.2 22.95V21.6ZM29.7 20.25H39.15C39.8956 20.25 40.5 20.8544 40.5 21.6V22.95C40.5 23.6956 39.8956 24.3 39.15 24.3H29.7C28.9544 24.3 28.35 23.6956 28.35 22.95V21.6C28.35 20.8544 28.9544 20.25 29.7 20.25ZM43.2 37.8C43.2 35.5632 41.3868 33.75 39.15 33.75H29.7C27.4633 33.75 25.65 35.5632 25.65 37.8V39.15H28.35V37.8C28.35 37.0544 28.9544 36.45 29.7 36.45H39.15C39.8956 36.45 40.5 37.0544 40.5 37.8V39.15H43.2V37.8ZM16.2 33.75C18.4368 33.75 20.25 35.5632 20.25 37.8V39.15H17.55V37.8C17.55 37.0544 16.9456 36.45 16.2 36.45H14.85C14.1044 36.45 13.5 37.0544 13.5 37.8V39.15H10.8V37.8C10.8 35.5632 12.6133 33.75 14.85 33.75H16.2Z\" fill=\"currentColor\"/>\n</svg>\n","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"54\" height=\"54\" fill=\"currentcolor\"><path d=\"M20.58 33.77h-3l-1.18-3.08H11l-1.1 3.08H7l5.27-13.54h2.89zm-5-5.36-1.86-5-1.83 5zM22 20.23h5.41a15.47 15.47 0 0 1 2.4.14 3.42 3.42 0 0 1 1.41.55 3.47 3.47 0 0 1 1 1.14 3 3 0 0 1 .42 1.58 3.26 3.26 0 0 1-1.91 2.94 3.63 3.63 0 0 1 1.91 1.22 3.28 3.28 0 0 1 .66 2 4 4 0 0 1-.43 1.8 3.63 3.63 0 0 1-1.09 1.4 3.89 3.89 0 0 1-1.83.65q-.69.07-3.3.09H22zm2.73 2.25v3.13h3.8a1.79 1.79 0 0 0 1.1-.49 1.41 1.41 0 0 0 .41-1 1.49 1.49 0 0 0-.35-1 1.54 1.54 0 0 0-1-.48c-.27 0-1.05-.05-2.34-.05zm0 5.39v3.62h2.57a11.52 11.52 0 0 0 1.88-.09 1.65 1.65 0 0 0 1-.54 1.6 1.6 0 0 0 .38-1.14 1.75 1.75 0 0 0-.29-1 1.69 1.69 0 0 0-.86-.62 9.28 9.28 0 0 0-2.41-.23zm19.62.92 2.65.84a5.94 5.94 0 0 1-2 3.29A5.74 5.74 0 0 1 41.38 34a5.87 5.87 0 0 1-4.44-1.84 7.09 7.09 0 0 1-1.73-5A7.43 7.43 0 0 1 37 21.87 6 6 0 0 1 41.54 20a5.64 5.64 0 0 1 4 1.47A5.33 5.33 0 0 1 47 24l-2.7.65a2.8 2.8 0 0 0-2.86-2.27A3.09 3.09 0 0 0 39 23.42a5.31 5.31 0 0 0-.93 3.5 5.62 5.62 0 0 0 .93 3.65 3 3 0 0 0 2.4 1.09 2.72 2.72 0 0 0 1.82-.66 4 4 0 0 0 1.13-2.21z\"/></svg>","<svg width=\"54\" height=\"54\" viewBox=\"0 0 54 54\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M47.0082 12.15C48.6329 12.15 49.95 13.5106 49.95 15.189V38.811C49.95 40.4894 48.6329 41.85 47.0082 41.85H6.99194C5.36718 41.85 4.05005 40.4894 4.05005 38.811V15.189C4.05005 13.5106 5.36718 12.15 6.99194 12.15H47.0082ZM47.0082 14.176H6.99194C6.45035 14.176 6.01131 14.6295 6.01131 15.189V16.2H6.00755V18.9H6.01131V38.811C6.01131 39.3705 6.45035 39.824 6.99194 39.824H47.0082C47.5498 39.824 47.9888 39.3705 47.9888 38.811V18.9H47.9925V16.2H47.9888V15.189C47.9888 14.6295 47.5498 14.176 47.0082 14.176ZM14.9344 26.055V22.275H17.1282V31.725H14.9344V27.945H11.6438V31.725H9.45005V22.275H11.6438V26.055H14.9344ZM19.3219 24.165H21.5157V31.725H23.7094V24.165H25.9032V22.275H19.3219V24.165ZM33.5813 22.275H35.775V31.725H33.5813V25.11L31.936 28.89L30.2907 25.11V31.725H28.0969V22.275H30.2907L31.936 26.055L33.5813 22.275ZM37.9688 22.275H40.1625V29.835H44.55V31.725H37.9688V22.275Z\" fill=\"currentColor\"/>\n</svg>\n","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"54\" height=\"54\" fill=\"currentcolor\"><path fill-rule=\"evenodd\" d=\"M45 16a3 3 0 0 1 3 3v16a3 3 0 0 1-3 3H9a3 3 0 0 1-3-3V19a3 3 0 0 1 3-3h36zm0 2H9a1 1 0 0 0-1 1v16a1 1 0 0 0 1 1h36a1 1 0 0 0 1-1V19a1 1 0 0 0-1-1zm-32 4v10h-2V22h2z\"/></svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"54\" height=\"54\" fill=\"currentcolor\"><path fill-rule=\"evenodd\" d=\"M45 13a3 3 0 0 1 3 3v22a3 3 0 0 1-3 3H9a3 3 0 0 1-3-3V16a3 3 0 0 1 3-3h36zm0 2H9a1 1 0 0 0-1 1v22a1 1 0 0 0 1 1h36a1 1 0 0 0 1-1V16a1 1 0 0 0-1-1zm-1.136 15.5.849.849-6.364 6.364-.849-.849 6.364-6.364zm.264 3.5.849.849-2.828 2.828-.849-.849L44.128 34zM13 19v10h-2V19h2z\"/></svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"54\" height=\"54\" fill=\"none\"><path fill=\"currentcolor\" d=\"M34.467 37.3 41 31l-6.533-6.3-1.32 1.273L38.36 31l-5.213 5.027 1.32 1.273ZM19.533 24.7 13 31l6.533 6.3 1.32-1.273L15.64 31l5.214-5.027-1.32-1.273ZM23.66 39.532l1.805.468 4.875-17.532L28.535 22 23.66 39.532Z\"/><path fill=\"currentcolor\" fill-rule=\"evenodd\" d=\"M46 9a3 3 0 0 1 3 3v30a3 3 0 0 1-3 3H8a3 3 0 0 1-3-3V12a3 3 0 0 1 3-3h38Zm0 2H8a1 1 0 0 0-1 1v4h40v-4a1 1 0 0 0-1-1ZM7 42V18h40v24a1 1 0 0 1-1 1H8a1 1 0 0 1-1-1Z\" clip-rule=\"evenodd\"/></svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"54\" height=\"54\" fill=\"currentcolor\"><path fill-rule=\"evenodd\" d=\"M34.636 21.91A3.818 3.818 0 1 1 27 21.908a3.818 3.818 0 0 1 7.636 0Zm-2 0A1.818 1.818 0 1 1 29 21.908a1.818 1.818 0 0 1 3.636 0Z\" clip-rule=\"evenodd\"/><path fill-rule=\"evenodd\" d=\"M15 13a2 2 0 0 0-2 2v24a2 2 0 0 0 2 2h24a2 2 0 0 0 2-2V15a2 2 0 0 0-2-2H15Zm24 2H15v12.45l4.71-4.709a1.91 1.91 0 0 1 2.702 0l6.695 6.695 2.656-1.77a1.91 1.91 0 0 1 2.411.239L39 32.73V15ZM15 39v-8.754c.06-.038.116-.083.168-.135l5.893-5.893 6.684 6.685a1.911 1.911 0 0 0 2.41.238l2.657-1.77 6.02 6.02c.052.051.108.097.168.135V39H15Z\" clip-rule=\"evenodd\"/></svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 54 54\"><path fill=\"currentcolor\" fill-rule=\"evenodd\" d=\"M42.545479 12.272741C43.901087 12.272741 45 13.371687 45 14.727295v24.545443c0 1.355609-1.098913 2.454521-2.454521 2.454521H11.454554C10.098946 41.727259 9 40.628347 9 39.272738V14.727295c0-1.355608 1.098946-2.454554 2.454554-2.454554zM27.818242 40.090875h14.727237c.451869 0 .818137-.366267.818137-.818137v-4.909042H27.818242Zm-1.636385-5.727179v5.727179H11.454554c-.451869 0-.818192-.366267-.818192-.818137v-4.909042zm1.636385-1.636385h15.545374v-5.727289H27.818242Zm-1.636385-5.727289v5.727289H10.636362v-5.727289zm1.636385-1.636384h15.545374v-5.72729H27.818242Zm-1.636385-5.72729v5.72729H10.636362v-5.72729z\" clip-rule=\"evenodd\"/></svg>\n","import ButtonIcon from './Button.svg';\nimport CheckboxIcon from './Checkbox.svg';\nimport ChecklistIcon from './Checklist.svg';\nimport DatetimeIcon from './Datetime.svg';\nimport TaglistIcon from './Taglist.svg';\nimport FormIcon from './Form.svg';\nimport ColumnsIcon from './Group.svg';\nimport NumberIcon from './Number.svg';\nimport RadioIcon from './Radio.svg';\nimport SelectIcon from './Select.svg';\nimport SeparatorIcon from './Separator.svg';\nimport SpacerIcon from './Spacer.svg';\nimport DynamicListIcon from './DynamicList.svg';\nimport TextIcon from './Text.svg';\nimport HTMLIcon from './HTML.svg';\nimport TextfieldIcon from './Textfield.svg';\nimport TextareaIcon from './Textarea.svg';\nimport IFrameIcon from './IFrame.svg';\nimport ImageIcon from './Image.svg';\nimport GroupIcon from './Group.svg';\nimport TableIcon from './Table.svg';\n\nexport const iconsByType = (type) => {\n  return {\n    button: ButtonIcon,\n    checkbox: CheckboxIcon,\n    checklist: ChecklistIcon,\n    columns: ColumnsIcon,\n    datetime: DatetimeIcon,\n    group: GroupIcon,\n    iframe: IFrameIcon,\n    image: ImageIcon,\n    number: NumberIcon,\n    radio: RadioIcon,\n    select: SelectIcon,\n    separator: SeparatorIcon,\n    spacer: SpacerIcon,\n    dynamiclist: DynamicListIcon,\n    taglist: TaglistIcon,\n    text: TextIcon,\n    html: HTMLIcon,\n    textfield: TextfieldIcon,\n    textarea: TextareaIcon,\n    table: TableIcon,\n    default: FormIcon\n  }[type];\n};\n","import { useContext, useMemo } from 'preact/hooks';\n\nimport { FormContext } from '../../context';\n\nimport { iconsByType } from '../icons';\n\nimport { useSingleLineTemplateEvaluation } from '../../hooks';\nimport { sanitizeImageSource } from '../util/sanitizerUtil';\n\nimport {\n  formFieldClasses,\n  prefixId\n} from '../Util';\n\nconst type = 'image';\n\n\nexport function Image(props) {\n  const {\n    field\n  } = props;\n\n  const {\n    alt,\n    id,\n    source\n  } = field;\n\n  const Icon = iconsByType(field.type);\n\n  const evaluatedImageSource = useSingleLineTemplateEvaluation(source, { debug: true });\n\n  const safeSource = useMemo(() => sanitizeImageSource(evaluatedImageSource), [ evaluatedImageSource ]);\n\n  const altText = useSingleLineTemplateEvaluation(alt, { debug: true });\n\n  const { formId } = useContext(FormContext);\n\n  return <div class={ formFieldClasses(type) }>\n    {\n      safeSource && <div class=\"fjs-image-container\">\n        <img\n          alt={ altText }\n          src={ safeSource }\n          class=\"fjs-image\"\n          id={ prefixId(id, formId) } />\n      </div>\n    }\n    {\n      !safeSource && <div class=\"fjs-image-placeholder\">\n        <span class=\"fjs-image-placeholder-inner\">\n          <Icon alt=\"This is an image placeholder\" width=\"32\" height=\"32\" viewBox=\"0 0 56 56\" />\n        </span>\n      </div>\n    }\n  </div>;\n}\n\nImage.config = {\n  type,\n  keyed: false,\n  label: 'Image view',\n  group: 'presentation',\n  create: (options = {}) => ({\n    ...options\n  })\n};\n","import { InputAdorner } from './InputAdorner';\n\nimport { useSingleLineTemplateEvaluation } from '../../../hooks';\n\nexport function TemplatedInputAdorner(props) {\n\n  const {\n    pre,\n    post\n  } = props;\n\n  const evaluatedPre = useSingleLineTemplateEvaluation(pre, { debug: true });\n  const evaluatedPost = useSingleLineTemplateEvaluation(post, { debug: true });\n\n  return <InputAdorner { ...props } pre={ evaluatedPre } post={ evaluatedPost } />;\n\n}","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"8\" height=\"8\"><path fill=\"currentColor\" fill-rule=\"evenodd\" stroke=\"currentColor\" stroke-width=\".5\" d=\"M7.75 1.336 4 6.125.258 1.335 0 1.54l4 5.125L8 1.54Zm0 0\" clip-rule=\"evenodd\"/></svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"8\" height=\"8\"><path fill=\"currentColor\" fill-rule=\"evenodd\" stroke=\"currentColor\" stroke-width=\".5\" d=\"M7.75 6.664 4 1.875.258 6.665 0 6.46l4-5.125L8 6.46Zm0 0\" clip-rule=\"evenodd\"/></svg>","import Big from 'big.js';\n\nexport function countDecimals(number) {\n  const num = Big(number);\n  if (num.toString() === num.toFixed(0)) return 0;\n  return num.toFixed().split('.')[1].length || 0;\n}\n\nexport function isValidNumber(value) {\n  return (typeof value === 'number' || typeof value === 'string') && value !== '' && !isNaN(Number(value));\n}\n\nexport function willKeyProduceValidNumber(key, previousValue, caretIndex, selectionWidth, decimalDigits) {\n\n  if (previousValue === 'NaN') {\n    return false;\n  }\n\n  // Dot and comma are both treated as dot\n  previousValue = previousValue.replace(',', '.');\n  const isFirstDot = !previousValue.includes('.') && (key === '.' || key === ',');\n  const isFirstMinus = !previousValue.includes('-') && key === '-' && caretIndex === 0;\n\n  const keypressIsNumeric = /^[0-9]$/i.test(key);\n  const dotIndex = previousValue === undefined ? -1 : previousValue.indexOf('.');\n\n  // If the caret is positioned after a dot, and the current decimal digits count is equal or greater to the maximum, disallow the key press\n  const overflowsDecimalSpace = typeof(decimalDigits) === 'number'\n    && selectionWidth === 0\n    && dotIndex !== -1\n    && previousValue.includes('.')\n    && previousValue.split('.')[1].length >= decimalDigits\n    && caretIndex > dotIndex;\n\n  const keypressIsAllowedChar = keypressIsNumeric || ((decimalDigits !== 0) && isFirstDot) || isFirstMinus;\n\n  return keypressIsAllowedChar && !overflowsDecimalSpace;\n\n}\n\nexport function isNullEquivalentValue(value) {\n  return value === undefined || value === null || value === '';\n}\n","import Big from 'big.js';\nimport classNames from 'classnames';\nimport { useCallback, useMemo, useRef, useState } from 'preact/hooks';\nimport { useFlushDebounce, usePrevious } from '../../hooks';\n\nimport { Description } from '../Description';\nimport { Errors } from '../Errors';\nimport { Label } from '../Label';\nimport { TemplatedInputAdorner } from './parts/TemplatedInputAdorner';\n\nimport AngelDownIcon from './icons/AngelDown.svg';\nimport AngelUpIcon from './icons/AngelUp.svg';\n\nimport {\n  formFieldClasses\n} from '../Util';\n\nimport {\n  isNullEquivalentValue,\n  isValidNumber,\n  willKeyProduceValidNumber\n} from '../util/numberFieldUtil';\n\nconst type = 'number';\n\nexport function Numberfield(props) {\n  const {\n    disabled,\n    errors = [],\n    domId,\n    onBlur,\n    onFocus,\n    field,\n    value,\n    readonly\n  } = props;\n\n  const {\n    description,\n    label,\n    appearance = {},\n    validate = {},\n    decimalDigits,\n    increment: incrementValue\n  } = field;\n\n  const {\n    prefixAdorner,\n    suffixAdorner\n  } = appearance;\n\n  const { required } = validate;\n\n  const inputRef = useRef();\n\n  const [ cachedValue, setCachedValue ] = useState(value);\n  const [ displayValue, setDisplayValue ] = useState(value);\n\n  const sanitize = useCallback((value) => Numberfield.config.sanitizeValue({ value, formField: field }), [ field ]);\n\n  const [ debouncedOnChange, flushOnChange ] = useFlushDebounce(props.onChange);\n\n  const previousCachedValue = usePrevious(value);\n\n  if (previousCachedValue !== cachedValue) {\n    debouncedOnChange({ field, value: cachedValue });\n  }\n\n  const onInputBlur = () => {\n    flushOnChange && flushOnChange();\n    onBlur && onBlur();\n  };\n\n  const onInputFocus = () => {\n    onFocus && onFocus();\n  };\n\n  // all value changes must go through this function\n  const setValue = useCallback((stringValue) => {\n\n    if (isNullEquivalentValue(stringValue)) {\n      setDisplayValue('');\n      setCachedValue(null);\n      return;\n    }\n\n    // converts automatically for countries where the comma is used as a decimal separator\n    stringValue = stringValue.replaceAll(',', '.');\n\n    if (stringValue === '-') {\n      setDisplayValue('-');\n      return;\n    }\n\n    // provides feedback for invalid numbers entered via pasting as opposed to just ignoring the paste\n    if (isNaN(Number(stringValue))) {\n      setDisplayValue('NaN');\n      setCachedValue(null);\n      return;\n    }\n\n    setDisplayValue(stringValue);\n    setCachedValue(sanitize(stringValue));\n\n  }, [ sanitize ]);\n\n  // when external changes occur independently of the input, we update the display and cache values of the component\n  const previousValue = usePrevious(value);\n  const outerValueChanged = previousValue != value;\n  const outerValueEqualsCache = sanitize(value) === sanitize(cachedValue);\n\n  if (outerValueChanged && !outerValueEqualsCache) {\n    setValue(value && value.toString() || '');\n  }\n\n  // caches the value an increment/decrement operation will be based on\n  const incrementAmount = useMemo(() => {\n\n    if (incrementValue) return Big(incrementValue);\n    if (decimalDigits) return Big(`1e-${decimalDigits}`);\n    return Big('1');\n\n  }, [ decimalDigits, incrementValue ]);\n\n  const increment = () => {\n    if (readonly) {\n      return;\n    }\n\n    const base = isValidNumber(cachedValue) ? Big(cachedValue) : Big(0);\n    const stepFlooredValue = base.minus(base.mod(incrementAmount));\n\n    // note: toFixed() behaves differently in big.js\n    setValue(stepFlooredValue.plus(incrementAmount).toFixed());\n  };\n\n  const decrement = () => {\n    if (readonly) {\n      return;\n    }\n\n    const base = isValidNumber(cachedValue) ? Big(cachedValue) : Big(0);\n    const offset = base.mod(incrementAmount);\n\n    if (offset.cmp(0) === 0) {\n\n      // if we're already on a valid step, decrement\n      setValue(base.minus(incrementAmount).toFixed());\n    }\n    else {\n\n      // otherwise floor to the step\n      const stepFlooredValue = base.minus(base.mod(incrementAmount));\n      setValue(stepFlooredValue.toFixed());\n    }\n  };\n\n  const onKeyDown = (e) => {\n\n    // delete the NaN state all at once on backspace or delete\n    if (displayValue === 'NaN' && (e.code === 'Backspace' || e.code === 'Delete')) {\n      setValue('');\n      e.preventDefault();\n      return;\n    }\n\n    if (e.code === 'ArrowUp') {\n      increment();\n      e.preventDefault();\n      return;\n    }\n\n    if (e.code === 'ArrowDown') {\n      decrement();\n      e.preventDefault();\n      return;\n    }\n\n  };\n\n  // intercept key presses which would lead to an invalid number\n  const onKeyPress = (e) => {\n    const caretIndex = inputRef.current.selectionStart;\n    const selectionWidth = inputRef.current.selectionStart - inputRef.current.selectionEnd;\n    const previousValue = inputRef.current.value;\n\n    if (!willKeyProduceValidNumber(e.key, previousValue, caretIndex, selectionWidth, decimalDigits)) {\n      e.preventDefault();\n    }\n  };\n\n  const descriptionId = `${domId}-description`;\n  const errorMessageId = `${domId}-error-message`;\n\n  return <div class={ formFieldClasses(type, { errors, disabled, readonly }) }>\n    <Label\n      htmlFor={ domId }\n      label={ label }\n      required={ required } />\n    <TemplatedInputAdorner disabled={ disabled } readonly={ readonly } pre={ prefixAdorner } post={ suffixAdorner }>\n      <div class={ classNames('fjs-vertical-group', { 'fjs-disabled': disabled, 'fjs-readonly': readonly }, { 'hasErrors': errors.length }) }>\n        <input\n          ref={ inputRef }\n          class=\"fjs-input\"\n          disabled={ disabled }\n          readOnly={ readonly }\n          id={ domId }\n          onKeyDown={ onKeyDown }\n          onKeyPress={ onKeyPress }\n          onBlur={ onInputBlur }\n          onFocus={ onInputFocus }\n\n          // @ts-ignore\n          onInput={ (e) => setValue(e.target.value, true) }\n          onPaste={ (e) => displayValue === 'NaN' && e.preventDefault() }\n          type=\"text\"\n          autoComplete=\"off\"\n          step={ incrementAmount }\n          value={ displayValue }\n          aria-describedby={ [ descriptionId, errorMessageId ].join(' ') }\n          required={ required }\n          aria-invalid={ errors.length > 0 } />\n        <div class={ classNames('fjs-number-arrow-container', { 'fjs-disabled': disabled, 'fjs-readonly': readonly }) }>\n          { /* we're disabling tab navigation on both buttons to imitate the native browser behavior of input[type='number'] increment arrows */ }\n          <button\n            type=\"button\"\n            class=\"fjs-number-arrow-up\"\n            aria-label=\"Increment\"\n            onClick={ () => increment() }\n            tabIndex={ -1 }><AngelUpIcon /></button>\n          <div class=\"fjs-number-arrow-separator\" />\n          <button\n            type=\"button\"\n            class=\"fjs-number-arrow-down\"\n            aria-label=\"Decrement\"\n            onClick={ () => decrement() }\n            tabIndex={ -1 }><AngelDownIcon /></button>\n        </div>\n      </div>\n    </TemplatedInputAdorner>\n    <Description id={ descriptionId } description={ description } />\n    <Errors id={ errorMessageId } errors={ errors } />\n  </div>;\n}\n\nNumberfield.config = {\n  type,\n  keyed: true,\n  label: 'Number',\n  group: 'basic-input',\n  emptyValue: null,\n  sanitizeValue: ({ value, formField }) => {\n\n    // invalid value types are sanitized to null\n    if (isNullEquivalentValue(value) || !isValidNumber(value)) return null;\n\n    // otherwise, we return a string or a number depending on the form field configuration\n    return formField.serializeToString ? value.toString() : Number(value);\n  },\n  create: (options = {}) => ({\n    ...options\n  })\n};","import { useRef } from 'preact/hooks';\nimport isEqual from 'lodash/isEqual';\nimport { useOptionsAsync, LOAD_STATES } from '../../hooks/useOptionsAsync';\nimport { useCleanupSingleSelectValue } from '../../hooks/useCleanupSingleSelectValue';\nimport classNames from 'classnames';\n\nimport { Description } from '../Description';\nimport { Errors } from '../Errors';\nimport { Label } from '../Label';\n\nimport { sanitizeSingleSelectValue } from '../util/sanitizerUtil';\n\nimport { createEmptyOptions } from '../util/optionsUtil';\n\nimport {\n  formFieldClasses\n} from '../Util';\n\nconst type = 'radio';\n\n\nexport function Radio(props) {\n  const {\n    disabled,\n    errors = [],\n    domId,\n    onBlur,\n    onFocus,\n    field,\n    readonly,\n    value\n  } = props;\n\n  const {\n    description,\n    label,\n    validate = {}\n  } = field;\n\n  const outerDivRef = useRef();\n\n  const { required } = validate;\n\n  const onChange = (v) => {\n    props.onChange({\n      field,\n      value: v\n    });\n  };\n\n  const onRadioBlur = (e) => {\n    if (outerDivRef.current.contains(e.relatedTarget)) {\n      return;\n    }\n\n    onBlur && onBlur();\n  };\n\n  const onRadioFocus = (e) => {\n    if (outerDivRef.current.contains(e.relatedTarget)) {\n      return;\n    }\n\n    onFocus && onFocus();\n  };\n\n  const {\n    loadState,\n    options\n  } = useOptionsAsync(field);\n\n  useCleanupSingleSelectValue({\n    field,\n    loadState,\n    options,\n    value,\n    onChange: props.onChange\n  });\n\n  const descriptionId = `${domId}-description`;\n  const errorMessageId = `${domId}-error-message`;\n\n  return <div class={ formFieldClasses(type, { errors, disabled, readonly }) } ref={ outerDivRef }>\n    <Label\n      label={ label }\n      required={ required } />\n    {\n      loadState == LOAD_STATES.LOADED && options.map((option, index) => {\n\n        const itemDomId = `${domId}-${index}`;\n        const isChecked = isEqual(option.value, value);\n\n        return (\n          <Label\n            htmlFor={ itemDomId }\n            key={ index }\n            label={ option.label }\n            class={ classNames({ 'fjs-checked': isChecked }) }\n            required={ false }>\n            <input\n              checked={ isChecked }\n              class=\"fjs-input\"\n              disabled={ disabled }\n              readOnly={ readonly }\n              id={ itemDomId }\n              type=\"radio\"\n              onClick={ () => onChange(option.value) }\n              onBlur={ onRadioBlur }\n              onFocus={ onRadioFocus }\n              aria-describedby={ [ descriptionId, errorMessageId ].join(' ') }\n              required={ required }\n              aria-invalid={ errors.length > 0 } />\n          </Label>\n        );\n      })\n    }\n    <Description id={ descriptionId } description={ description } />\n    <Errors id={ errorMessageId } errors={ errors } />\n  </div>;\n}\n\nRadio.config = {\n  type,\n  keyed: true,\n  label: 'Radio group',\n  group: 'selection',\n  emptyValue: null,\n  sanitizeValue: sanitizeSingleSelectValue,\n  create: createEmptyOptions\n};\n","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"8\" height=\"8\"><path fill=\"currentColor\" fill-rule=\"evenodd\" stroke=\"currentColor\" stroke-width=\".5\" d=\"M4 3.766 7.43.336l.234.234L4.234 4l3.43 3.43-.234.234L4 4.234.57 7.664.336 7.43 3.766 4 .336.57.57.336Zm0 0\" clip-rule=\"evenodd\"/></svg>","import { useCallback, useEffect, useMemo, useRef, useState } from 'preact/hooks';\nimport { useOptionsAsync, LOAD_STATES } from '../../../hooks/useOptionsAsync';\nimport { useGetLabelCorrelation } from '../../../hooks/useGetLabelCorrelation';\nimport { useService, useCleanupSingleSelectValue } from '../../../hooks';\n\nimport classNames from 'classnames';\n\nimport XMarkIcon from '../icons/XMark.svg';\nimport AngelDownIcon from '../icons/AngelDown.svg';\nimport AngelUpIcon from '../icons/AngelUp.svg';\nimport { DropdownList } from './DropdownList';\n\nexport function SearchableSelect(props) {\n  const {\n    domId,\n    disabled,\n    errors,\n    onBlur,\n    onFocus,\n    field,\n    readonly,\n    value\n  } = props;\n\n  const [ filter, setFilter ] = useState('');\n  const [ isDropdownExpanded, setIsDropdownExpanded ] = useState(false);\n  const [ isFilterActive, setIsFilterActive ] = useState(true);\n  const [ isEscapeClosed, setIsEscapeClose ] = useState(false);\n  const searchbarRef = useRef();\n  const eventBus = useService('eventBus');\n\n  const {\n    loadState,\n    options\n  } = useOptionsAsync(field);\n\n  useCleanupSingleSelectValue({\n    field,\n    loadState,\n    options,\n    value,\n    onChange: props.onChange\n  });\n\n  const getLabelCorrelation = useGetLabelCorrelation(options);\n\n  const label = useMemo(() => value && getLabelCorrelation(value), [ value, getLabelCorrelation ]);\n\n  // whenever we change the underlying value, set the label to it\n  useEffect(() => { setFilter(label || ''); }, [ label ]);\n\n  const filteredOptions = useMemo(() => {\n\n    if (loadState !== LOAD_STATES.LOADED) {\n      return [];\n    }\n\n    if (!filter || !isFilterActive) {\n      return options;\n    }\n\n    return options.filter((o) => o.label && o.value && (o.label.toLowerCase().includes(filter.toLowerCase())));\n\n  }, [ filter, loadState, options, isFilterActive ]);\n\n  const setValue = useCallback((option) => {\n    setFilter(option && option.label || '');\n    props.onChange({ value: option && option.value || null, field });\n  }, [ field, props ]);\n\n  const displayState = useMemo(() => {\n    const ds = {};\n    ds.componentReady = !disabled && !readonly && loadState === LOAD_STATES.LOADED;\n    ds.displayCross = ds.componentReady && value !== null && value !== undefined;\n    ds.displayDropdown = !disabled && !readonly && isDropdownExpanded && !isEscapeClosed;\n    return ds;\n  }, [ disabled, isDropdownExpanded, isEscapeClosed, loadState, readonly, value ]);\n\n  const onAngelMouseDown = useCallback((e) => {\n    setIsEscapeClose(false);\n    setIsDropdownExpanded(!isDropdownExpanded);\n\n    const searchbar = searchbarRef.current;\n    isDropdownExpanded ? searchbar.blur() : searchbar.focus();\n\n    e.preventDefault();\n\n  }, [ isDropdownExpanded ]);\n\n  const onInputChange = ({ target }) => {\n    setIsEscapeClose(false);\n    setIsDropdownExpanded(true);\n    setIsFilterActive(true);\n    setFilter(target.value || '');\n    eventBus.fire('formField.search', { formField: field, value: target.value || '' });\n  };\n\n  const onInputKeyDown = useCallback((keyDownEvent) => {\n\n    switch (keyDownEvent.key) {\n    case 'ArrowUp':\n      keyDownEvent.preventDefault();\n      break;\n    case 'ArrowDown': {\n      if (!isDropdownExpanded) {\n        setIsDropdownExpanded(true);\n        setIsFilterActive(false);\n      }\n\n      keyDownEvent.preventDefault();\n      break;\n    }\n    case 'Escape':\n      setIsEscapeClose(true);\n      break;\n    case 'Enter':\n      if (isEscapeClosed) {\n        setIsEscapeClose(false);\n      }\n      break;\n    }\n  }, [ isDropdownExpanded, isEscapeClosed ]);\n\n  const onInputMouseDown = useCallback(() => {\n    setIsEscapeClose(false);\n    setIsDropdownExpanded(true);\n    setIsFilterActive(false);\n  }, []);\n\n  const onInputFocus = useCallback(() => {\n    setIsEscapeClose(false);\n    setIsDropdownExpanded(true);\n    onFocus && onFocus();\n  }, [ onFocus ]);\n\n  const onInputBlur = useCallback(() => {\n    setIsDropdownExpanded(false);\n    setFilter(label || '');\n    onBlur && onBlur();\n  }, [ onBlur, label ]);\n\n  return <>\n    <div\n      class={ classNames('fjs-input-group', { 'disabled': disabled, 'readonly': readonly }, { 'hasErrors': errors.length }) }>\n      <input\n        disabled={ disabled }\n        readOnly={ readonly }\n        class=\"fjs-input\"\n        ref={ searchbarRef }\n        id={ domId }\n        onChange={ onInputChange }\n        type=\"text\"\n        value={ filter }\n        placeholder={ 'Search' }\n        autoComplete=\"off\"\n        onKeyDown={ onInputKeyDown }\n        onMouseDown={ onInputMouseDown }\n        onFocus={ onInputFocus }\n        onBlur={ onInputBlur }\n        aria-describedby={ props['aria-describedby'] } />\n      { displayState.displayCross && <span class=\"fjs-select-cross\" onMouseDown={ (e) => { setValue(null); e.preventDefault(); } }><XMarkIcon /> </span> }\n      <span class=\"fjs-select-arrow\" onMouseDown={ (e) => onAngelMouseDown(e) }>{ displayState.displayDropdown ? <AngelUpIcon /> : <AngelDownIcon /> }</span>\n    </div>\n    <div class=\"fjs-select-anchor\">\n      { displayState.displayDropdown && <DropdownList\n        values={ filteredOptions }\n        getLabel={ (o) => o.label }\n        onValueSelected={ (o) => { setValue(o); setIsDropdownExpanded(false); } }\n        listenerElement={ searchbarRef.current } />}\n    </div>\n  </>;\n}\n","import { useCallback, useMemo, useRef, useState } from 'preact/hooks';\nimport classNames from 'classnames';\nimport { findIndex } from 'min-dash';\nimport { useOptionsAsync, LOAD_STATES } from '../../../hooks/useOptionsAsync';\nimport { useCleanupSingleSelectValue } from '../../../hooks/useCleanupSingleSelectValue';\nimport { useGetLabelCorrelation } from '../../../hooks/useGetLabelCorrelation';\n\nimport XMarkIcon from '../icons/XMark.svg';\nimport AngelDownIcon from '../icons/AngelDown.svg';\nimport AngelUpIcon from '../icons/AngelUp.svg';\nimport { DropdownList } from './DropdownList';\n\nexport function SimpleSelect(props) {\n  const {\n    domId,\n    disabled,\n    errors,\n    onBlur,\n    onFocus,\n    field,\n    readonly,\n    value\n  } = props;\n\n  const [ isDropdownExpanded, setIsDropdownExpanded ] = useState(false);\n  const selectRef = useRef();\n  const inputRef = useRef();\n\n  const {\n    loadState,\n    options\n  } = useOptionsAsync(field);\n\n  useCleanupSingleSelectValue({\n    field,\n    loadState,\n    options,\n    value,\n    onChange: props.onChange\n  });\n\n  const getLabelCorrelation = useGetLabelCorrelation(options);\n\n  const valueLabel = useMemo(() => value && getLabelCorrelation(value), [ value, getLabelCorrelation ]);\n\n  const setValue = useCallback((option) => {\n    props.onChange({ value: option && option.value || null, field });\n  }, [ field, props ]);\n\n  const displayState = useMemo(() => {\n    const ds = {};\n    ds.componentReady = !disabled && !readonly && loadState === LOAD_STATES.LOADED;\n    ds.displayCross = ds.componentReady && value !== null && value !== undefined;\n    ds.displayDropdown = !disabled && !readonly && isDropdownExpanded;\n    return ds;\n  }, [ disabled, isDropdownExpanded, loadState, readonly, value ]);\n\n  const onMouseDown = useCallback((e) => {\n\n    const input = inputRef.current;\n\n    if (disabled || !input) {\n      return;\n    }\n\n    setIsDropdownExpanded(!isDropdownExpanded);\n\n    if (isDropdownExpanded) {\n      input.blur();\n    } else {\n      input.focus();\n    }\n\n    e.preventDefault();\n  }, [ disabled, isDropdownExpanded ]);\n\n  const initialFocusIndex = useMemo(() => value && findIndex(options, (o) => o.value === value) || 0, [ options, value ]);\n\n  const onInputFocus = useCallback(() => {\n    if (!readonly) {\n      setIsDropdownExpanded(true);\n      onFocus && onFocus();\n    }\n  }, [ onFocus, readonly ]);\n\n  const onInputBlur = useCallback(() => {\n    if (!readonly) {\n      setIsDropdownExpanded(false);\n      onBlur && onBlur();\n    }\n  }, [ onBlur, readonly ]);\n\n  return <>\n    <div ref={ selectRef }\n      class={ classNames('fjs-input-group', { disabled, readonly }, { 'hasErrors': errors.length }) }\n      onFocus={ onInputFocus }\n      onBlur={ onInputBlur }\n      onMouseDown={ onMouseDown }>\n      <div class={ classNames('fjs-select-display', { 'fjs-select-placeholder' : !value }) } id={ `${domId}-display` }>{ valueLabel || 'Select' }</div>\n      { !disabled && <input\n        ref={ inputRef }\n        id={ domId }\n        class=\"fjs-select-hidden-input\"\n        value={ valueLabel }\n        onFocus={ onInputFocus }\n        onBlur={ onInputBlur }\n        aria-describedby={ props['aria-describedby'] } />\n      }\n      { displayState.displayCross && <span class=\"fjs-select-cross\" onMouseDown={ (e) => { setValue(null); e.stopPropagation(); } }><XMarkIcon /></span> }\n      <span class=\"fjs-select-arrow\">{ displayState.displayDropdown ? <AngelUpIcon /> : <AngelDownIcon /> }</span>\n    </div>\n    <div class=\"fjs-select-anchor\">\n      {displayState.displayDropdown && <DropdownList\n        values={ options }\n        getLabel={ (o) => o.label }\n        initialFocusIndex={ initialFocusIndex }\n        onValueSelected={ (o) => { setValue(o); setIsDropdownExpanded(false); } }\n        listenerElement={ selectRef.current } />}\n    </div>\n  </>;\n}\n","import { Description } from '../Description';\nimport { Errors } from '../Errors';\nimport { Label } from '../Label';\nimport { SearchableSelect } from './parts/SearchableSelect';\nimport { SimpleSelect } from './parts/SimpleSelect';\n\nimport { sanitizeSingleSelectValue } from '../util/sanitizerUtil';\nimport { createEmptyOptions } from '../util/optionsUtil';\nimport { formFieldClasses } from '../Util';\n\nconst type = 'select';\n\nexport function Select(props) {\n  const {\n    disabled,\n    errors = [],\n    domId,\n    onBlur,\n    onFocus,\n    field,\n    onChange,\n    readonly,\n    value\n  } = props;\n\n  const {\n    description,\n    label,\n    searchable = false,\n    validate = {}\n  } = field;\n\n  const { required } = validate;\n\n  const descriptionId = `${domId}-description`;\n  const errorMessageId = `${domId}-error-message`;\n\n  const selectProps = {\n    domId,\n    disabled,\n    errors,\n    onBlur,\n    onFocus,\n    field,\n    value,\n    onChange,\n    readonly,\n    required,\n    'aria-invalid': errors.length > 0,\n    'aria-describedby': [ descriptionId, errorMessageId ].join(' '),\n  };\n\n  return <div\n    class={ formFieldClasses(type, { errors, disabled, readonly }) }\n    onKeyDown={\n      (event) => {\n        if (event.key === 'Enter') {\n          event.preventDefault();\n          event.stopPropagation();\n        }\n      }\n    }\n  >\n    <Label\n      htmlFor={ domId }\n      label={ label }\n      required={ required } />\n    { searchable ? <SearchableSelect { ...selectProps } /> : <SimpleSelect { ...selectProps } /> }\n    <Description id={ descriptionId } description={ description } />\n    <Errors id={ errorMessageId } errors={ errors } />\n  </div>;\n}\n\nSelect.config = {\n  type,\n  keyed: true,\n  label: 'Select',\n  group: 'selection',\n  emptyValue: null,\n  sanitizeValue: sanitizeSingleSelectValue,\n  create: createEmptyOptions\n};\n","import { formFieldClasses } from '../Util';\n\nconst type = 'separator';\n\nexport function Separator() {\n\n  return (\n    <div class={ formFieldClasses(type) }>\n      <hr />\n    </div>\n  );\n}\n\nSeparator.config = {\n  type,\n  keyed: false,\n  label: 'Separator',\n  group: 'presentation',\n  create: (options = {}) => ({\n    ...options\n  })\n};\n","import { formFieldClasses } from '../Util';\n\nconst type = 'spacer';\n\nexport function Spacer(props) {\n  const { field } = props;\n  const { height = 60 } = field;\n\n  return (\n    <div class={ formFieldClasses(type) } style={ { height: height } } />\n  );\n}\n\nSpacer.config = {\n  type,\n  keyed: false,\n  label: 'Spacer',\n  group: 'presentation',\n  create: (options = {}) => ({\n    height: 60,\n    ...options\n  })\n};\n","import { useContext } from 'preact/hooks';\nimport { FormRenderContext } from '../../context';\nimport { formFieldClasses } from '../Util';\nimport classNames from 'classnames';\n\nimport { Label } from '../Label';\nimport { ChildrenRenderer } from './parts/ChildrenRenderer';\n\nexport function DynamicList(props) {\n\n  const { field, domId, readonly } = props;\n  const { label, type, showOutline } = field;\n\n  const {\n    Empty,\n  } = useContext(FormRenderContext);\n\n  const fullProps = { ...props, Empty };\n\n  return (\n    <div\n      className={\n        classNames(\n          formFieldClasses(type, { readonly }),\n          'fjs-form-field-grouplike',\n          {\n            'fjs-outlined' : showOutline\n          }\n        )\n      }\n      role=\"group\"\n      aria-labelledby={ domId }\n    >\n      <Label\n        id={ domId }\n        label={ label } />\n      <ChildrenRenderer { ...fullProps } />\n    </div>\n  );\n}\n\nDynamicList.config = {\n  type: 'dynamiclist',\n  pathed: true,\n  repeatable: true,\n  label: 'Dynamic list',\n  group: 'container',\n  create: (options = {}) => ({\n    components: [],\n    showOutline: true,\n    isRepeating: true,\n    allowAddRemove: true,\n    defaultRepetitions: 1,\n    ...options\n  })\n};\n","import classNames from 'classnames';\n\nimport { useCallback } from 'preact/hooks';\n\nexport function SkipLink(props) {\n\n  const {\n    className,\n    label,\n    onSkip\n  } = props;\n\n  const onKeyDown = useCallback(event => {\n    if (event.key === 'Enter') {\n      event.preventDefault();\n      event.stopPropagation();\n      onSkip();\n    }\n  }, [ onSkip ]);\n\n\n  return (\n    <a\n      href=\"#\"\n      class={ classNames('fjs-skip-link', className) }\n      onKeyDown={ onKeyDown }\n    >{ label }</a>\n  );\n}","import { useMemo, useRef, useState } from 'preact/hooks';\n\nimport {\n  useDeepCompareMemoize,\n  useService,\n  useOptionsAsync,\n  useCleanupMultiSelectValue,\n  useGetLabelCorrelation,\n  LOAD_STATES\n} from '../../hooks';\n\nimport XMarkIcon from './icons/XMark.svg';\nimport { DropdownList } from './parts/DropdownList';\nimport { Description } from '../Description';\nimport { Errors } from '../Errors';\nimport { Label } from '../Label';\nimport { SkipLink } from './parts/SkipLink';\n\nimport classNames from 'classnames';\nimport isEqual from 'lodash/isEqual';\nimport { sanitizeMultiSelectValue, hasEqualValue } from '../util/sanitizerUtil';\nimport { createEmptyOptions } from '../util/optionsUtil';\nimport { formFieldClasses } from '../Util';\n\nconst type = 'taglist';\n\nexport function Taglist(props) {\n  const {\n    disabled,\n    errors = [],\n    onFocus,\n    domId,\n    onBlur,\n    field,\n    readonly,\n    value\n  } = props;\n\n  const {\n    description,\n    label,\n    validate = {}\n  } = field;\n\n  const { required } = validate;\n\n  const [ filter, setFilter ] = useState('');\n  const [ isDropdownExpanded, setIsDropdownExpanded ] = useState(false);\n  const [ isEscapeClosed, setIsEscapeClose ] = useState(false);\n  const focusScopeRef = useRef();\n  const inputRef = useRef();\n  const eventBus = useService('eventBus');\n\n  const {\n    loadState,\n    options\n  } = useOptionsAsync(field);\n\n  // ensures we render based on array content instead of reference\n  const values = useDeepCompareMemoize(value || []);\n\n  useCleanupMultiSelectValue({\n    field,\n    loadState,\n    options,\n    values,\n    onChange: props.onChange\n  });\n\n  const getLabelCorrelation = useGetLabelCorrelation(options);\n\n  const hasOptionsLeft = useMemo(() => options.length > values.length, [ options.length, values.length ]);\n\n  const filteredOptions = useMemo(() => {\n    if (loadState !== LOAD_STATES.LOADED) {\n      return [];\n    }\n\n    const isValidFilteredOption = (option) => {\n      const filterMatches = option.label.toLowerCase().includes(filter.toLowerCase());\n      return filterMatches && !hasEqualValue(option.value, values);\n    };\n\n    return options.filter(isValidFilteredOption);\n  }, [ filter, options, values, loadState ]);\n\n\n  const selectValue = (value) => {\n\n    setFilter('');\n\n    // Ensure values cannot be double selected due to latency\n    if (values.at(-1) === value) {\n      return;\n    }\n\n    props.onChange({ value: [ ...values, value ], field });\n  };\n\n  const deselectValue = (value) => {\n    const newValues = values.filter((v) => !isEqual(v, value));\n    props.onChange({ value: newValues, field });\n  };\n\n  const onInputChange = ({ target }) => {\n    setIsEscapeClose(false);\n    setFilter(target.value || '');\n    eventBus.fire('formField.search', { formField: field, value: target.value || '' });\n  };\n\n  const onInputKeyDown = (e) => {\n\n    switch (e.key) {\n    case 'ArrowUp':\n    case 'ArrowDown':\n\n      // We do not want the cursor to seek in the search field when we press up and down\n      e.preventDefault();\n      break;\n    case 'Backspace':\n      if (!filter && values.length) {\n        deselectValue(values[values.length - 1]);\n      }\n      break;\n    case 'Escape':\n      setIsEscapeClose(true);\n      break;\n    case 'Enter':\n      if (isEscapeClosed) {\n        setIsEscapeClose(false);\n      }\n      break;\n    }\n  };\n\n  const onElementBlur = (e) => {\n    if (focusScopeRef.current.contains(e.relatedTarget)) return;\n    onBlur && onBlur();\n  };\n\n  const onElementFocus = (e) => {\n    if (focusScopeRef.current.contains(e.relatedTarget)) return;\n    onFocus && onFocus();\n  };\n\n  const onInputBlur = (e) => {\n    if (!readonly) {\n      setIsDropdownExpanded(false);\n      setFilter('');\n    }\n    onElementBlur(e);\n  };\n\n  const onInputFocus = (e) => {\n    if (!readonly) {\n      setIsDropdownExpanded(true);\n    }\n    onElementFocus(e);\n  };\n\n  const onTagRemoveClick = (event, value) => {\n    const { target } = event;\n\n    deselectValue(value);\n\n    // restore focus if there is no next sibling to focus\n    const nextTag = target.closest('.fjs-taglist-tag').nextSibling;\n    if (!nextTag) {\n      inputRef.current.focus();\n    }\n  };\n\n  const onSkipToSearch = () => {\n    inputRef.current.focus();\n  };\n\n  const shouldDisplayDropdown = useMemo(() => !disabled && loadState === LOAD_STATES.LOADED && isDropdownExpanded && !isEscapeClosed, [ disabled, isDropdownExpanded, isEscapeClosed, loadState ]);\n\n  const descriptionId = `${domId}-description`;\n  const errorMessageId = `${domId}-error-message`;\n\n  return <div\n    ref={ focusScopeRef }\n    class={ formFieldClasses(type, { errors, disabled, readonly }) }\n    onKeyDown={\n      (event) => {\n        if (event.key === 'Enter') {\n          event.stopPropagation();\n          event.preventDefault();\n        }\n      }\n    }\n  >\n    <Label\n      label={ label }\n      required={ required }\n      htmlFor={ domId } />\n    { (!disabled && !readonly && !!values.length) && <SkipLink className=\"fjs-taglist-skip-link\" label=\"Skip to search\" onSkip={ onSkipToSearch } /> }\n    <div class={ classNames('fjs-taglist', { 'fjs-disabled': disabled, 'fjs-readonly': readonly }) }>\n      { loadState === LOAD_STATES.LOADED &&\n        <div class=\"fjs-taglist-tags\">\n          {\n            values.map((v) => {\n              return (\n                <div class={ classNames('fjs-taglist-tag', { 'fjs-disabled': disabled, 'fjs-readonly': readonly }) } onMouseDown={ (e) => e.preventDefault() }>\n                  <span class=\"fjs-taglist-tag-label\">\n                    { getLabelCorrelation(v) }\n                  </span>\n                  { (!disabled && !readonly) && <button\n                    type=\"button\"\n                    title=\"Remove tag\"\n                    class=\"fjs-taglist-tag-remove\"\n                    onFocus={ onElementFocus }\n                    onBlur={ onElementBlur }\n                    onClick={ (event) => onTagRemoveClick(event, v) }>\n\n                    <XMarkIcon />\n                  </button> }\n                </div>\n              );\n            })\n          }\n        </div>\n      }\n      <input\n        disabled={ disabled }\n        readOnly={ readonly }\n        class=\"fjs-taglist-input\"\n        ref={ inputRef }\n        id={ domId }\n        onChange={ onInputChange }\n        type=\"text\"\n        value={ filter }\n        placeholder={ (disabled || readonly) ? undefined : 'Search' }\n        autoComplete=\"off\"\n        onKeyDown={ onInputKeyDown }\n        onMouseDown={ () => setIsEscapeClose(false) }\n        onFocus={ onInputFocus }\n        onBlur={ onInputBlur }\n        aria-describedby={ [ descriptionId, errorMessageId ].join(' ') }\n        required={ required }\n        aria-invalid={ errors.length > 0 } />\n    </div>\n    <div class=\"fjs-taglist-anchor\">\n      { shouldDisplayDropdown && <DropdownList\n        values={ filteredOptions }\n        getLabel={ (o) => o.label }\n        onValueSelected={ (o) => selectValue(o.value) }\n        emptyListMessage={ hasOptionsLeft ? 'No results' : 'All values selected' }\n        listenerElement={ inputRef.current } /> }\n    </div>\n    <Description id={ descriptionId } description={ description } />\n    <Errors id={ errorMessageId } errors={ errors } />\n  </div>;\n}\n\nTaglist.config = {\n  type,\n  keyed: true,\n  label: 'Tag list',\n  group: 'selection',\n  emptyValue: [],\n  sanitizeValue: sanitizeMultiSelectValue,\n  create: createEmptyOptions\n};\n","const NODE_TYPE_TEXT = 3,\n      NODE_TYPE_ELEMENT = 1;\n\nconst ALLOWED_NODES = [\n  'h1',\n  'h2',\n  'h3',\n  'h4',\n  'h5',\n  'h6',\n  'span',\n  'em',\n  'a',\n  'p',\n  'div',\n  'ul',\n  'ol',\n  'li',\n  'hr',\n  'blockquote',\n  'img',\n  'pre',\n  'code',\n  'br',\n  'strong',\n  'table',\n  'thead',\n  'tbody',\n  'tr',\n  'th',\n  'td'\n];\n\nconst ALLOWED_ATTRIBUTES = [\n  'align',\n  'alt',\n  'class',\n  'href',\n  'id',\n  'name',\n  'rel',\n  'target',\n  'src'\n];\n\nconst ALLOWED_URI_PATTERN = /^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\\-]+(?:[^a-z+.\\-:]|$))/i; // eslint-disable-line no-useless-escape\nconst ATTR_WHITESPACE_PATTERN = /[\\u0000-\\u0020\\u00A0\\u1680\\u180E\\u2000-\\u2029\\u205F\\u3000]/g; // eslint-disable-line no-control-regex\n\nconst FORM_ELEMENT = document.createElement('form');\n\n/**\n * Sanitize a HTML string and return the cleaned, safe version.\n *\n * @param {string} html\n * @return {string}\n */\n\n// see https://github.com/developit/snarkdown/issues/70\nexport function sanitizeHTML(html) {\n\n  const doc = new DOMParser().parseFromString(\n    `<!DOCTYPE html>\\n<html><body><div>${ html }`,\n    'text/html'\n  );\n\n  doc.normalize();\n\n  const element = doc.body.firstChild;\n\n  if (element) {\n\n    sanitizeNode(/** @type Element */ (element));\n    return /** @type Element */ (element).innerHTML;\n\n  } else {\n\n    // handle the case that document parsing\n    // does not work at all, due to HTML gibberish\n    return '';\n  }\n}\n\n/**\n * Recursively sanitize a HTML node, potentially\n * removing it, its children or attributes.\n *\n * Inspired by https://github.com/developit/snarkdown/issues/70\n * and https://github.com/cure53/DOMPurify. Simplified\n * for our use-case.\n *\n * @param {Element} node\n */\nfunction sanitizeNode(node) {\n\n  // allow text nodes\n  if (node.nodeType === NODE_TYPE_TEXT) {\n    return;\n  }\n\n  // disallow all other nodes but Element\n  if (node.nodeType !== NODE_TYPE_ELEMENT) {\n    return node.remove();\n  }\n\n  const lcTag = node.tagName.toLowerCase();\n\n  // disallow non-whitelisted tags\n  if (!ALLOWED_NODES.includes(lcTag)) {\n    return node.remove();\n  }\n\n  const attributes = node.attributes;\n\n  // clean attributes\n  for (let i = attributes.length; i--;) {\n    const attribute = attributes[i];\n\n    const name = attribute.name;\n    const lcName = name.toLowerCase();\n\n    // normalize node value\n    const value = attribute.value.trim();\n\n    node.removeAttribute(name);\n\n    const valid = isValidAttribute(lcTag, lcName, value);\n\n    if (valid) {\n      node.setAttribute(name, value);\n    }\n\n  }\n\n  // force noopener on target=\"_blank\" links\n  if (lcTag === 'a' && node.getAttribute('target') === '_blank' && node.getAttribute('rel') !== 'noopener') {\n    node.setAttribute('rel', 'noopener');\n  }\n\n  for (let i = node.childNodes.length; i--;) {\n    sanitizeNode(/** @type Element */ (node.childNodes[i]));\n  }\n}\n\n\n/**\n * Validates attributes for validity.\n *\n * @param {string} lcTag\n * @param {string} lcName\n * @param {string} value\n * @return {boolean}\n */\nfunction isValidAttribute(lcTag, lcName, value) {\n\n  // disallow most attributes based on whitelist\n  if (!ALLOWED_ATTRIBUTES.includes(lcName)) {\n    return false;\n  }\n\n  // disallow \"DOM clobbering\" / polution of document and wrapping form elements\n  if ((lcName === 'id' || lcName === 'name') && (value in document || value in FORM_ELEMENT)) {\n    return false;\n  }\n\n  if (lcName === 'target' && value !== '_blank') {\n    return false;\n  }\n\n  // allow valid url links only\n  if (lcName === 'href' && !ALLOWED_URI_PATTERN.test(value.replace(ATTR_WHITESPACE_PATTERN, ''))) {\n    return false;\n  }\n\n  return true;\n}","import { useCallback, useMemo } from 'preact/hooks';\nimport { useDangerousHTMLWrapper, useService, useTemplateEvaluation } from '../../hooks';\nimport { sanitizeHTML } from '../Sanitizer';\n\nimport {\n  formFieldClasses\n} from '../Util';\n\nconst type = 'text';\n\nexport function Text(props) {\n\n  const form = useService('form');\n  const { textLinkTarget } = form._getState().properties;\n\n  const { field, disableLinks } = props;\n\n  const { text = '', strict = false } = field;\n\n  const markdownRenderer = useService('markdownRenderer');\n\n  // feelers => pure markdown\n  const markdown = useTemplateEvaluation(text, { debug: true, strict });\n\n  // markdown => html\n  const html = useMemo(() => markdownRenderer.render(markdown), [ markdownRenderer, markdown ]);\n\n  const sanitizeAndTransformLinks = useCallback((unsafeHtml) => {\n\n    const html = sanitizeHTML(unsafeHtml);\n\n    const tempDiv = document.createElement('div');\n    tempDiv.innerHTML = html;\n\n    const links = tempDiv.querySelectorAll('a');\n\n    links.forEach(link => {\n\n      if (disableLinks) {\n        link.setAttribute('class', 'fjs-disabled-link');\n        link.setAttribute('tabIndex', '-1');\n      }\n\n      if (textLinkTarget) {\n        link.setAttribute('target', textLinkTarget);\n      }\n\n    });\n\n    return tempDiv.innerHTML;\n\n  }, [ disableLinks, textLinkTarget ]);\n\n  const dangerouslySetInnerHTML = useDangerousHTMLWrapper({\n    html,\n    transform: sanitizeAndTransformLinks,\n    sanitize: false,\n    sanitizeStyleTags: false\n  });\n\n  return <div class={ formFieldClasses(type) } dangerouslySetInnerHTML={ dangerouslySetInnerHTML }></div>;\n}\n\nText.config = {\n  type,\n  keyed: false,\n  label: 'Text view',\n  group: 'presentation',\n  create: (options = {}) => ({\n    text: '# Text',\n    ...options\n  })\n};\n","/**\n * Wrap CSS styles with a given prefix.\n *\n * @param {HTMLElement} rootNode\n * @param {string} prefix\n *\n * @returns {HTMLElement}\n */\nfunction wrapCSSStyles(rootNode, prefix) {\n  const styleTags = rootNode.querySelectorAll('style');\n  styleTags.forEach(styleTag => {\n    const topLevelRules = extractTopLevelRules(styleTag.textContent);\n    const scopedCss = topLevelRules\n      .map(rule => {\n        const { selector, styles } = splitRule(rule);\n        const scopedSelector = scopeSelector(selector, prefix);\n        return `${scopedSelector} ${styles}`;\n      })\n      .join(' ');\n    styleTag.textContent = scopedCss;\n  });\n\n  return rootNode;\n}\n\nfunction extractTopLevelRules(cssString) {\n  let cursor = 0;\n  let start = 0;\n  let level = 0;\n  const topLevelRules = [];\n\n  while (cursor < cssString.length) {\n    if (cssString[cursor] === '{') {\n      level++;\n    }\n\n    if (cssString[cursor] === '}') {\n      level--;\n      if (level === 0) {\n        topLevelRules.push(cssString.substring(start, cursor + 1));\n        start = cursor + 1;\n      }\n    }\n\n    cursor++;\n  }\n\n  return topLevelRules.map(rule => rule.trim());\n}\n\nfunction splitRule(rule) {\n  const firstBracket = rule.indexOf('{');\n  const selector = rule.substring(0, firstBracket);\n  const styles = rule.substring(firstBracket);\n  return { selector, styles };\n}\n\nfunction scopeSelector(selector, prefix) {\n  return selector\n    .split(',')\n    .map(sel => `${prefix} ${sel.trim()}`)\n    .join(', ');\n}\n\nexport { wrapCSSStyles };","import { useCallback } from 'preact/hooks';\nimport { useService, useTemplateEvaluation, useDangerousHTMLWrapper } from '../../hooks';\nimport { escapeHTML } from '../util/sanitizerUtil';\nimport { wrapCSSStyles } from '../util/domUtil';\n\nimport {\n  formFieldClasses\n} from '../Util';\nimport classNames from 'classnames';\n\nconst type = 'html';\n\nexport function Html(props) {\n\n  const form = useService('form');\n  const { textLinkTarget } = form._getState().properties;\n\n  const { field, disableLinks, domId } = props;\n\n  const { content = '', strict = false } = field;\n\n  const styleScope = `${domId}-style-scope`;\n\n  // we escape HTML within the template evaluation to prevent clickjacking attacks\n  const html = useTemplateEvaluation(content, { debug: true, strict, sanitizer: escapeHTML });\n\n  const transform = useCallback((html) => {\n\n    const tempDiv = document.createElement('div');\n    tempDiv.innerHTML = html;\n\n    // (1) apply modifications to links\n\n    const links = tempDiv.querySelectorAll('a');\n\n    links.forEach(link => {\n\n      if (disableLinks) {\n        link.setAttribute('class', 'fjs-disabled-link');\n        link.setAttribute('tabIndex', '-1');\n      }\n\n      if (textLinkTarget) {\n        link.setAttribute('target', textLinkTarget);\n      }\n\n    });\n\n    // (2) scope styles to the root div\n    wrapCSSStyles(tempDiv, `.${styleScope}`);\n\n    return tempDiv.innerHTML;\n\n  }, [ disableLinks, styleScope, textLinkTarget ]);\n\n  const dangerouslySetInnerHTML = useDangerousHTMLWrapper({\n    html,\n    transform,\n    sanitize: true,\n    sanitizeStyleTags: false\n  });\n\n  return <div class={ classNames(formFieldClasses(type), styleScope) } dangerouslySetInnerHTML={ dangerouslySetInnerHTML }></div>;\n}\n\nHtml.config = {\n  type,\n  keyed: false,\n  label: 'HTML',\n  group: 'presentation',\n  create: (options = {}) => ({\n    content: '',\n    ...options\n  })\n};\n","import { isArray, isObject, isNil } from 'min-dash';\nimport { formFieldClasses } from '../Util';\n\nimport { Description } from '../Description';\nimport { Errors } from '../Errors';\nimport { Label } from '../Label';\nimport { TemplatedInputAdorner } from './parts/TemplatedInputAdorner';\n\nimport { useFlushDebounce } from '../../hooks/useFlushDebounce';\n\nconst type = 'textfield';\n\nexport function Textfield(props) {\n  const {\n    disabled,\n    errors = [],\n    domId,\n    onBlur,\n    onFocus,\n    field,\n    readonly,\n    value = ''\n  } = props;\n\n  const {\n    description,\n    label,\n    appearance = {},\n    validate = {}\n  } = field;\n\n  const {\n    prefixAdorner,\n    suffixAdorner\n  } = appearance;\n\n  const { required } = validate;\n\n  const [ onInputChange, flushOnChange ] = useFlushDebounce(({ target }) => {\n    props.onChange({\n      field,\n      value: target.value\n    });\n  });\n\n  const onInputBlur = () => {\n    flushOnChange && flushOnChange();\n    onBlur && onBlur();\n  };\n\n  const onInputFocus = () => {\n    onFocus && onFocus();\n  };\n\n  const descriptionId = `${domId}-description`;\n  const errorMessageId = `${domId}-error-message`;\n\n  return <div class={ formFieldClasses(type, { errors, disabled, readonly }) }>\n    <Label\n      htmlFor={ domId }\n      label={ label }\n      required={ required } />\n    <TemplatedInputAdorner disabled={ disabled } readonly={ readonly } pre={ prefixAdorner } post={ suffixAdorner }>\n      <input\n        class=\"fjs-input\"\n        disabled={ disabled }\n        readOnly={ readonly }\n        id={ domId }\n        onInput={ onInputChange }\n        onBlur={ onInputBlur }\n        onFocus={ onInputFocus }\n        type=\"text\"\n        value={ value }\n        aria-describedby={ [ descriptionId, errorMessageId ].join(' ') }\n        required={ required }\n        aria-invalid={ errors.length > 0 } />\n    </TemplatedInputAdorner>\n    <Description id={ descriptionId } description={ description } />\n    <Errors id={ errorMessageId } errors={ errors } />\n  </div>;\n}\n\nTextfield.config = {\n  type,\n  keyed: true,\n  label: 'Text field',\n  group: 'basic-input',\n  emptyValue: '',\n  sanitizeValue: ({ value }) => {\n    if (isArray(value) || isObject(value) || isNil(value)) {\n      return '';\n    }\n\n    // sanitize newlines to spaces\n    if (typeof value === 'string') {\n      return value.replace(/[\\r\\n\\t]/g, ' ');\n    }\n\n    return String(value);\n  },\n  create: (options = {}) => ({ ...options })\n};\n","import { isArray, isObject, isNil } from 'min-dash';\n\nimport { useEffect, useLayoutEffect, useRef } from 'preact/hooks';\nimport { useFlushDebounce } from '../../hooks/useFlushDebounce';\n\nimport { formFieldClasses } from '../Util';\n\nimport { Description } from '../Description';\nimport { Errors } from '../Errors';\nimport { Label } from '../Label';\n\nconst type = 'textarea';\n\nexport function Textarea(props) {\n  const {\n    disabled,\n    errors = [],\n    domId,\n    onBlur,\n    onFocus,\n    field,\n    readonly,\n    value = ''\n  } = props;\n\n  const {\n    description,\n    label,\n    validate = {}\n  } = field;\n\n  const { required } = validate;\n  const textareaRef = useRef();\n\n  const [ onChange, flushOnChange ] = useFlushDebounce(({ target }) => {\n    props.onChange({\n      field,\n      value: target.value\n    });\n  });\n\n  const onInputBlur = () => {\n    flushOnChange && flushOnChange();\n    onBlur && onBlur();\n  };\n\n  const onInputFocus = () => {\n    onFocus && onFocus();\n  };\n\n  const onInputChange = (event) => {\n    onChange({ target: event.target });\n    autoSizeTextarea(textareaRef.current);\n  };\n\n  useLayoutEffect(() => {\n    autoSizeTextarea(textareaRef.current);\n  }, [ value ]);\n\n  useEffect(() => {\n    autoSizeTextarea(textareaRef.current);\n  }, []);\n\n  const descriptionId = `${domId}-description`;\n  const errorMessageId = `${domId}-error-message`;\n\n  return <div class={ formFieldClasses(type, { errors, disabled, readonly }) }>\n    <Label\n      htmlFor={ domId }\n      label={ label }\n      required={ required } />\n    <textarea class=\"fjs-textarea\"\n      disabled={ disabled }\n      readonly={ readonly }\n      id={ domId }\n      onInput={ onInputChange }\n      onBlur={ onInputBlur }\n      onFocus={ onInputFocus }\n      value={ value }\n      ref={ textareaRef }\n      aria-describedby={ [ descriptionId, errorMessageId ].join(' ') }\n      required={ required }\n      aria-invalid={ errors.length > 0 } />\n    <Description id={ descriptionId } description={ description } />\n    <Errors id={ errorMessageId } errors={ errors } />\n  </div>;\n}\n\nTextarea.config = {\n  type,\n  keyed: true,\n  label: 'Text area',\n  group: 'basic-input',\n  emptyValue: '',\n  sanitizeValue: ({ value }) => (isArray(value) || isObject(value) || isNil(value)) ? '' : String(value),\n  create: (options = {}) => ({ ...options })\n};\n\nconst autoSizeTextarea = (textarea) => {\n\n  // Ensures the textarea shrinks back, and improves resizing behavior consistency\n  textarea.style.height = '0px';\n\n  const computed = window.getComputedStyle(textarea);\n\n  const heightFromLines = () => {\n    const lineHeight = parseInt(computed.getPropertyValue('line-height').replace('px', '')) || 0;\n    const lines = textarea.value ? textarea.value.toString().split('\\n').length : 0;\n    return lines * lineHeight;\n  };\n\n  const calculatedHeight = parseInt(computed.getPropertyValue('border-top-width'))\n    + parseInt(computed.getPropertyValue('padding-top'))\n    + (textarea.scrollHeight || heightFromLines())\n    + parseInt(computed.getPropertyValue('padding-bottom'))\n    + parseInt(computed.getPropertyValue('border-bottom-width'));\n\n  const minHeight = 75;\n  const maxHeight = 350;\n  const displayHeight = Math.max(Math.min(calculatedHeight || 0, maxHeight), minHeight);\n\n  textarea.style.height = `${displayHeight}px`;\n\n  // Overflow is hidden by default to hide scrollbar flickering\n  textarea.style.overflow = calculatedHeight > maxHeight ? 'visible' : 'hidden';\n\n};\n","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 32 32\"><path fill=\"currentcolor\" d=\"M24.59 16.59 17 24.17V4h-2v20.17l-7.59-7.58L6 18l10 10 10-10-1.41-1.41z\"/></svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 32 32\"><path fill=\"currentcolor\" d=\"M16 4 6 14l1.41 1.41L15 7.83V28h2V7.83l7.59 7.58L26 14 16 4z\"/></svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" xml:space=\"preserve\" viewBox=\"0 0 32 32\"><path fill=\"currentcolor\" d=\"m20 24-10-8 10-8z\"/></svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" xml:space=\"preserve\" viewBox=\"0 0 32 32\"><path fill=\"currentcolor\" d=\"m12 8 10 8-10 8z\"/></svg>","import { isDefined, isNumber, isObject, isString } from 'min-dash';\nimport { useExpressionEvaluation } from '../../hooks';\nimport { useEffect, useState } from 'preact/hooks';\nimport { formFieldClasses, prefixId } from '../Util';\nimport classNames from 'classnames';\n\nimport { Label } from '../Label';\nimport ArrowDownIcon from './icons/ArrowDown.svg';\nimport ArrowUpIcon from './icons/ArrowUp.svg';\nimport CaretLeftIcon from './icons/CaretLeft.svg';\nimport CaretRightIcon from './icons/CaretRight.svg';\n\nconst type = 'table';\n\n/**\n * @typedef {('asc'|'desc')} Direction\n *\n * @typedef Sorting\n * @property {string} key\n * @property {Direction} direction\n *\n * @typedef Column\n * @property {string} label\n * @property {string} key\n *\n * @typedef Field\n * @property {string} id\n * @property {Array<Column>} [columns]\n * @property {string} [columnsExpression]\n * @property {string} [label]\n * @property {number} [rowCount]\n * @property {string} [dataSource]\n *\n * @typedef Props\n * @property {Field} field\n *\n * @param {Props} props\n * @returns {import(\"preact\").JSX.Element}\n */\nexport function Table(props) {\n  const { field } = props;\n  const {\n    columns = [],\n    columnsExpression,\n    dataSource = '',\n    rowCount,\n    id,\n    label,\n  } = field;\n\n  /** @type {[(null|Sorting), import(\"preact/hooks\").StateUpdater<null|Sorting>]} */\n  const [ sortBy, setSortBy ] = useState(null);\n  const evaluatedColumns = useEvaluatedColumns(\n    columnsExpression || '',\n    columns,\n  );\n  const columnKeys = evaluatedColumns.map(({ key }) => key);\n  const evaluatedDataSource = useExpressionEvaluation(dataSource);\n  const data = Array.isArray(evaluatedDataSource) ? evaluatedDataSource : [];\n  const sortedData =\n    sortBy === null\n      ? data\n      : sortByColumn(data, sortBy.key, sortBy.direction);\n\n  /** @type {unknown[][]} */\n  const chunkedData = isNumber(rowCount) ? chunk(sortedData, rowCount) : [ sortedData ];\n  const [ currentPage, setCurrentPage ] = useState(0);\n  const currentChunk = chunkedData[currentPage] || [];\n\n\n  useEffect(() => {\n    setCurrentPage(0);\n  }, [ rowCount, sortBy ]);\n\n\n  /** @param {string} key */\n  function toggleSortBy(key) {\n    setSortBy((current) => {\n      if (current === null || current.key !== key) {\n        return {\n          key,\n          direction: 'asc',\n        };\n      }\n\n      if (current.direction === 'desc') {\n        return null;\n      }\n\n      return {\n        key,\n        direction: 'desc',\n      };\n    });\n  }\n\n  return (\n    <div class={ formFieldClasses(type) }>\n      <Label htmlFor={ prefixId(id) } label={ label } />\n      <div\n        class={ classNames('fjs-table-middle-container', {\n          'fjs-table-empty': evaluatedColumns.length === 0,\n        }) }\n      >\n        {evaluatedColumns.length === 0 ? (\n          'Nothing to show.'\n        ) : (\n          <div class=\"fjs-table-inner-container\">\n            <table class=\"fjs-table\" id={ prefixId(id) }>\n              <thead class=\"fjs-table-head\">\n                <tr class=\"fjs-table-tr\">\n                  {evaluatedColumns.map(({ key, label }) => {\n                    const displayLabel = label || key;\n\n                    return (\n                      <th\n                        key={ key }\n                        tabIndex={ 0 }\n                        class=\"fjs-table-th\"\n                        onClick={ () => {\n                          toggleSortBy(key);\n                        } }\n                        onKeyDown={ (event) => {\n                          if ([ 'Enter', 'Space' ].includes(event.code)) {\n                            toggleSortBy(key);\n                          }\n                        } }\n                        aria-label={ getHeaderAriaLabel(\n                          sortBy,\n                          key,\n                          displayLabel,\n                        ) }\n                      >\n                        <span\n                          class=\"fjs-table-th-label\"\n                        >\n                          {displayLabel}\n                          {sortBy !== null && sortBy.key === key ? (\n                            <>\n                              {sortBy.direction === 'asc' ? (\n                                <ArrowUpIcon class=\"fjs-table-sort-icon-asc\" />\n                              ) : (\n                                <ArrowDownIcon class=\"fjs-table-sort-icon-desc\" />\n                              )}\n                            </>\n                          ) : null}\n                        </span>\n                      </th>\n                    );\n                  })}\n                </tr>\n              </thead>\n              {currentChunk.length === 0 ? (\n                <tbody class=\"fjs-table-body\">\n                  <tr class=\"fjs-table-tr\">\n                    <td class=\"fjs-table-td\" colSpan={ evaluatedColumns.length }>\n                      Nothing to show.\n                    </td>\n                  </tr>\n                </tbody>\n              ) : (\n                <tbody class=\"fjs-table-body\">\n                  {currentChunk.map((row, index) => (\n                    <tr key={ index } class=\"fjs-table-tr\">\n                      {columnKeys.map((key) => (\n                        <td key={ key } class=\"fjs-table-td\">\n                          {row[key]}\n                        </td>\n                      ))}\n                    </tr>\n                  ))}\n                </tbody>\n              )}\n            </table>\n          </div>\n        )}\n\n        {(isNumber(rowCount) && chunkedData.length > 1 && evaluatedColumns.length > 0) ?\n          (\n            <nav class=\"fjs-table-nav\">\n              <span class=\"fjs-table-nav-label\">\n                {currentPage + 1} of {chunkedData.length}\n              </span>\n              <button\n                type=\"button\"\n                class=\"fjs-table-nav-button\"\n                onClick={ () => {\n                  setCurrentPage((page) => Math.max(page - 1, 0));\n                } }\n                disabled={ currentPage === 0 }\n                aria-label=\"Previous page\"\n              >\n                <CaretLeftIcon />\n              </button>\n              <button\n                type=\"button\"\n                class=\"fjs-table-nav-button\"\n                onClick={ () => {\n                  setCurrentPage((page) =>\n                    Math.min(page + 1, chunkedData.length - 1),\n                  );\n                } }\n                disabled={ currentPage >= chunkedData.length - 1 }\n                aria-label=\"Next page\"\n              >\n                <CaretRightIcon />\n              </button>\n            </nav>\n          ) : null}\n      </div>\n    </div>\n  );\n}\n\nTable.config = {\n  type,\n  keyed: false,\n  label: 'Table',\n  group: 'presentation',\n  create: (options = {}) => {\n    const {\n      id,\n      columnsExpression,\n      columns,\n      rowCount,\n      ...remainingOptions\n    } = options;\n\n    if (isDefined(id) && isNumber(rowCount)) {\n      remainingOptions['rowCount'] = rowCount;\n    }\n\n    if (isString(columnsExpression)) {\n      return {\n        ...remainingOptions,\n        id,\n        columnsExpression,\n      };\n    }\n\n    if (Array.isArray(columns) && columns.every(isColumn)) {\n      return {\n        ...remainingOptions,\n        id,\n        columns,\n      };\n    }\n\n    return {\n      ...remainingOptions,\n      rowCount: 10,\n      columns: [\n        {\n          label: 'ID',\n          key: 'id',\n        },\n        {\n          label: 'Name',\n          key: 'name',\n        },\n        {\n          label: 'Date',\n          key: 'date',\n        },\n      ],\n    };\n  },\n\n  /**\n   * @experimental\n   *\n   * A function that generates demo data for a new field on the form playground.\n   * @param {Field} field\n   */\n  generateInitialDemoData: (field) => {\n    const demoData = [\n      { id: 1, name: 'John Doe', date: '31.01.2023' },\n      { id: 2, name: 'Erika Muller', date: '20.02.2023' },\n      { id: 3, name: 'Dominic Leaf', date: '11.03.2023' }\n    ];\n    const demoDataKeys = Object.keys(demoData[0]);\n    const { columns, id, dataSource } = field;\n\n    if (!Array.isArray(columns) || columns.length === 0 || dataSource !== `=${id}`) {\n      return;\n    }\n\n    if (!columns.map(({ key })=>key).every(key => demoDataKeys.includes(key))) {\n      return;\n    }\n\n    return demoData;\n  }\n};\n\n// helpers /////////////////////////////\n\n/**\n * @param {string|void} columnsExpression\n * @param {Column[]} fallbackColumns\n * @returns {Column[]}\n */\nfunction useEvaluatedColumns(columnsExpression, fallbackColumns) {\n\n  /** @type {Column[]|null} */\n  const evaluation = useExpressionEvaluation(columnsExpression || '');\n\n  return Array.isArray(evaluation) && evaluation.every(isColumn)\n    ? evaluation\n    : fallbackColumns;\n}\n\n/**\n * @param {any} column\n * @returns {column is Column}\n */\nfunction isColumn(column) {\n  return (\n    isObject(column) && isString(column['label']) && isString(column['key'])\n  );\n}\n\n/**\n * @param {Array} array\n * @param {number} size\n * @returns {Array}\n */\nfunction chunk(array, size) {\n  return array.reduce((chunks, item, index) => {\n    if (index % size === 0) {\n      chunks.push([ item ]);\n    } else {\n      chunks[chunks.length - 1].push(item);\n    }\n\n    return chunks;\n  }, []);\n}\n\n/**\n * @param {unknown[]} array\n * @param {string} key\n * @param {Direction} direction\n * @returns {unknown[]}\n */\nfunction sortByColumn(array, key, direction) {\n  return [ ...array ].sort((a, b) => {\n    if (!isObject(a) || !isObject(b)) {\n      return 0;\n    }\n\n    if (direction === 'asc') {\n      return a[key] > b[key] ? 1 : -1;\n    }\n\n    return a[key] < b[key] ? 1 : -1;\n  });\n}\n\n/**\n * @param {null|Sorting} sortBy\n * @param {string} key\n * @param {string} label\n */\nfunction getHeaderAriaLabel(sortBy, key, label) {\n  if (sortBy === null || sortBy.key !== key) {\n    return `Click to sort by ${label} descending`;\n  }\n\n  if (sortBy.direction === 'asc') {\n    return 'Click to remove sorting';\n  }\n\n  return `Click to sort by ${label} ascending`;\n}\n","/**\n * This file must not be changed or exchanged.\n *\n * @see http://bpmn.io/license for more information.\n */\nimport { Fragment } from 'preact';\nimport { useState } from 'preact/hooks';\nimport { createPortal } from 'preact/compat';\n\nfunction Logo() {\n  return <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 14.02 5.57\" width=\"53\" height=\"21\" style=\"vertical-align:middle\"><path fill=\"currentColor\" d=\"M1.88.92v.14c0 .41-.13.68-.4.8.33.14.46.44.46.86v.33c0 .61-.33.95-.95.95H0V0h.95c.65 0 .93.3.93.92zM.63.57v1.06h.24c.24 0 .38-.1.38-.43V.98c0-.28-.1-.4-.32-.4zm0 1.63v1.22h.36c.2 0 .32-.1.32-.39v-.35c0-.37-.12-.48-.4-.48H.63zM4.18.99v.52c0 .64-.31.98-.94.98h-.3V4h-.62V0h.92c.63 0 .94.35.94.99zM2.94.57v1.35h.3c.2 0 .3-.09.3-.37v-.6c0-.29-.1-.38-.3-.38h-.3zm2.89 2.27L6.25 0h.88v4h-.6V1.12L6.1 3.99h-.6l-.46-2.82v2.82h-.55V0h.87zM8.14 1.1V4h-.56V0h.79L9 2.4V0h.56v4h-.64zm2.49 2.29v.6h-.6v-.6zM12.12 1c0-.63.33-1 .95-1 .61 0 .95.37.95 1v2.04c0 .64-.34 1-.95 1-.62 0-.95-.37-.95-1zm.62 2.08c0 .28.13.39.33.39s.32-.1.32-.4V.98c0-.29-.12-.4-.32-.4s-.33.11-.33.4z\" /><path fill=\"currentColor\" d=\"M0 4.53h14.02v1.04H0zM11.08 0h.63v.62h-.63zm.63 4V1h-.63v2.98z\" /></svg>;\n}\n\nfunction Lightbox(props) {\n  const { open } = props;\n\n  if (!open) {\n    return null;\n  }\n\n  return (\n    <div class=\"fjs-powered-by-lightbox\" style=\"z-index: 100; position: fixed; top: 0; left: 0;right: 0; bottom: 0\">\n      <div class=\"backdrop\" style=\"width: 100%; height: 100%; background: rgba(40 40 40 / 20%)\" onClick={ props.onBackdropClick }></div>\n      <div class=\"notice\" style=\"position: absolute; left: 50%; top: 40%; transform: translate(-50%); width: 260px; padding: 10px; background: white; box-shadow: 0  1px 4px rgba(0 0 0 / 30%); font-family: Helvetica, Arial, sans-serif; font-size: 14px; display: flex; line-height: 1.3\">\n        <a href=\"https://bpmn.io\" target=\"_blank\" rel=\"noopener\" style=\"margin: 15px 20px 15px 10px; align-self: center; color: var(--cds-icon-primary, #404040)\">\n          <Logo />\n        </a>\n        <span>\n          Web-based tooling for BPMN, DMN, and forms\n          powered by <a href=\"https://bpmn.io\" target=\"_blank\" rel=\"noopener\">bpmn.io</a>.\n        </span>\n      </div>\n    </div>\n  );\n}\n\nfunction Link(props) {\n  return (\n    <div class=\"fjs-powered-by fjs-form-field\" style=\"text-align: right\">\n      <a href=\"https://bpmn.io\" target=\"_blank\" rel=\"noopener\" class=\"fjs-powered-by-link\" title=\"Powered by bpmn.io\" style=\"color: var(--cds-text-primary, #404040)\" onClick={ props.onClick }><Logo /></a>\n    </div>\n  );\n}\n\nexport function PoweredBy(props) {\n\n  const [ open, setOpen ] = useState(false);\n\n  function toggleOpen(open) {\n    return (event) => {\n      event.preventDefault();\n\n      setOpen(open);\n    };\n  }\n\n  return (\n    <Fragment>\n      {\n        createPortal(\n          <Lightbox open={ open } onBackdropClick={ toggleOpen(false) } />,\n          document.body\n        )\n      }\n      <Link onClick={ toggleOpen(true) } />\n    </Fragment>\n  );\n}","import { FormField } from './FormField';\nimport { PoweredBy } from './PoweredBy';\nimport { LocalExpressionContext } from '../context/LocalExpressionContext';\n\nimport { useMemo } from 'preact/hooks';\nimport { useFilteredFormData, useService } from '../hooks';\n\nconst noop = () => {};\n\nexport function FormComponent(props) {\n  const form = useService('form');\n\n  const { schema, properties } = form._getState();\n\n  const { ariaLabel } = properties;\n\n  const {\n    onSubmit = noop,\n    onReset = noop,\n    onChange = noop,\n  } = props;\n\n  const handleSubmit = (event) => {\n    event.preventDefault();\n\n    onSubmit();\n  };\n\n  const handleReset = (event) => {\n    event.preventDefault();\n\n    onReset();\n  };\n\n  const filteredFormData = useFilteredFormData();\n\n  const localExpressionContext = useMemo(() => ({\n    data: filteredFormData,\n    parent: null,\n    this: filteredFormData,\n    i: []\n  }), [ filteredFormData ]);\n\n  return (\n    <form\n      class=\"fjs-form\"\n      onSubmit={ handleSubmit }\n      onReset={ handleReset }\n      aria-label={ ariaLabel }\n      noValidate\n    >\n      <LocalExpressionContext.Provider value={ localExpressionContext }>\n        <FormField\n          field={ schema }\n          onChange={ onChange }\n        />\n      </LocalExpressionContext.Provider>\n      <PoweredBy />\n    </form>\n  );\n}","import { Button } from './form-fields/Button';\nimport { Checkbox } from './form-fields/Checkbox';\nimport { Checklist } from './form-fields/Checklist';\nimport { Default } from './form-fields/Default';\nimport { Datetime } from './form-fields/Datetime';\nimport { Group } from './form-fields/Group';\nimport { IFrame } from './form-fields/IFrame';\nimport { Image } from './form-fields/Image';\nimport { Numberfield } from './form-fields/Number';\nimport { Radio } from './form-fields/Radio';\nimport { Select } from './form-fields/Select';\nimport { Separator } from './form-fields/Separator';\nimport { Spacer } from './form-fields/Spacer';\nimport { DynamicList } from './form-fields/DynamicList';\nimport { Taglist } from './form-fields/Taglist';\nimport { Text } from './form-fields/Text';\nimport { Html } from './form-fields/Html';\nimport { Textfield } from './form-fields/Textfield';\nimport { Textarea } from './form-fields/Textarea';\nimport { Table } from './form-fields/Table';\n\nimport { Label } from './Label';\nimport { Description } from './Description';\nimport { Errors } from './Errors';\nimport { FormComponent } from './FormComponent';\nimport { FormField } from './FormField';\n\nexport {\n  Label,\n  Description,\n  Errors\n};\n\nexport {\n  Button,\n  Checkbox,\n  Checklist,\n  Default,\n  Datetime,\n  FormComponent,\n  FormField,\n  Group,\n  IFrame,\n  DynamicList,\n  Image,\n  Numberfield,\n  Radio,\n  Select,\n  Separator,\n  Spacer,\n  Taglist,\n  Text,\n  Html,\n  Textfield,\n  Textarea,\n  Table\n};\n\nexport const formFields = [\n  Button,\n  Checkbox,\n  Checklist,\n  Default,\n  DynamicList,\n  Numberfield,\n  Datetime,\n  Radio,\n  Select,\n  Taglist,\n  Textfield,\n  Textarea,\n  Text,\n  Image,\n  Table,\n  Html,\n  Spacer,\n  Separator,\n  Group,\n  DynamicList,\n  IFrame\n];\n\nexport * from './icons';\nexport * from './Sanitizer';\nexport * from './util/sanitizerUtil';","import { formFields } from './components';\n\nexport class FormFields {\n  constructor() {\n    this._formFields = {};\n\n    formFields.forEach((formField) => {\n      this.register(formField.config.type, formField);\n    });\n  }\n\n  register(type, formField) {\n    this._formFields[ type ] = formField;\n  }\n\n  get(type) {\n    return this._formFields[ type ];\n  }\n}","import { FeelExpressionLanguage } from '../features/expressionLanguage/FeelExpressionLanguage.js';\nimport { FeelersTemplating } from '../features/expressionLanguage/FeelersTemplating.js';\nimport { FormFields } from '../render/FormFields.js';\n\nimport { get } from 'min-dash';\n\nconst EXPRESSION_PROPERTIES = [\n  'alt',\n  'appearance.prefixAdorner',\n  'appearance.suffixAdorner',\n  'conditional.hide',\n  'description',\n  'label',\n  'source',\n  'readonly',\n  'text',\n  'validate.min',\n  'validate.max',\n  'validate.minLength',\n  'validate.maxLength',\n  'valuesExpression',\n  'url',\n  'dataSource',\n  'columnsExpression'\n];\n\nconst TEMPLATE_PROPERTIES = [\n  'alt',\n  'appearance.prefixAdorner',\n  'appearance.suffixAdorner',\n  'description',\n  'label',\n  'source',\n  'text',\n  'content',\n  'url'\n];\n\n/**\n * @typedef { import('../types').Schema } Schema\n */\n\n/**\n * Parse the schema for variables a form might make use of.\n *\n * @example\n *\n * // retrieve variables from schema\n * const variables = getSchemaVariables(schema);\n *\n * @example\n *\n * // retrieve input variables from schema\n * const inputVariables = getSchemaVariables(schema, { outputs: false });\n *\n * @example\n *\n * // retrieve output variables from schema\n * const outputVariables = getSchemaVariables(schema, { inputs: false });\n *\n * @param {Schema} schema\n * @param {object} [options]\n * @param {any} [options.expressionLanguage]\n * @param {any} [options.templating]\n * @param {any} [options.formFields]\n * @param {boolean} [options.inputs=true]\n * @param {boolean} [options.outputs=true]\n *\n * @return {string[]}\n */\nexport function getSchemaVariables(schema, options = {}) {\n\n  const {\n    formFields = new FormFields(),\n    expressionLanguage = new FeelExpressionLanguage(null),\n    templating = new FeelersTemplating(),\n    inputs = true,\n    outputs = true\n  } = options;\n\n  if (!schema.components) {\n    return [];\n  }\n\n  const getAllComponents = (node) => {\n    const components = [];\n\n    if (node.components) {\n      node.components.forEach(component => {\n        components.push(component);\n        components.push(...getAllComponents(component));\n      });\n    }\n\n    return components;\n  };\n\n  const variables = getAllComponents(schema).reduce((variables, component) => {\n\n    const {\n      valuesKey\n    } = component;\n\n    // collect input-only variables\n    if (inputs) {\n\n      if (valuesKey) {\n        variables = [ ...variables, valuesKey ];\n      }\n\n      EXPRESSION_PROPERTIES.forEach((prop) => {\n        const property = get(component, prop.split('.'));\n\n        if (property && expressionLanguage.isExpression(property)) {\n\n          const expressionVariables = expressionLanguage.getVariableNames(property, { type: 'expression' });\n\n          variables = [ ...variables, ...expressionVariables ];\n        }\n      });\n\n      TEMPLATE_PROPERTIES.forEach((prop) => {\n        const property = get(component, prop.split('.'));\n\n        if (property && !expressionLanguage.isExpression(property) && templating.isTemplate(property)) {\n          const templateVariables = templating.getVariableNames(property);\n          variables = [ ...variables, ...templateVariables ];\n        }\n      });\n\n    }\n\n    return variables.filter(variable => typeof variable === 'string');\n  }, []);\n\n  const getBindingVariables = (node)=> {\n    const bindingVariable = [];\n    const formField = formFields.get(node.type);\n\n    if (formField && formField.config.keyed && node.key) {\n      return [ node.key.split('.')[0] ];\n    } else if (formField && formField.config.pathed && node.path) {\n      return [ node.path.split('.')[0] ];\n    } else if (node.components) {\n      node.components.forEach(component => {\n        bindingVariable.push(...getBindingVariables(component));\n      });\n    }\n\n    return bindingVariable;\n  };\n\n  // collect binding variables\n  if (inputs || outputs) {\n    variables.push(...getBindingVariables(schema));\n  }\n\n  // remove duplicates\n  return Array.from(new Set(variables));\n}","/**\n * Get the ancestry list of a form field.\n *\n * @param {string} formFieldId\n * @param {import('../core/FormFieldRegistry').FormFieldRegistry} formFieldRegistry\n *\n * @return {Array<string>} ancestry list\n */\nexport const getAncestryList = (formFieldId, formFieldRegistry) => {\n  const ids = [];\n\n  let currentFormField = formFieldRegistry.get(formFieldId);\n\n  while (currentFormField) {\n    ids.push(currentFormField.id);\n\n    currentFormField = formFieldRegistry.get(currentFormField._parent);\n  }\n\n  return ids;\n};","import { unaryTest } from 'feelin';\nimport { get, isString, set, values, isObject } from 'min-dash';\nimport { buildExpressionContext, clone } from '../../util';\n\n/**\n * @typedef {object} Condition\n * @property {string} [hide]\n */\n\nexport class ConditionChecker {\n  constructor(formFieldRegistry, pathRegistry, eventBus) {\n    this._formFieldRegistry = formFieldRegistry;\n    this._pathRegistry = pathRegistry;\n    this._eventBus = eventBus;\n  }\n\n  /**\n   * For given data, remove properties based on condition.\n   *\n   * @param {Object<string, any>} data\n   * @param {Object<string, any>} contextData\n   * @param {Object} [options]\n   * @param {Function} [options.getFilterPath]\n   * @param {boolean} [options.leafNodeDeletionOnly]\n   */\n  applyConditions(data, contextData = {}, options = {}) {\n\n    const workingData = clone(data);\n\n    const {\n      getFilterPath = (field, indexes) => this._pathRegistry.getValuePath(field, { indexes }),\n      leafNodeDeletionOnly = false\n    } = options;\n\n    const _applyConditionsWithinScope = (rootField, scopeContext, startHidden = false) => {\n\n      const {\n        indexes = {},\n        expressionIndexes = [],\n        scopeData = contextData,\n        parentScopeData = null\n      } = scopeContext;\n\n      this._pathRegistry.executeRecursivelyOnFields(rootField, ({ field, isClosed, isRepeatable, context }) => {\n\n        const {\n          conditional,\n          components,\n          id\n        } = field;\n\n        // build the expression context in the right format\n        const localExpressionContext = buildExpressionContext({\n          this: scopeData,\n          data: contextData,\n          i: expressionIndexes,\n          parent: parentScopeData\n        });\n\n        context.isHidden = startHidden || context.isHidden || (conditional && this._checkHideCondition(conditional, localExpressionContext));\n\n        // if a field is repeatable and visible, we need to implement custom recursion on its children\n        if (isRepeatable && (!context.isHidden || leafNodeDeletionOnly)) {\n\n          // prevent the regular recursion behavior of executeRecursivelyOnFields\n          context.preventRecursion = true;\n\n          const repeaterValuePath = this._pathRegistry.getValuePath(field, { indexes });\n          const repeaterValue = get(contextData, repeaterValuePath);\n\n          // quit early if there are no children or data associated with the repeater\n          if (!Array.isArray(repeaterValue) || !repeaterValue.length || !Array.isArray(components) || !components.length) {\n            return;\n          }\n\n          for (let i = 0; i < repeaterValue.length; i++) {\n\n            // create a new scope context for each index\n            const newScopeContext = {\n              indexes: { ...indexes, [id]: i },\n              expressionIndexes: [ ...expressionIndexes, i + 1 ],\n              scopeData: repeaterValue[i],\n              parentScopeData: scopeData\n            };\n\n            // for each child component, apply conditions within the new repetition scope\n            components.forEach(component => {\n              _applyConditionsWithinScope(component, newScopeContext, context.isHidden);\n            });\n\n          }\n\n        }\n\n        // if we have a hidden repeatable field, and the data structure allows, we clear it directly at the root and stop recursion\n        if (context.isHidden && !leafNodeDeletionOnly && isRepeatable) {\n          context.preventRecursion = true;\n          this._cleanlyClearDataAtPath(getFilterPath(field, indexes), workingData);\n        }\n\n        // for simple leaf fields, we always clear\n        if (context.isHidden && isClosed) {\n          this._cleanlyClearDataAtPath(getFilterPath(field, indexes), workingData);\n        }\n\n      });\n\n    };\n\n    // apply conditions starting with the root of the form\n    const form = this._formFieldRegistry.getForm();\n\n    if (!form) {\n      throw new Error('form field registry has no form');\n    }\n\n    _applyConditionsWithinScope(form, {\n      scopeData: contextData\n    });\n\n    return workingData;\n  }\n\n  /**\n   * Check if given condition is met. Returns null for invalid/missing conditions.\n   *\n   * @param {string} condition\n   * @param {import('../../types').Data} [data]\n   *\n   * @returns {boolean|null}\n   */\n  check(condition, data = {}) {\n    if (!condition) {\n      return null;\n    }\n\n    if (!isString(condition) || !condition.startsWith('=')) {\n      return null;\n    }\n\n    try {\n\n      // cut off initial '='\n      const result = unaryTest(condition.slice(1), data);\n\n      return result;\n    } catch (error) {\n      this._eventBus.fire('error', { error });\n      return null;\n    }\n  }\n\n  /**\n   * Check if hide condition is met.\n   *\n   * @param {Condition} condition\n   * @param {Object<string, any>} data\n   * @returns {boolean}\n   */\n  _checkHideCondition(condition, data) {\n    if (!condition.hide) {\n      return false;\n    }\n\n    const result = this.check(condition.hide, data);\n\n    return result === true;\n  }\n\n  _cleanlyClearDataAtPath(valuePath, obj) {\n    const workingValuePath = [ ...valuePath ];\n    let recurse = false;\n\n    do {\n      set(obj, workingValuePath, undefined);\n      workingValuePath.pop();\n      const parentObject = get(obj, workingValuePath);\n      recurse = !!workingValuePath.length && (this._isEmptyObject(parentObject) || this._isEmptyArray(parentObject));\n    } while (recurse);\n  }\n\n  _isEmptyObject(parentObject) {\n    return isObject(parentObject) && !values(parentObject).length;\n  }\n\n  _isEmptyArray(parentObject) {\n    return Array.isArray(parentObject) && (!parentObject.length || parentObject.every(item => item === undefined));\n  }\n}\n\nConditionChecker.$inject = [\n  'formFieldRegistry',\n  'pathRegistry',\n  'eventBus'\n];\n","import { FeelExpressionLanguage } from './FeelExpressionLanguage';\nimport { FeelersTemplating } from './FeelersTemplating';\nimport { ConditionChecker } from './ConditionChecker';\n\nexport const ExpressionLanguageModule = {\n  __init__: [ 'expressionLanguage', 'templating', 'conditionChecker' ],\n  expressionLanguage: [ 'type', FeelExpressionLanguage ],\n  templating: [ 'type', FeelersTemplating ],\n  conditionChecker: [ 'type', ConditionChecker ]\n};\n\nexport { FeelExpressionLanguage, FeelersTemplating, ConditionChecker };","import showdown from 'showdown';\n\n// bootstrap showdown to support github flavored markdown\nshowdown.setFlavor('github');\n\nexport class MarkdownRenderer {\n\n  constructor() {\n    this._converter = new showdown.Converter();\n  }\n\n  /**\n   * Render markdown to HTML.\n   *\n   * @param {string} markdown - The markdown to render\n   *\n   * @returns {string} HTML\n   */\n  render(markdown) {\n    return this._converter.makeHtml(markdown);\n  }\n}\n\nMarkdownRenderer.$inject = [];","import { MarkdownRenderer } from './MarkdownRenderer';\n\nexport const MarkdownRendererModule = {\n  __init__: [ 'markdownRenderer' ],\n  markdownRenderer: [ 'type', MarkdownRenderer ],\n};\n\nexport { MarkdownRenderer };","import {\n  uniqueBy,\n  isArray\n} from 'min-dash';\n\n/**\n * @typedef {import('didi').Injector} Injector\n *\n * @typedef {import('../core/Types').ElementLike} ElementLike\n *\n * @typedef {import('../core/EventBus').default} EventBus\n * @typedef {import('./CommandHandler').default} CommandHandler\n *\n * @typedef { any } CommandContext\n * @typedef { {\n *   new (...args: any[]) : CommandHandler\n * } } CommandHandlerConstructor\n * @typedef { {\n *   [key: string]: CommandHandler;\n * } } CommandHandlerMap\n * @typedef { {\n *   command: string;\n *   context: any;\n *   id?: any;\n * } } CommandStackAction\n * @typedef { {\n *   actions: CommandStackAction[];\n *   dirty: ElementLike[];\n *   trigger: 'execute' | 'undo' | 'redo' | 'clear' | null;\n *   atomic?: boolean;\n * } } CurrentExecution\n */\n\n/**\n * A service that offers un- and redoable execution of commands.\n *\n * The command stack is responsible for executing modeling actions\n * in a un- and redoable manner. To do this it delegates the actual\n * command execution to {@link CommandHandler}s.\n *\n * Command handlers provide {@link CommandHandler#execute(ctx)} and\n * {@link CommandHandler#revert(ctx)} methods to un- and redo a command\n * identified by a command context.\n *\n *\n * ## Life-Cycle events\n *\n * In the process the command stack fires a number of life-cycle events\n * that other components to participate in the command execution.\n *\n *    * preExecute\n *    * preExecuted\n *    * execute\n *    * executed\n *    * postExecute\n *    * postExecuted\n *    * revert\n *    * reverted\n *\n * A special event is used for validating, whether a command can be\n * performed prior to its execution.\n *\n *    * canExecute\n *\n * Each of the events is fired as `commandStack.{eventName}` and\n * `commandStack.{commandName}.{eventName}`, respectively. This gives\n * components fine grained control on where to hook into.\n *\n * The event object fired transports `command`, the name of the\n * command and `context`, the command context.\n *\n *\n * ## Creating Command Handlers\n *\n * Command handlers should provide the {@link CommandHandler#execute(ctx)}\n * and {@link CommandHandler#revert(ctx)} methods to implement\n * redoing and undoing of a command.\n *\n * A command handler _must_ ensure undo is performed properly in order\n * not to break the undo chain. It must also return the shapes that\n * got changed during the `execute` and `revert` operations.\n *\n * Command handlers may execute other modeling operations (and thus\n * commands) in their `preExecute(d)` and `postExecute(d)` phases. The command\n * stack will properly group all commands together into a logical unit\n * that may be re- and undone atomically.\n *\n * Command handlers must not execute other commands from within their\n * core implementation (`execute`, `revert`).\n *\n *\n * ## Change Tracking\n *\n * During the execution of the CommandStack it will keep track of all\n * elements that have been touched during the command's execution.\n *\n * At the end of the CommandStack execution it will notify interested\n * components via an 'elements.changed' event with all the dirty\n * elements.\n *\n * The event can be picked up by components that are interested in the fact\n * that elements have been changed. One use case for this is updating\n * their graphical representation after moving / resizing or deletion.\n *\n * @see CommandHandler\n *\n * @param {EventBus} eventBus\n * @param {Injector} injector\n */\nexport default function CommandStack(eventBus, injector) {\n\n  /**\n   * A map of all registered command handlers.\n   *\n   * @type {CommandHandlerMap}\n   */\n  this._handlerMap = {};\n\n  /**\n   * A stack containing all re/undoable actions on the diagram\n   *\n   * @type {CommandStackAction[]}\n   */\n  this._stack = [];\n\n  /**\n   * The current index on the stack\n   *\n   * @type {number}\n   */\n  this._stackIdx = -1;\n\n  /**\n   * Current active commandStack execution\n   *\n   * @type {CurrentExecution}\n   */\n  this._currentExecution = {\n    actions: [],\n    dirty: [],\n    trigger: null\n  };\n\n  /**\n   * @type {Injector}\n   */\n  this._injector = injector;\n\n  /**\n   * @type EventBus\n   */\n  this._eventBus = eventBus;\n\n  /**\n   * @type { number }\n   */\n  this._uid = 1;\n\n  eventBus.on([\n    'diagram.destroy',\n    'diagram.clear'\n  ], function() {\n    this.clear(false);\n  }, this);\n}\n\nCommandStack.$inject = [ 'eventBus', 'injector' ];\n\n\n/**\n * Execute a command.\n *\n * @param {string} command The command to execute.\n * @param {CommandContext} context The context with which to execute the command.\n */\nCommandStack.prototype.execute = function(command, context) {\n  if (!command) {\n    throw new Error('command required');\n  }\n\n  this._currentExecution.trigger = 'execute';\n\n  const action = { command: command, context: context };\n\n  this._pushAction(action);\n  this._internalExecute(action);\n  this._popAction();\n};\n\n\n/**\n * Check whether a command can be executed.\n *\n * Implementors may hook into the mechanism on two ways:\n *\n *   * in event listeners:\n *\n *     Users may prevent the execution via an event listener.\n *     It must prevent the default action for `commandStack.(<command>.)canExecute` events.\n *\n *   * in command handlers:\n *\n *     If the method {@link CommandHandler#canExecute} is implemented in a handler\n *     it will be called to figure out whether the execution is allowed.\n *\n * @param {string} command The command to execute.\n * @param {CommandContext} context The context with which to execute the command.\n *\n * @return {boolean} Whether the command can be executed with the given context.\n */\nCommandStack.prototype.canExecute = function(command, context) {\n\n  const action = { command: command, context: context };\n\n  const handler = this._getHandler(command);\n\n  let result = this._fire(command, 'canExecute', action);\n\n  // handler#canExecute will only be called if no listener\n  // decided on a result already\n  if (result === undefined) {\n    if (!handler) {\n      return false;\n    }\n\n    if (handler.canExecute) {\n      result = handler.canExecute(context);\n    }\n  }\n\n  return result;\n};\n\n\n/**\n * Clear the command stack, erasing all undo / redo history.\n *\n * @param {boolean} [emit=true] Whether to fire an event. Defaults to `true`.\n */\nCommandStack.prototype.clear = function(emit) {\n  this._stack.length = 0;\n  this._stackIdx = -1;\n\n  if (emit !== false) {\n    this._fire('changed', { trigger: 'clear' });\n  }\n};\n\n\n/**\n * Undo last command(s)\n */\nCommandStack.prototype.undo = function() {\n  let action = this._getUndoAction(),\n      next;\n\n  if (action) {\n    this._currentExecution.trigger = 'undo';\n\n    this._pushAction(action);\n\n    while (action) {\n      this._internalUndo(action);\n      next = this._getUndoAction();\n\n      if (!next || next.id !== action.id) {\n        break;\n      }\n\n      action = next;\n    }\n\n    this._popAction();\n  }\n};\n\n\n/**\n * Redo last command(s)\n */\nCommandStack.prototype.redo = function() {\n  let action = this._getRedoAction(),\n      next;\n\n  if (action) {\n    this._currentExecution.trigger = 'redo';\n\n    this._pushAction(action);\n\n    while (action) {\n      this._internalExecute(action, true);\n      next = this._getRedoAction();\n\n      if (!next || next.id !== action.id) {\n        break;\n      }\n\n      action = next;\n    }\n\n    this._popAction();\n  }\n};\n\n\n/**\n * Register a handler instance with the command stack.\n *\n * @param {string} command Command to be executed.\n * @param {CommandHandler} handler Handler to execute the command.\n */\nCommandStack.prototype.register = function(command, handler) {\n  this._setHandler(command, handler);\n};\n\n\n/**\n * Register a handler type with the command stack  by instantiating it and\n * injecting its dependencies.\n *\n * @param {string} command Command to be executed.\n * @param {CommandHandlerConstructor} handlerCls Constructor to instantiate a {@link CommandHandler}.\n */\nCommandStack.prototype.registerHandler = function(command, handlerCls) {\n\n  if (!command || !handlerCls) {\n    throw new Error('command and handlerCls must be defined');\n  }\n\n  const handler = this._injector.instantiate(handlerCls);\n  this.register(command, handler);\n};\n\n/**\n * @return {boolean}\n */\nCommandStack.prototype.canUndo = function() {\n  return !!this._getUndoAction();\n};\n\n/**\n * @return {boolean}\n */\nCommandStack.prototype.canRedo = function() {\n  return !!this._getRedoAction();\n};\n\n// stack access  //////////////////////\n\nCommandStack.prototype._getRedoAction = function() {\n  return this._stack[this._stackIdx + 1];\n};\n\n\nCommandStack.prototype._getUndoAction = function() {\n  return this._stack[this._stackIdx];\n};\n\n\n// internal functionality //////////////////////\n\nCommandStack.prototype._internalUndo = function(action) {\n  const command = action.command,\n        context = action.context;\n\n  const handler = this._getHandler(command);\n\n  // guard against illegal nested command stack invocations\n  this._atomicDo(() => {\n    this._fire(command, 'revert', action);\n\n    if (handler.revert) {\n      this._markDirty(handler.revert(context));\n    }\n\n    this._revertedAction(action);\n\n    this._fire(command, 'reverted', action);\n  });\n};\n\n\nCommandStack.prototype._fire = function(command, qualifier, event) {\n  if (arguments.length < 3) {\n    event = qualifier;\n    qualifier = null;\n  }\n\n  const names = qualifier ? [ command + '.' + qualifier, qualifier ] : [ command ];\n  let result;\n\n  event = this._eventBus.createEvent(event);\n\n  for (const name of names) {\n    result = this._eventBus.fire('commandStack.' + name, event);\n\n    if (event.cancelBubble) {\n      break;\n    }\n  }\n\n  return result;\n};\n\nCommandStack.prototype._createId = function() {\n  return this._uid++;\n};\n\nCommandStack.prototype._atomicDo = function(fn) {\n\n  const execution = this._currentExecution;\n\n  execution.atomic = true;\n\n  try {\n    fn();\n  } finally {\n    execution.atomic = false;\n  }\n};\n\nCommandStack.prototype._internalExecute = function(action, redo) {\n  const command = action.command,\n        context = action.context;\n\n  const handler = this._getHandler(command);\n\n  if (!handler) {\n    throw new Error('no command handler registered for <' + command + '>');\n  }\n\n  this._pushAction(action);\n\n  if (!redo) {\n    this._fire(command, 'preExecute', action);\n\n    if (handler.preExecute) {\n      handler.preExecute(context);\n    }\n\n    this._fire(command, 'preExecuted', action);\n  }\n\n  // guard against illegal nested command stack invocations\n  this._atomicDo(() => {\n\n    this._fire(command, 'execute', action);\n\n    if (handler.execute) {\n\n      // actual execute + mark return results as dirty\n      this._markDirty(handler.execute(context));\n    }\n\n    // log to stack\n    this._executedAction(action, redo);\n\n    this._fire(command, 'executed', action);\n  });\n\n  if (!redo) {\n    this._fire(command, 'postExecute', action);\n\n    if (handler.postExecute) {\n      handler.postExecute(context);\n    }\n\n    this._fire(command, 'postExecuted', action);\n  }\n\n  this._popAction();\n};\n\n\nCommandStack.prototype._pushAction = function(action) {\n\n  const execution = this._currentExecution,\n        actions = execution.actions;\n\n  const baseAction = actions[0];\n\n  if (execution.atomic) {\n    throw new Error('illegal invocation in <execute> or <revert> phase (action: ' + action.command + ')');\n  }\n\n  if (!action.id) {\n    action.id = (baseAction && baseAction.id) || this._createId();\n  }\n\n  actions.push(action);\n};\n\n\nCommandStack.prototype._popAction = function() {\n  const execution = this._currentExecution,\n        trigger = execution.trigger,\n        actions = execution.actions,\n        dirty = execution.dirty;\n\n  actions.pop();\n\n  if (!actions.length) {\n    this._eventBus.fire('elements.changed', { elements: uniqueBy('id', dirty.reverse()) });\n\n    dirty.length = 0;\n\n    this._fire('changed', { trigger: trigger });\n\n    execution.trigger = null;\n  }\n};\n\n\nCommandStack.prototype._markDirty = function(elements) {\n  const execution = this._currentExecution;\n\n  if (!elements) {\n    return;\n  }\n\n  elements = isArray(elements) ? elements : [ elements ];\n\n  execution.dirty = execution.dirty.concat(elements);\n};\n\n\nCommandStack.prototype._executedAction = function(action, redo) {\n  const stackIdx = ++this._stackIdx;\n\n  if (!redo) {\n    this._stack.splice(stackIdx, this._stack.length, action);\n  }\n};\n\n\nCommandStack.prototype._revertedAction = function(action) {\n  this._stackIdx--;\n};\n\n\nCommandStack.prototype._getHandler = function(command) {\n  return this._handlerMap[command];\n};\n\nCommandStack.prototype._setHandler = function(command, handler) {\n  if (!command || !handler) {\n    throw new Error('command and handler required');\n  }\n\n  if (this._handlerMap[command]) {\n    throw new Error('overriding handler for command <' + command + '>');\n  }\n\n  this._handlerMap[command] = handler;\n};\n","import CommandStack from './CommandStack';\n\n/**\n * @type { import('didi').ModuleDeclaration }\n */\nexport default {\n  commandStack: [ 'type', CommandStack ]\n};\n","import { set } from 'min-dash';\nimport { clone } from '../../../util';\n\nexport class UpdateFieldValidationHandler {\n\n  constructor(form, validator) {\n    this._form = form;\n    this._validator = validator;\n  }\n\n  execute(context) {\n    const { field, value, indexes } = context;\n    const { errors } = this._form._getState();\n\n    context.oldErrors = clone(errors);\n\n    const fieldErrors = this._validator.validateField(field, value);\n    const updatedErrors = set(errors, [ field.id, ...Object.values(indexes || {}) ], fieldErrors.length ? fieldErrors : undefined);\n    this._form._setState({ errors: updatedErrors });\n  }\n\n  revert(context) {\n    this._form._setState({ errors: context.oldErrors });\n  }\n}\n\nUpdateFieldValidationHandler.$inject = [ 'form', 'validator' ];","import { UpdateFieldValidationHandler } from './cmd/UpdateFieldValidationHandler';\n\nexport class ViewerCommands {\n  constructor(commandStack, eventBus) {\n    this._commandStack = commandStack;\n\n    eventBus.on('form.init', () => {\n      this.registerHandlers();\n    });\n  }\n\n  registerHandlers() {\n    Object.entries(this.getHandlers()).forEach(([ id, handler ]) => {\n      this._commandStack.registerHandler(id, handler);\n    });\n  }\n\n  getHandlers() {\n    return {\n      'formField.validation.update': UpdateFieldValidationHandler\n    };\n  }\n\n  updateFieldValidation(field, value, indexes) {\n    const context = {\n      field,\n      value,\n      indexes\n    };\n\n    this._commandStack.execute('formField.validation.update', context);\n  }\n\n}\n\nViewerCommands.$inject = [\n  'commandStack',\n  'eventBus'\n];","import commandModule from 'diagram-js/lib/command';\n\nimport { ViewerCommands } from './ViewerCommands';\n\nexport const ViewerCommandsModule = {\n  __depends__: [\n    commandModule\n  ],\n  __init__: [ 'viewerCommands' ],\n  viewerCommands: [ 'type', ViewerCommands ]\n};\n\nexport { ViewerCommands };","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"none\"><path fill=\"currentColor\" d=\"M2 9h5.5v3.086l-1.293-1.293-.707.707L8 14l2.5-2.5-.707-.707L8.5 12.086V9H14V8H2v1ZM13 2H3a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1Zm0 3H3V3h10v2Z\"/></svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"none\"><path fill=\"currentColor\" d=\"M13 10H3a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1Zm0 3H3v-2h10v2ZM8.5 3.914l1.293 1.293.707-.707L8 2 5.5 4.5l.707.707L7.5 3.914V7H2v1h12V7H8.5V3.914Z\"/></svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"none\"><path fill=\"currentColor\" d=\"M8 2c3.3 0 6 2.7 6 6s-2.7 6-6 6-6-2.7-6-6 2.7-6 6-6Zm0-1C4.15 1 1 4.15 1 8s3.15 7 7 7 7-3.15 7-7-3.15-7-7-7Z\"/><path fill=\"currentColor\" d=\"M12 7.5H8.5V4h-1v3.5H4v1h3.5V12h1V8.5H12v-1Z\"/></svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"none\"><path fill=\"currentColor\" d=\"m12 4.7-.7-.7L8 7.3 4.7 4l-.7.7L7.3 8 4 11.3l.7.7L8 8.7l3.3 3.3.7-.7L8.7 8 12 4.7Z\"/></svg>","// disable react hook rules as the linter is confusing the functional components within a class as class components\n/* eslint-disable react-hooks/rules-of-hooks */\n\nimport { get } from 'min-dash';\nimport { useContext, useMemo, useRef } from 'preact/hooks';\nimport { LocalExpressionContext } from '../../render/context/LocalExpressionContext';\n\nimport ExpandSvg from '../../render/components/form-fields/icons/Expand.svg';\nimport CollapseSvg from '../../render/components/form-fields/icons/Collapse.svg';\nimport AddSvg from '../../render/components/form-fields/icons/Add.svg';\nimport DeleteSvg from '../../render/components/form-fields/icons/Delete.svg';\n\nimport { buildExpressionContext } from '../../util';\nimport { useScrollIntoView } from '../../render/hooks';\nimport classNames from 'classnames';\n\nexport class RepeatRenderManager {\n\n  constructor(form, formFields, formFieldRegistry, pathRegistry) {\n    this._form = form;\n    this._formFields = formFields;\n    this._formFieldRegistry = formFieldRegistry;\n    this._pathRegistry = pathRegistry;\n    this.Repeater = this.Repeater.bind(this);\n    this.RepeatFooter = this.RepeatFooter.bind(this);\n  }\n\n  /**\n   * Checks whether a field is currently repeating its children.\n   *\n   * @param {string} id - The id of the field to check\n   * @returns {boolean} - True if repeatable, false otherwise\n   */\n  isFieldRepeating(id) {\n\n    if (!id) {\n      return false;\n    }\n\n    const formField = this._formFieldRegistry.get(id);\n    const formFieldDefinition = this._formFields.get(formField.type);\n    return formFieldDefinition.config.repeatable && formField.isRepeating;\n  }\n\n  Repeater(props) {\n\n    const { RowsRenderer, indexes, useSharedState, ...restProps } = props;\n\n    const [ sharedRepeatState ] = useSharedState;\n\n    const { data } = this._form._getState();\n\n    const repeaterField = props.field;\n    const dataPath = this._pathRegistry.getValuePath(repeaterField, { indexes });\n    const values = get(data, dataPath) || [];\n\n    const nonCollapsedItems = this._getNonCollapsedItems(repeaterField);\n    const collapseEnabled = !repeaterField.disableCollapse && (values.length > nonCollapsedItems);\n    const isCollapsed = collapseEnabled && sharedRepeatState.isCollapsed;\n\n    const hasChildren = repeaterField.components && repeaterField.components.length > 0;\n    const showRemove = repeaterField.allowAddRemove && hasChildren;\n\n    const displayValues = isCollapsed ? values.slice(0, nonCollapsedItems) : values;\n\n    const onDeleteItem = (index) => {\n\n      const updatedValues = values.slice();\n      updatedValues.splice(index, 1);\n\n      props.onChange({\n        field: repeaterField,\n        value: updatedValues,\n        indexes\n      });\n    };\n\n    const parentExpressionContextInfo = useContext(LocalExpressionContext);\n\n    return (\n      <>\n        {displayValues.map((itemValue, itemIndex) =>\n          <RepetitionScaffold\n            key={ itemIndex }\n            itemIndex={ itemIndex }\n            itemValue={ itemValue }\n            parentExpressionContextInfo={ parentExpressionContextInfo }\n            repeaterField={ repeaterField }\n            RowsRenderer={ RowsRenderer }\n            indexes={ indexes }\n            onDeleteItem={ onDeleteItem }\n            showRemove={ showRemove }\n            { ...restProps } />\n        )}\n      </>\n    );\n  }\n\n  RepeatFooter(props) {\n\n    const addButtonRef = useRef(null);\n    const { useSharedState, indexes, field: repeaterField, readonly, disabled } = props;\n    const [ sharedRepeatState, setSharedRepeatState ] = useSharedState;\n\n    const { data } = this._form._getState();\n\n    const dataPath = this._pathRegistry.getValuePath(repeaterField, { indexes });\n    const values = get(data, dataPath) || [];\n\n    const nonCollapsedItems = this._getNonCollapsedItems(repeaterField);\n    const collapseEnabled = !repeaterField.disableCollapse && (values.length > nonCollapsedItems);\n    const isCollapsed = collapseEnabled && sharedRepeatState.isCollapsed;\n\n    const hasChildren = repeaterField.components && repeaterField.components.length > 0;\n    const showAdd = repeaterField.allowAddRemove && hasChildren;\n\n    const toggle = () => {\n      setSharedRepeatState(state => ({ ...state, isCollapsed: !isCollapsed }));\n    };\n\n    const shouldScroll = useRef(false);\n\n    const onAddItem = () => {\n      const updatedValues = values.slice();\n      const newItem = this._form._getInitializedFieldData(this._form._getState().data, {\n        container: repeaterField,\n        indexes: { ...indexes, [ repeaterField.id ]: updatedValues.length }\n      });\n\n      updatedValues.push(newItem);\n\n      shouldScroll.current = true;\n\n      props.onChange({\n        field: repeaterField,\n        value: updatedValues,\n        indexes\n      });\n\n      setSharedRepeatState(state => ({ ...state, isCollapsed: false }));\n    };\n\n    useScrollIntoView(addButtonRef, [ values.length ], {\n      align: 'bottom',\n      behavior: 'auto',\n      offset: 20\n    }, [ shouldScroll ]);\n\n    return <div\n      className={\n        classNames('fjs-repeat-render-footer', {\n          'fjs-remove-allowed':repeaterField.allowAddRemove\n        }) }\n    >\n      {\n        showAdd ? <button type=\"button\" readOnly={ readonly } disabled={ disabled || readonly } class=\"fjs-repeat-render-add\" ref={ addButtonRef } onClick={ onAddItem }>\n          <><AddSvg /> { 'Add new' }</>\n        </button> : null\n      }\n      {\n        collapseEnabled ? <button type=\"button\" class=\"fjs-repeat-render-collapse\" onClick={ toggle }>\n          {\n            isCollapsed\n              ? <><ExpandSvg /> { `Expand all (${values.length})` }</>\n              : <><CollapseSvg /> { 'Collapse' }</>\n          }\n        </button> : null\n      }\n    </div>;\n  }\n\n  _getNonCollapsedItems(field) {\n    const DEFAULT_NON_COLLAPSED_ITEMS = 5;\n\n    const { nonCollapsedItems } = field;\n\n    return nonCollapsedItems ? nonCollapsedItems : DEFAULT_NON_COLLAPSED_ITEMS;\n  }\n\n}\n\n/**\n * Individual repetition of a repeated field and context scaffolding.\n *\n * @param {Object} props\n * @param {number} props.itemIndex\n * @param {Object} props.itemValue\n * @param {Object} props.parentExpressionContextInfo\n * @param {Object} props.repeaterField\n * @param {Function} props.RowsRenderer\n * @param {Object} props.indexes\n * @param {Function} props.onDeleteItem\n * @param {boolean} props.showRemove\n */\n\nconst RepetitionScaffold = (props) => {\n\n  const {\n    itemIndex,\n    itemValue,\n    parentExpressionContextInfo,\n    repeaterField,\n    RowsRenderer,\n    indexes,\n    onDeleteItem,\n    showRemove,\n    ...restProps\n  } = props;\n\n  const elementProps = useMemo(() => ({\n    ...restProps,\n    indexes: { ...(indexes || {}), [ repeaterField.id ]: itemIndex }\n  }), [ itemIndex, indexes, repeaterField.id, restProps ]);\n\n  const localExpressionContextInfo = useMemo(() => ({\n    data: parentExpressionContextInfo.data,\n    this: itemValue,\n    parent: buildExpressionContext(parentExpressionContextInfo),\n    i: [ ...parentExpressionContextInfo.i , itemIndex + 1 ]\n  }), [ itemIndex, parentExpressionContextInfo, itemValue ]);\n\n  return !showRemove ?\n    <LocalExpressionContext.Provider value={ localExpressionContextInfo }>\n      <RowsRenderer { ...elementProps } />\n    </LocalExpressionContext.Provider> :\n    <div class=\"fjs-repeat-row-container\">\n      <div class=\"fjs-repeat-row-rows\">\n        <LocalExpressionContext.Provider value={ localExpressionContextInfo }>\n          <RowsRenderer { ...elementProps } />\n        </LocalExpressionContext.Provider>\n      </div>\n      <button type=\"button\" class=\"fjs-repeat-row-remove\" aria-label={ `Remove list item ${itemIndex + 1}` } onClick={ () => onDeleteItem(itemIndex) }>\n        <div class=\"fjs-repeat-row-remove-icon-container\">\n          <DeleteSvg />\n        </div>\n      </button>\n    </div>;\n\n};\n\nRepeatRenderManager.$inject = [ 'form', 'formFields', 'formFieldRegistry', 'pathRegistry' ];","import { RepeatRenderManager } from './RepeatRenderManager';\n\nexport const RepeatRenderModule = {\n  __init__: [ 'repeatRenderManager' ],\n  repeatRenderManager: [ 'type', RepeatRenderManager ],\n};\n\nexport { RepeatRenderManager };","import {\n  isFunction,\n  isArray,\n  isNumber,\n  bind,\n  assign\n} from 'min-dash';\n\nvar FN_REF = '__fn';\n\nvar DEFAULT_PRIORITY = 1000;\n\nvar slice = Array.prototype.slice;\n\n/**\n * @typedef { {\n *   stopPropagation(): void;\n *   preventDefault(): void;\n *   cancelBubble: boolean;\n *   defaultPrevented: boolean;\n *   returnValue: any;\n * } } Event\n */\n\n/**\n * @template E\n *\n * @typedef { (event: E & Event, ...any) => any } EventBusEventCallback\n */\n\n/**\n * @typedef { {\n *  priority: number;\n *  next: EventBusListener | null;\n *  callback: EventBusEventCallback<any>;\n * } } EventBusListener\n */\n\n/**\n * A general purpose event bus.\n *\n * This component is used to communicate across a diagram instance.\n * Other parts of a diagram can use it to listen to and broadcast events.\n *\n *\n * ## Registering for Events\n *\n * The event bus provides the {@link EventBus#on} and {@link EventBus#once}\n * methods to register for events. {@link EventBus#off} can be used to\n * remove event registrations. Listeners receive an instance of {@link Event}\n * as the first argument. It allows them to hook into the event execution.\n *\n * ```javascript\n *\n * // listen for event\n * eventBus.on('foo', function(event) {\n *\n *   // access event type\n *   event.type; // 'foo'\n *\n *   // stop propagation to other listeners\n *   event.stopPropagation();\n *\n *   // prevent event default\n *   event.preventDefault();\n * });\n *\n * // listen for event with custom payload\n * eventBus.on('bar', function(event, payload) {\n *   console.log(payload);\n * });\n *\n * // listen for event returning value\n * eventBus.on('foobar', function(event) {\n *\n *   // stop event propagation + prevent default\n *   return false;\n *\n *   // stop event propagation + return custom result\n *   return {\n *     complex: 'listening result'\n *   };\n * });\n *\n *\n * // listen with custom priority (default=1000, higher is better)\n * eventBus.on('priorityfoo', 1500, function(event) {\n *   console.log('invoked first!');\n * });\n *\n *\n * // listen for event and pass the context (`this`)\n * eventBus.on('foobar', function(event) {\n *   this.foo();\n * }, this);\n * ```\n *\n *\n * ## Emitting Events\n *\n * Events can be emitted via the event bus using {@link EventBus#fire}.\n *\n * ```javascript\n *\n * // false indicates that the default action\n * // was prevented by listeners\n * if (eventBus.fire('foo') === false) {\n *   console.log('default has been prevented!');\n * };\n *\n *\n * // custom args + return value listener\n * eventBus.on('sum', function(event, a, b) {\n *   return a + b;\n * });\n *\n * // you can pass custom arguments + retrieve result values.\n * var sum = eventBus.fire('sum', 1, 2);\n * console.log(sum); // 3\n * ```\n */\nexport default function EventBus() {\n\n  /**\n   * @type { Record<string, EventBusListener> }\n   */\n  this._listeners = {};\n\n  // cleanup on destroy on lowest priority to allow\n  // message passing until the bitter end\n  this.on('diagram.destroy', 1, this._destroy, this);\n}\n\n\n/**\n * Register an event listener for events with the given name.\n *\n * The callback will be invoked with `event, ...additionalArguments`\n * that have been passed to {@link EventBus#fire}.\n *\n * Returning false from a listener will prevent the events default action\n * (if any is specified). To stop an event from being processed further in\n * other listeners execute {@link Event#stopPropagation}.\n *\n * Returning anything but `undefined` from a listener will stop the listener propagation.\n *\n * @template T\n *\n * @param {string|string[]} events to subscribe to\n * @param {number} [priority=1000] listen priority\n * @param {EventBusEventCallback<T>} callback\n * @param {any} [that] callback context\n */\nEventBus.prototype.on = function(events, priority, callback, that) {\n\n  events = isArray(events) ? events : [ events ];\n\n  if (isFunction(priority)) {\n    that = callback;\n    callback = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  if (!isNumber(priority)) {\n    throw new Error('priority must be a number');\n  }\n\n  var actualCallback = callback;\n\n  if (that) {\n    actualCallback = bind(callback, that);\n\n    // make sure we remember and are able to remove\n    // bound callbacks via {@link #off} using the original\n    // callback\n    actualCallback[FN_REF] = callback[FN_REF] || callback;\n  }\n\n  var self = this;\n\n  events.forEach(function(e) {\n    self._addListener(e, {\n      priority: priority,\n      callback: actualCallback,\n      next: null\n    });\n  });\n};\n\n/**\n * Register an event listener that is called only once.\n *\n * @template T\n *\n * @param {string|string[]} events to subscribe to\n * @param {number} [priority=1000] the listen priority\n * @param {EventBusEventCallback<T>} callback\n * @param {any} [that] callback context\n */\nEventBus.prototype.once = function(events, priority, callback, that) {\n  var self = this;\n\n  if (isFunction(priority)) {\n    that = callback;\n    callback = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  if (!isNumber(priority)) {\n    throw new Error('priority must be a number');\n  }\n\n  function wrappedCallback() {\n    wrappedCallback.__isTomb = true;\n\n    var result = callback.apply(that, arguments);\n\n    self.off(events, wrappedCallback);\n\n    return result;\n  }\n\n  // make sure we remember and are able to remove\n  // bound callbacks via {@link #off} using the original\n  // callback\n  wrappedCallback[FN_REF] = callback;\n\n  this.on(events, priority, wrappedCallback);\n};\n\n\n/**\n * Removes event listeners by event and callback.\n *\n * If no callback is given, all listeners for a given event name are being removed.\n *\n * @param {string|string[]} events\n * @param {EventBusEventCallback} [callback]\n */\nEventBus.prototype.off = function(events, callback) {\n\n  events = isArray(events) ? events : [ events ];\n\n  var self = this;\n\n  events.forEach(function(event) {\n    self._removeListener(event, callback);\n  });\n\n};\n\n\n/**\n * Create an event recognized be the event bus.\n *\n * @param {Object} data Event data.\n *\n * @return {Event} An event that will be recognized by the event bus.\n */\nEventBus.prototype.createEvent = function(data) {\n  var event = new InternalEvent();\n\n  event.init(data);\n\n  return event;\n};\n\n\n/**\n * Fires an event.\n *\n * @example\n *\n * ```javascript\n * // fire event by name\n * events.fire('foo');\n *\n * // fire event object with nested type\n * var event = { type: 'foo' };\n * events.fire(event);\n *\n * // fire event with explicit type\n * var event = { x: 10, y: 20 };\n * events.fire('element.moved', event);\n *\n * // pass additional arguments to the event\n * events.on('foo', function(event, bar) {\n *   alert(bar);\n * });\n *\n * events.fire({ type: 'foo' }, 'I am bar!');\n * ```\n *\n * @param {string} [type] event type\n * @param {Object} [data] event or event data\n * @param {...any} [args] additional arguments the callback will be called with.\n *\n * @return {any} The return value. Will be set to `false` if the default was prevented.\n */\nEventBus.prototype.fire = function(type, data) {\n  var event,\n      firstListener,\n      returnValue,\n      args;\n\n  args = slice.call(arguments);\n\n  if (typeof type === 'object') {\n    data = type;\n    type = data.type;\n  }\n\n  if (!type) {\n    throw new Error('no event type specified');\n  }\n\n  firstListener = this._listeners[type];\n\n  if (!firstListener) {\n    return;\n  }\n\n  // we make sure we fire instances of our home made\n  // events here. We wrap them only once, though\n  if (data instanceof InternalEvent) {\n\n    // we are fine, we alread have an event\n    event = data;\n  } else {\n    event = this.createEvent(data);\n  }\n\n  // ensure we pass the event as the first parameter\n  args[0] = event;\n\n  // original event type (in case we delegate)\n  var originalType = event.type;\n\n  // update event type before delegation\n  if (type !== originalType) {\n    event.type = type;\n  }\n\n  try {\n    returnValue = this._invokeListeners(event, args, firstListener);\n  } finally {\n\n    // reset event type after delegation\n    if (type !== originalType) {\n      event.type = originalType;\n    }\n  }\n\n  // set the return value to false if the event default\n  // got prevented and no other return value exists\n  if (returnValue === undefined && event.defaultPrevented) {\n    returnValue = false;\n  }\n\n  return returnValue;\n};\n\n/**\n * Handle an error by firing an event.\n *\n * @param {Error} error The error to be handled.\n *\n * @return {boolean} Whether the error was handled.\n */\nEventBus.prototype.handleError = function(error) {\n  return this.fire('error', { error: error }) === false;\n};\n\n\nEventBus.prototype._destroy = function() {\n  this._listeners = {};\n};\n\n/**\n * @param {Event} event\n * @param {any[]} args\n * @param {EventBusListener} listener\n *\n * @return {any}\n */\nEventBus.prototype._invokeListeners = function(event, args, listener) {\n\n  var returnValue;\n\n  while (listener) {\n\n    // handle stopped propagation\n    if (event.cancelBubble) {\n      break;\n    }\n\n    returnValue = this._invokeListener(event, args, listener);\n\n    listener = listener.next;\n  }\n\n  return returnValue;\n};\n\n/**\n * @param {Event} event\n * @param {any[]} args\n * @param {EventBusListener} listener\n *\n * @return {any}\n */\nEventBus.prototype._invokeListener = function(event, args, listener) {\n\n  var returnValue;\n\n  if (listener.callback.__isTomb) {\n    return returnValue;\n  }\n\n  try {\n\n    // returning false prevents the default action\n    returnValue = invokeFunction(listener.callback, args);\n\n    // stop propagation on return value\n    if (returnValue !== undefined) {\n      event.returnValue = returnValue;\n      event.stopPropagation();\n    }\n\n    // prevent default on return false\n    if (returnValue === false) {\n      event.preventDefault();\n    }\n  } catch (error) {\n    if (!this.handleError(error)) {\n      console.error('unhandled error in event listener', error);\n\n      throw error;\n    }\n  }\n\n  return returnValue;\n};\n\n/**\n * Add new listener with a certain priority to the list\n * of listeners (for the given event).\n *\n * The semantics of listener registration / listener execution are\n * first register, first serve: New listeners will always be inserted\n * after existing listeners with the same priority.\n *\n * Example: Inserting two listeners with priority 1000 and 1300\n *\n *    * before: [ 1500, 1500, 1000, 1000 ]\n *    * after: [ 1500, 1500, (new=1300), 1000, 1000, (new=1000) ]\n *\n * @param {string} event\n * @param {EventBusListener} newListener\n */\nEventBus.prototype._addListener = function(event, newListener) {\n\n  var listener = this._getListeners(event),\n      previousListener;\n\n  // no prior listeners\n  if (!listener) {\n    this._setListeners(event, newListener);\n\n    return;\n  }\n\n  // ensure we order listeners by priority from\n  // 0 (high) to n > 0 (low)\n  while (listener) {\n\n    if (listener.priority < newListener.priority) {\n\n      newListener.next = listener;\n\n      if (previousListener) {\n        previousListener.next = newListener;\n      } else {\n        this._setListeners(event, newListener);\n      }\n\n      return;\n    }\n\n    previousListener = listener;\n    listener = listener.next;\n  }\n\n  // add new listener to back\n  previousListener.next = newListener;\n};\n\n\n/**\n * @param {string} name\n *\n * @return {EventBusListener}\n */\nEventBus.prototype._getListeners = function(name) {\n  return this._listeners[name];\n};\n\n/**\n * @param {string} name\n * @param {EventBusListener} listener\n */\nEventBus.prototype._setListeners = function(name, listener) {\n  this._listeners[name] = listener;\n};\n\nEventBus.prototype._removeListener = function(event, callback) {\n\n  var listener = this._getListeners(event),\n      nextListener,\n      previousListener,\n      listenerCallback;\n\n  if (!callback) {\n\n    // clear listeners\n    this._setListeners(event, null);\n\n    return;\n  }\n\n  while (listener) {\n\n    nextListener = listener.next;\n\n    listenerCallback = listener.callback;\n\n    if (listenerCallback === callback || listenerCallback[FN_REF] === callback) {\n      if (previousListener) {\n        previousListener.next = nextListener;\n      } else {\n\n        // new first listener\n        this._setListeners(event, nextListener);\n      }\n    }\n\n    previousListener = listener;\n    listener = nextListener;\n  }\n};\n\n/**\n * A event that is emitted via the event bus.\n */\nfunction InternalEvent() { }\n\nInternalEvent.prototype.stopPropagation = function() {\n  this.cancelBubble = true;\n};\n\nInternalEvent.prototype.preventDefault = function() {\n  this.defaultPrevented = true;\n};\n\nInternalEvent.prototype.init = function(data) {\n  assign(this, data || {});\n};\n\n\n/**\n * Invoke function. Be fast...\n *\n * @param {Function} fn\n * @param {any[]} args\n *\n * @return {any}\n */\nfunction invokeFunction(fn, args) {\n  return fn.apply(null, args);\n}\n","import { isNil, get, set } from 'min-dash';\nimport { countDecimals } from '../render/components/util/numberFieldUtil';\nimport Big from 'big.js';\n\nconst EMAIL_PATTERN = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;\nconst PHONE_PATTERN = /(\\+|00)(297|93|244|1264|358|355|376|971|54|374|1684|1268|61|43|994|257|32|229|226|880|359|973|1242|387|590|375|501|1441|591|55|1246|673|975|267|236|1|61|41|56|86|225|237|243|242|682|57|269|238|506|53|5999|61|1345|357|420|49|253|1767|45|1809|1829|1849|213|593|20|291|212|34|372|251|358|679|500|33|298|691|241|44|995|44|233|350|224|590|220|245|240|30|1473|299|502|594|1671|592|852|504|385|509|36|62|44|91|246|353|98|964|354|972|39|1876|44|962|81|76|77|254|996|855|686|1869|82|383|965|856|961|231|218|1758|423|94|266|370|352|371|853|590|212|377|373|261|960|52|692|389|223|356|95|382|976|1670|258|222|1664|596|230|265|60|262|264|687|227|672|234|505|683|31|47|977|674|64|968|92|507|64|51|63|680|675|48|1787|1939|850|351|595|970|689|974|262|40|7|250|966|249|221|65|500|4779|677|232|503|378|252|508|381|211|239|597|421|386|46|268|1721|248|963|1649|235|228|66|992|690|993|670|676|1868|216|90|688|886|255|256|380|598|1|998|3906698|379|1784|58|1284|1340|84|678|681|685|967|27|260|263)(9[976]\\d|8[987530]\\d|6[987]\\d|5[90]\\d|42\\d|3[875]\\d|2[98654321]\\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)\\d{4,20}$/;\n\nconst VALIDATE_FEEL_PROPERTIES = [\n  'min',\n  'max',\n  'minLength',\n  'maxLength'\n];\n\nexport class Validator {\n\n  constructor(expressionLanguage, conditionChecker, form) {\n    this._expressionLanguage = expressionLanguage;\n    this._conditionChecker = conditionChecker;\n    this._form = form;\n  }\n\n  validateField(field, value) {\n\n    const { type, validate } = field;\n\n    let errors = [];\n\n    if (type === 'number') {\n\n      const { decimalDigits, increment } = field;\n\n      if (value === 'NaN') {\n\n        errors = [\n          ...errors,\n          'Value is not a number.'\n        ];\n\n      }\n      else if (value) {\n\n        if (decimalDigits >= 0 && countDecimals(value) > decimalDigits) {\n          errors = [\n            ...errors,\n            'Value is expected to ' +\n            (decimalDigits === 0\n              ? 'be an integer'\n              : `have at most ${decimalDigits} decimal digit${decimalDigits > 1 ? 's' : ''}`\n            ) + '.'\n          ];\n        }\n\n        if (increment) {\n\n          const bigValue = Big(value);\n          const bigIncrement = Big(increment);\n\n          const offset = bigValue.mod(bigIncrement);\n\n          if (offset.cmp(0) !== 0) {\n            const previousValue = bigValue.minus(offset);\n            const nextValue = previousValue.plus(bigIncrement);\n\n            errors = [\n              ...errors,\n              `Please select a valid value, the two nearest valid values are ${previousValue} and ${nextValue}.`\n            ];\n          }\n        }\n      }\n    }\n\n    if (!validate) {\n      return errors;\n    }\n\n    const evaluatedValidation = evaluateFEELValues(\n      validate,\n      this._expressionLanguage,\n      this._conditionChecker,\n      this._form\n    );\n\n    if (evaluatedValidation.pattern && value && !new RegExp(evaluatedValidation.pattern).test(value)) {\n      errors = [\n        ...errors,\n        `Field must match pattern ${ evaluatedValidation.pattern }.`\n      ];\n    }\n\n    if (evaluatedValidation.required) {\n      const isUncheckedCheckbox = type === 'checkbox' && value === false;\n      const isUnsetValue = isNil(value) || value === '';\n      const isEmptyMultiselect = Array.isArray(value) && value.length === 0;\n\n      if (isUncheckedCheckbox || isUnsetValue || isEmptyMultiselect) {\n        errors = [\n          ...errors,\n          'Field is required.'\n        ];\n      }\n    }\n\n    if ('min' in evaluatedValidation && (value || value === 0) && value < evaluatedValidation.min) {\n      errors = [\n        ...errors,\n        `Field must have minimum value of ${ evaluatedValidation.min }.`\n      ];\n    }\n\n    if ('max' in evaluatedValidation && (value || value === 0) && value > evaluatedValidation.max) {\n      errors = [\n        ...errors,\n        `Field must have maximum value of ${ evaluatedValidation.max }.`\n      ];\n    }\n\n    if ('minLength' in evaluatedValidation && value && value.trim().length < evaluatedValidation.minLength) {\n      errors = [\n        ...errors,\n        `Field must have minimum length of ${ evaluatedValidation.minLength }.`\n      ];\n    }\n\n    if ('maxLength' in evaluatedValidation && value && value.trim().length > evaluatedValidation.maxLength) {\n      errors = [\n        ...errors,\n        `Field must have maximum length of ${ evaluatedValidation.maxLength }.`\n      ];\n    }\n\n    if ('validationType' in evaluatedValidation && value && evaluatedValidation.validationType === 'phone' && !PHONE_PATTERN.test(value)) {\n      errors = [\n        ...errors,\n        'Field must be a valid  international phone number. (e.g. +4930664040900)'\n      ];\n    }\n\n    if ('validationType' in evaluatedValidation && value && evaluatedValidation.validationType === 'email' && !EMAIL_PATTERN.test(value)) {\n      errors = [\n        ...errors,\n        'Field must be a valid email.'\n      ];\n    }\n\n    return errors;\n  }\n}\n\nValidator.$inject = [ 'expressionLanguage', 'conditionChecker', 'form' ];\n\n\n// helpers //////////\n\n/**\n * Helper function to evaluate optional FEEL validation values.\n */\nfunction evaluateFEELValues(validate, expressionLanguage, conditionChecker, form) {\n\n  const evaluatedValidate = { ...validate };\n\n  VALIDATE_FEEL_PROPERTIES.forEach(property => {\n    const path = property.split('.');\n\n    const value = get(evaluatedValidate, path);\n\n    // mirroring FEEL evaluation of our hooks\n    if (!expressionLanguage || !expressionLanguage.isExpression(value)) {\n      return value;\n    }\n\n    const { initialData, data } = form._getState();\n\n    const newData = conditionChecker ? conditionChecker.applyConditions(data, data) : data;\n    const filteredData = { ...initialData, ...newData };\n\n    const evaluatedValue = expressionLanguage.evaluate(value, filteredData);\n\n    // replace validate property with evaluated value\n    if (evaluatedValue) {\n      set(evaluatedValidate, path, evaluatedValue);\n    }\n  });\n\n  return evaluatedValidate;\n}","import { clone } from '../util';\n\nexport class Importer {\n\n  /**\n   * @constructor\n   * @param { import('./FormFieldRegistry').FormFieldRegistry } formFieldRegistry\n   * @param { import('./PathRegistry').PathRegistry } pathRegistry\n   * @param { import('./FieldFactory').FieldFactory } fieldFactory\n   * @param { import('./FormLayouter').FormLayouter } formLayouter\n   */\n  constructor(formFieldRegistry, pathRegistry, fieldFactory, formLayouter) {\n    this._formFieldRegistry = formFieldRegistry;\n    this._pathRegistry = pathRegistry;\n    this._fieldFactory = fieldFactory;\n    this._formLayouter = formLayouter;\n  }\n\n  /**\n   * Import schema creating rows, fields, attaching additional\n   * information to each field and adding fields to the\n   * field registry.\n   *\n   * Additional information attached:\n   *\n   *   * `id` (unless present)\n   *   * `_parent`\n   *   * `_path`\n   *\n   * @param {any} schema\n   *\n   * @typedef {{ warnings: Error[], schema: any }} ImportResult\n   * @returns {ImportResult}\n   */\n  importSchema(schema) {\n\n    // TODO: Add warnings\n    const warnings = [];\n\n    try {\n      this._cleanup();\n      const importedSchema = this.importFormField(clone(schema));\n      this._formLayouter.calculateLayout(clone(importedSchema));\n\n      return {\n        schema: importedSchema,\n        warnings\n      };\n    } catch (err) {\n      this._cleanup();\n      err.warnings = warnings;\n      throw err;\n    }\n  }\n\n  _cleanup() {\n    this._formLayouter.clear();\n    this._formFieldRegistry.clear();\n    this._pathRegistry.clear();\n  }\n\n  /**\n   * @param {{[x: string]: any}} fieldAttrs\n   * @param {String} [parentId]\n   * @param {number} [index]\n   *\n   * @return {any} field\n   */\n  importFormField(fieldAttrs, parentId, index) {\n    const {\n      components\n    } = fieldAttrs;\n\n    let parent, path;\n\n    if (parentId) {\n      parent = this._formFieldRegistry.get(parentId);\n    }\n\n    // set form field path\n    path = parent ? [ ...parent._path, 'components', index ] : [];\n\n    const field = this._fieldFactory.create({\n      ...fieldAttrs,\n      _path: path,\n      _parent: parentId\n    }, false);\n\n    this._formFieldRegistry.add(field);\n\n    if (components) {\n      field.components = this.importFormFields(components, field.id);\n    }\n\n    return field;\n  }\n\n  /**\n   * @param {Array<any>} components\n   * @param {string} parentId\n   *\n   * @return {Array<any>} imported components\n   */\n  importFormFields(components, parentId) {\n    return components.map((component, index) => {\n      return this.importFormField(component, parentId, index);\n    });\n  }\n\n}\n\nImporter.$inject = [ 'formFieldRegistry', 'pathRegistry', 'fieldFactory', 'formLayouter' ];","import { getAncestryList } from '../util';\n\nexport class FieldFactory {\n\n  /**\n   * @constructor\n   *\n   * @param  formFieldRegistry\n   * @param  formFields\n   */\n  constructor(formFieldRegistry, pathRegistry, formFields) {\n    this._formFieldRegistry = formFieldRegistry;\n    this._pathRegistry = pathRegistry;\n    this._formFields = formFields;\n  }\n\n  create(attrs, applyDefaults = true) {\n\n    const {\n      id,\n      type,\n      key,\n      path,\n      _parent\n    } = attrs;\n\n    const fieldDefinition = this._formFields.get(type);\n\n    if (!fieldDefinition) {\n      throw new Error(`form field of type <${ type }> not supported`);\n    }\n\n    const { config } = fieldDefinition;\n\n    if (!config) {\n      throw new Error(`form field of type <${ type }> has no config`);\n    }\n\n    if (id && this._formFieldRegistry._ids.assigned(id)) {\n      throw new Error(`form field with id <${ id }> already exists`);\n    }\n\n    // ensure that we can claim the path\n\n    const parent = _parent && this._formFieldRegistry.get(_parent);\n    const parentPath = parent && this._pathRegistry.getValuePath(parent) || [];\n    const knownAncestorIds = getAncestryList(_parent, this._formFieldRegistry);\n\n    if (config.keyed && key && !this._pathRegistry.canClaimPath([ ...parentPath, ...key.split('.') ],\n      {\n        isClosed: true,\n        knownAncestorIds\n      })\n    ) {\n      throw new Error(`binding path '${ [ ...parentPath, key ].join('.') }' is already claimed`);\n    }\n\n    if (config.pathed && path && !this._pathRegistry.canClaimPath([ ...parentPath, ...path.split('.') ],\n      {\n        isRepeatable: config.repeatable,\n        knownAncestorIds\n      })\n    ) {\n      throw new Error(`binding path '${ [ ...parentPath, ...path.split('.') ].join('.') }' is already claimed`);\n    }\n\n    const labelAttrs = applyDefaults && config.label ? {\n      label: config.label\n    } : {};\n\n    const field = config.create({\n      ...labelAttrs,\n      ...attrs\n    });\n\n    this._ensureId(field);\n\n    if (config.keyed) {\n      this._ensureKey(field);\n      this._pathRegistry.claimPath(this._pathRegistry.getValuePath(field), { isClosed: true, claimerId: field.id, knownAncestorIds: getAncestryList(_parent, this._formFieldRegistry) });\n    }\n\n    if (config.pathed) {\n      if (config.repeatable) {\n        this._enforceDefaultPath(field);\n      }\n\n      if (field.path) {\n        this._pathRegistry.claimPath(this._pathRegistry.getValuePath(field), { isRepeatable: config.repeatable, claimerId: field.id, knownAncestorIds: getAncestryList(_parent, this._formFieldRegistry) });\n      }\n    }\n\n    return field;\n  }\n\n  _ensureId(field) {\n\n    if (field.id) {\n      this._formFieldRegistry._ids.claim(field.id, field);\n\n      return;\n    }\n\n    let prefix = 'Field';\n\n    if (field.type === 'default') {\n      prefix = 'Form';\n    }\n\n    field.id = this._formFieldRegistry._ids.nextPrefixed(`${prefix}_`, field);\n  }\n\n  _ensureKey(field) {\n    if (!field.key) {\n      field.key = this._getUniqueKeyPath(field);\n    }\n  }\n\n  _enforceDefaultPath(field) {\n    if (!field.path) {\n      field.path = this._getUniqueKeyPath(field);\n    }\n  }\n\n  _getUniqueKeyPath(field) {\n\n    let random;\n    const parent = this._formFieldRegistry.get(field._parent);\n\n    // ensure key uniqueness at level\n    do {\n      random = Math.random().toString(36).substring(7);\n    } while (parent && parent.components.some(child => child.key === random));\n\n    return `${field.type}_${random}`;\n  }\n\n}\n\n\nFieldFactory.$inject = [\n  'formFieldRegistry',\n  'pathRegistry',\n  'formFields'\n];","import { isArray } from 'min-dash';\nimport { clone, getAncestryList } from '../util';\n\n/**\n * The PathRegistry class manages a hierarchical structure of paths associated with form fields.\n * It enables claiming, unclaiming, and validating paths within this structure.\n *\n * Example Tree Structure:\n *\n *   [\n *     {\n *       segment: 'root',\n *       claimCount: 1,\n *       children: [\n *         {\n *           segment: 'child1',\n *           claimCount: 2,\n *           children: null  // A leaf node (closed path)\n *         },\n *         {\n *           segment: 'child2',\n *           claimCount: 1,\n *           children: [\n *             {\n *               segment: 'subChild1',\n *               claimCount: 1,\n *               children: []  // An open node (open path)\n *             }\n *           ]\n *         }\n *       ]\n *     }\n *   ]\n */\nexport class PathRegistry {\n  constructor(formFieldRegistry, formFields, injector) {\n    this._formFieldRegistry = formFieldRegistry;\n    this._formFields = formFields;\n    this._injector = injector;\n    this._dataPaths = [];\n  }\n\n  canClaimPath(path, options = {}) {\n\n    const {\n      isClosed = false,\n      isRepeatable = false,\n      skipAncestryCheck = false,\n      claimerId = null,\n      knownAncestorIds = []\n    } = options;\n\n    let node = { children: this._dataPaths };\n\n    // (1) if we reach a leaf node, we cannot claim it, if we reach an open node, we can\n    // if we reach a repeatable node, we need to ensure that the claimer is (or will be) an ancestor of the repeater\n    for (const segment of path) {\n\n      node = _getNextSegment(node, segment);\n\n      if (!node) {\n        return true;\n      }\n\n      if (node.isRepeatable && !skipAncestryCheck) {\n\n        if (!(claimerId || knownAncestorIds.length)) {\n          throw new Error('cannot claim a path that contains a repeater without specifying a claimerId or knownAncestorIds');\n        }\n\n        const isValidRepeatClaim =\n          knownAncestorIds.includes(node.repeaterId) ||\n          claimerId && getAncestryList(claimerId, this._formFieldRegistry).includes(node.repeaterId);\n\n        if (!isValidRepeatClaim) {\n          return false;\n        }\n      }\n\n      if (node.children === null) {\n        return false;\n      }\n\n    }\n\n    // (2) if the path lands in the middle of the tree, we can only claim an open, non-repeatable path\n    return !(isClosed || isRepeatable);\n  }\n\n  claimPath(path, options = {}) {\n\n    const {\n      isClosed = false,\n      isRepeatable = false,\n      claimerId = null,\n      knownAncestorIds = []\n    } = options;\n\n    if (!this.canClaimPath(path, { isClosed, isRepeatable, claimerId, knownAncestorIds })) {\n      throw new Error(`cannot claim path '${ path.join('.') }'`);\n    }\n\n    let node = { children: this._dataPaths };\n\n    for (const segment of path) {\n\n      let child = _getNextSegment(node, segment);\n\n      if (!child) {\n        child = { segment, claimCount: 1, children: [] };\n        node.children.push(child);\n      }\n      else {\n        child.claimCount++;\n      }\n\n      node = child;\n    }\n\n    if (isClosed) {\n      node.children = null;\n    }\n\n    // add some additional info when we make a repeatable path claim\n    if (isRepeatable) {\n      node.isRepeatable = true;\n      node.repeaterId = claimerId;\n    }\n\n  }\n\n  unclaimPath(path) {\n\n    // verification Pass\n    let node = { children: this._dataPaths };\n    for (const segment of path) {\n      const child = _getNextSegment(node, segment);\n      if (!child) {\n        throw new Error(`no open path found for '${ path.join('.') }'`);\n      }\n      node = child;\n    }\n\n    // mutation Pass\n    node = { children: this._dataPaths };\n    for (const segment of path) {\n      const child = _getNextSegment(node, segment);\n\n      child.claimCount--;\n\n      if (child.claimCount === 0) {\n        node.children.splice(node.children.indexOf(child), 1);\n        break; // Abort early if claimCount reaches zero\n      }\n\n      node = child;\n    }\n  }\n\n  /**\n   * Applies a function (fn) recursively on a given field and its children.\n   *\n   * - `field`: Starting field object.\n   * - `fn`: Function to apply.\n   * - `context`: Optional object for passing data between calls.\n   *\n   * Stops early if `fn` returns `false`. Useful for traversing the form field tree.\n   *\n   * @returns {boolean} Success status based on function execution.\n   */\n  executeRecursivelyOnFields(field, fn, context = {}) {\n\n    let result = true;\n\n    const formFieldConfig = this._formFields.get(field.type).config;\n\n    if (formFieldConfig.keyed) {\n      const callResult = fn({ field, isClosed: true, isRepeatable: false, context });\n      return result && callResult;\n    }\n    else if (formFieldConfig.pathed) {\n      const callResult = fn({ field, isClosed: false, isRepeatable: formFieldConfig.repeatable, context });\n      result = result && callResult;\n    }\n\n    // stop executing if false is specifically returned or if preventing recursion\n    if (result === false || context.preventRecursion) {\n      return result;\n    }\n\n    if (Array.isArray(field.components)) {\n      for (const child of field.components) {\n        const callResult = this.executeRecursivelyOnFields(child, fn, clone(context));\n        result = result && callResult;\n\n        // stop executing if false is specifically returned\n        if (result === false) {\n          return result;\n        }\n      }\n    }\n\n    return result;\n  }\n\n  /**\n   * Generates an array representing the binding path to an underlying data object for a form field.\n   *\n   * @param {Object} field - The field object with properties: `key`, `path`, `id`, and optionally `_parent`.\n   * @param {Object} [options={}] - Configuration options.\n   * @param {Object} [options.replacements={}] - A map of field IDs to alternative path arrays.\n   * @param {Object} [options.indexes=null] - A map of parent IDs to the index of the field within said parent, leave null to get an unindexed path.\n   * @param {Object} [options.cutoffNode] - The ID of the parent field at which to stop generating the path.\n   *\n   * @returns {(Array<string>|undefined)} An array of strings representing the binding path, or undefined if not determinable.\n   */\n  getValuePath(field, options = {}) {\n    const {\n      replacements = {},\n      indexes = null,\n      cutoffNode = null\n    } = options;\n\n    let localValuePath = [];\n\n    const hasReplacement = Object.prototype.hasOwnProperty.call(replacements, field.id);\n    const formFieldConfig = this._formFields.get(field.type).config;\n\n    // uses path overrides instead of true path to calculate a potential value path\n    if (hasReplacement) {\n      const replacement = replacements[field.id];\n\n      if (replacement === null || replacement === undefined || replacement === '') {\n        localValuePath = [];\n      } else if (typeof replacement === 'string') {\n        localValuePath = replacement.split('.');\n      } else if (Array.isArray(replacement)) {\n        localValuePath = replacement;\n      } else {\n        throw new Error(`replacements for field ${ field.id } must be a string, array or null/undefined`);\n      }\n\n    } else if (formFieldConfig.keyed) {\n      localValuePath = field.key.split('.');\n    } else if (formFieldConfig.pathed && field.path) {\n      localValuePath = field.path.split('.');\n    }\n\n    // add potential indexes of repeated fields\n    if (indexes) {\n      localValuePath = this._addIndexes(localValuePath, field, indexes);\n    }\n\n    // if parent exists and isn't cutoff node, add parent's value path\n    if (field._parent && field._parent !== cutoffNode) {\n      const parent = this._formFieldRegistry.get(field._parent);\n      return [ ...(this.getValuePath(parent, options) || []), ...localValuePath ];\n    }\n\n    return localValuePath;\n  }\n\n  clear() {\n    this._dataPaths = [];\n  }\n\n  _addIndexes(localValuePath, field, indexes) {\n\n    const repeatRenderManager = this._injector.get('repeatRenderManager', false);\n\n    if (repeatRenderManager && repeatRenderManager.isFieldRepeating(field._parent)) {\n      return [ indexes[field._parent], ...localValuePath ];\n    }\n\n    return localValuePath;\n  }\n}\n\nconst _getNextSegment = (node, segment) => {\n  if (isArray(node.children)) { return node.children.find((node) => node.segment === segment) || null; }\n  return null;\n};\n\nPathRegistry.$inject = [ 'formFieldRegistry', 'formFields', 'injector' ];","import Ids from 'ids';\n\nimport { groupBy } from 'min-dash';\n\n\n/**\n * @typedef { { id: String, components: Array<String> } } FormRow\n * @typedef { { formFieldId: String, rows: Array<FormRow> } } FormRows\n */\n\n/**\n * Maintains the Form layout in a given structure, for example\n *\n *  [\n *    {\n *      formFieldId: 'FormField_1',\n *      rows: [\n *        { id: 'Row_1', components: [ 'Text_1', 'Textdield_1', ... ]  }\n *      ]\n *    }\n *  ]\n *\n */\nexport class FormLayouter {\n\n  constructor(eventBus) {\n\n    /** @type Array<FormRows>  */\n    this._rows = [];\n    this._ids = new Ids([ 32, 36, 1 ]);\n\n    this._eventBus = eventBus;\n  }\n\n  /**\n   * @param {FormRow} row\n   */\n  addRow(formFieldId, row) {\n    let rowsPerComponent = this._rows.find(r => r.formFieldId === formFieldId);\n\n    if (!rowsPerComponent) {\n      rowsPerComponent = {\n        formFieldId,\n        rows: []\n      };\n\n      this._rows.push(rowsPerComponent);\n    }\n\n    rowsPerComponent.rows.push(row);\n  }\n\n  /**\n   * @param {String} id\n   * @returns {FormRow}\n   */\n  getRow(id) {\n    const rows = allRows(this._rows);\n    return rows.find(r => r.id === id);\n  }\n\n  /**\n   * @param {any} formField\n   * @returns {FormRow}\n   */\n  getRowForField(formField) {\n    return allRows(this._rows).find(r => {\n      const { components } = r;\n\n      return components.includes(formField.id);\n    });\n  }\n\n  /**\n   * @param {String} formFieldId\n   * @returns { Array<FormRow> }\n   */\n  getRows(formFieldId) {\n    const rowsForField = this._rows.find(r => formFieldId === r.formFieldId);\n\n    if (!rowsForField) {\n      return [];\n    }\n\n    return rowsForField.rows;\n  }\n\n  /**\n   * @returns {string}\n   */\n  nextRowId() {\n    return this._ids.nextPrefixed('Row_');\n  }\n\n  /**\n   * @param {any} formField\n   */\n  calculateLayout(formField) {\n\n    const {\n      type,\n      components\n    } = formField;\n\n    if (![ 'default', 'group', 'dynamiclist' ].includes(type) || !components) {\n      return;\n    }\n\n    // (1) calculate rows order (by component order)\n    const rowsInOrder = groupByRow(components, this._ids);\n\n    Object.entries(rowsInOrder).forEach(([ id, components ]) => {\n\n      // (2) add fields to rows\n      this.addRow(formField.id, {\n        id: id,\n        components: components.map(c => c.id)\n      });\n    });\n\n    // (3) traverse through nested components\n    components.forEach(field => this.calculateLayout(field));\n\n    // (4) fire event to notify interested parties\n    this._eventBus.fire('form.layoutCalculated', { rows: this._rows });\n  }\n\n  clear() {\n    this._rows = [];\n    this._ids.clear();\n\n    // fire event to notify interested parties\n    this._eventBus.fire('form.layoutCleared');\n  }\n}\n\nFormLayouter.$inject = [ 'eventBus' ];\n\n\n// helpers //////\n\nfunction groupByRow(components, ids) {\n  return groupBy(components, c => {\n\n    // mitigate missing row by creating new (handle legacy)\n    const { layout } = c;\n\n    if (!layout || !layout.row) {\n      return ids.nextPrefixed('Row_');\n    }\n\n    return layout.row;\n  });\n}\n\n/**\n * @param {Array<FormRows>} formRows\n * @returns {Array<FormRow>}\n */\nfunction allRows(formRows) {\n  return formRows.map(r => r.rows).flat();\n}","import Ids from 'ids';\n\nexport class FormFieldRegistry {\n  constructor(eventBus) {\n    this._eventBus = eventBus;\n\n    this._formFields = {};\n\n    eventBus.on('form.clear', () => this.clear());\n\n    this._ids = new Ids([ 32, 36, 1 ]);\n  }\n\n  add(formField) {\n    const { id } = formField;\n\n    if (this._formFields[ id ]) {\n      throw new Error(`form field with ID ${ id } already exists`);\n    }\n\n    this._eventBus.fire('formField.add', { formField });\n\n    this._formFields[ id ] = formField;\n  }\n\n  remove(formField) {\n    const { id } = formField;\n\n    if (!this._formFields[ id ]) {\n      return;\n    }\n\n    this._eventBus.fire('formField.remove', { formField });\n\n    delete this._formFields[ id ];\n  }\n\n  get(id) {\n    return this._formFields[ id ];\n  }\n\n  getAll() {\n    return Object.values(this._formFields);\n  }\n\n  getForm() {\n    return this.getAll().find((formField) => formField.type === 'default');\n  }\n\n  forEach(callback) {\n    this.getAll().forEach((formField) => callback(formField));\n  }\n\n  clear() {\n    this._formFields = {};\n\n    this._ids.clear();\n  }\n\n}\n\nFormFieldRegistry.$inject = [ 'eventBus' ];","import { render } from 'preact';\nimport { useCallback, useState } from 'preact/hooks';\n\nimport { FormComponent } from './components/FormComponent';\nimport { FormContext } from './context';\n\n/**\n * @typedef { { container } } Config\n * @typedef { import('didi').Injector } Injector\n * @typedef { import('../core/EventBus').EventBus } EventBus\n * @typedef { import('../Form').Form } Form\n */\n\n/**\n * @param {Config} config\n * @param {EventBus} eventBus\n * @param {Form} form\n * @param {Injector} injector\n */\nexport function Renderer(config, eventBus, form, injector) {\n\n  const App = () => {\n    const [ state, setState ] = useState(form._getState());\n\n    const formContext = {\n      getService(type, strict = true) {\n        return injector.get(type, strict);\n      },\n      formId: form._id\n    };\n\n    eventBus.on('changed', (newState) => {\n      setState(newState);\n    });\n\n    const onChange = useCallback((update) => form._update(update), []);\n\n    const { properties } = state;\n\n    const { readOnly } = properties;\n\n    const onSubmit = useCallback(() => {\n      if (!readOnly) {\n        form.submit();\n      }\n    }, [ readOnly ]);\n\n    const onReset = useCallback(() => form.reset(), []);\n\n    const { schema } = state;\n\n    if (!schema) {\n      return null;\n    }\n\n    return (\n      <FormContext.Provider value={ formContext }>\n        <FormComponent\n          onChange={ onChange }\n          onSubmit={ onSubmit }\n          onReset={ onReset } />\n      </FormContext.Provider>\n    );\n  };\n\n  const { container } = config;\n\n  eventBus.on('form.init', () => {\n    render(<App />, container);\n  });\n\n  eventBus.on('form.destroy', () => {\n    render(null, container);\n  });\n}\n\nRenderer.$inject = [ 'config.renderer', 'eventBus', 'form', 'injector' ];","import { FormFields } from './FormFields';\nimport { Renderer } from './Renderer';\n\nexport { FormFields };\n\nexport * from './components';\nexport * from './context';\nexport {\n  useExpressionEvaluation,\n  useSingleLineTemplateEvaluation,\n  useTemplateEvaluation\n} from './hooks';\n\nexport const RenderModule = {\n  __init__: [ 'formFields', 'renderer' ],\n  formFields: [ 'type', FormFields ],\n  renderer: [ 'type', Renderer ]\n};","import { EventBus } from './EventBus';\nimport { Validator } from './Validator';\nimport { Importer } from './Importer';\nimport { FieldFactory } from './FieldFactory';\nimport { PathRegistry } from './PathRegistry';\nimport { FormLayouter } from './FormLayouter';\nimport { FormFieldRegistry } from './FormFieldRegistry';\n\nimport { RenderModule } from '../render';\n\nexport { Importer, FieldFactory, FormFieldRegistry, PathRegistry, FormLayouter };\n\nexport const CoreModule = {\n  __depends__: [ RenderModule ],\n  eventBus: [ 'type', EventBus ],\n  importer: [ 'type', Importer ],\n  fieldFactory: [ 'type', FieldFactory ],\n  formFieldRegistry: [ 'type', FormFieldRegistry ],\n  pathRegistry: [ 'type', PathRegistry ],\n  formLayouter: [ 'type', FormLayouter ],\n  validator: [ 'type', Validator ]\n};","import Ids from 'ids';\nimport { get, isObject, isString, isUndefined, set } from 'min-dash';\n\nimport {\n  ExpressionLanguageModule,\n  MarkdownRendererModule,\n  ViewerCommandsModule,\n  RepeatRenderModule\n} from './features';\n\nimport { CoreModule } from './core';\n\nimport { clone, createFormContainer, createInjector } from './util';\n\n/**\n * @typedef { import('./types').Injector } Injector\n * @typedef { import('./types').Data } Data\n * @typedef { import('./types').Errors } Errors\n * @typedef { import('./types').Schema } Schema\n * @typedef { import('./types').FormProperties } FormProperties\n * @typedef { import('./types').FormProperty } FormProperty\n * @typedef { import('./types').FormEvent } FormEvent\n * @typedef { import('./types').FormOptions } FormOptions\n *\n * @typedef { {\n *   data: Data,\n *   initialData: Data,\n *   errors: Errors,\n *   properties: FormProperties,\n *   schema: Schema\n * } } State\n *\n * @typedef { (type:FormEvent, priority:number, handler:Function) => void } OnEventWithPriority\n * @typedef { (type:FormEvent, handler:Function) => void } OnEventWithOutPriority\n * @typedef { OnEventWithPriority & OnEventWithOutPriority } OnEventType\n */\n\nconst ids = new Ids([ 32, 36, 1 ]);\n\n/**\n * The form.\n */\nexport class Form {\n\n  /**\n   * @constructor\n   * @param {FormOptions} options\n   */\n  constructor(options = {}) {\n\n    /**\n     * @public\n     * @type {OnEventType}\n     */\n    this.on = this._onEvent;\n\n    /**\n     * @public\n     * @type {String}\n     */\n    this._id = ids.next();\n\n    /**\n     * @private\n     * @type {Element}\n     */\n    this._container = createFormContainer();\n\n    const {\n      container,\n      injector = this._createInjector(options, this._container),\n      properties = {}\n    } = options;\n\n    /**\n     * @private\n     * @type {State}\n     */\n    this._state = {\n      initialData: null,\n      data: null,\n      properties,\n      errors: {},\n      schema: null\n    };\n\n    this.get = injector.get;\n\n    this.invoke = injector.invoke;\n\n    this.get('eventBus').fire('form.init');\n\n    if (container) {\n      this.attachTo(container);\n    }\n  }\n\n  clear() {\n\n    // clear diagram services (e.g. EventBus)\n    this._emit('diagram.clear');\n\n    // clear form services\n    this._emit('form.clear');\n  }\n\n  /**\n   * Destroy the form, removing it from DOM,\n   * if attached.\n   */\n  destroy() {\n\n    // destroy form services\n    this.get('eventBus').fire('form.destroy');\n\n    // destroy diagram services (e.g. EventBus)\n    this.get('eventBus').fire('diagram.destroy');\n\n    this._detach(false);\n  }\n\n  /**\n   * Open a form schema with the given initial data.\n   *\n   * @param {Schema} schema\n   * @param {Data} [data]\n   *\n   * @return Promise<{ warnings: Array<any> }>\n   */\n  importSchema(schema, data = {}) {\n    return new Promise((resolve, reject) => {\n      try {\n        this.clear();\n\n        const {\n          schema: importedSchema,\n          warnings\n        } = this.get('importer').importSchema(schema);\n\n        const initializedData = this._getInitializedFieldData(clone(data));\n\n        this._setState({\n          data: initializedData,\n          errors: {},\n          schema: importedSchema,\n          initialData: clone(initializedData)\n        });\n\n        this._emit('import.done', { warnings });\n\n        return resolve({ warnings });\n      } catch (error) {\n        this._emit('import.done', {\n          error,\n          warnings: error.warnings || []\n        });\n\n        return reject(error);\n      }\n    });\n  }\n\n  /**\n   * Submit the form, triggering all field validations.\n   *\n   * @returns { { data: Data, errors: Errors } }\n   */\n  submit() {\n\n    const {\n      properties\n    } = this._getState();\n\n    if (properties.readOnly || properties.disabled) {\n      throw new Error('form is read-only');\n    }\n\n    const data = this._getSubmitData();\n\n    const errors = this.validate();\n\n    const result = {\n      data,\n      errors\n    };\n\n    this._emit('submit', result);\n\n    return result;\n  }\n\n  reset() {\n    this._emit('reset');\n\n    this._setState({\n      data: clone(this._state.initialData),\n      errors: {}\n    });\n  }\n\n  /**\n   * @returns {Errors}\n   */\n  validate() {\n    const formFields = this.get('formFields'),\n          formFieldRegistry = this.get('formFieldRegistry'),\n          pathRegistry = this.get('pathRegistry'),\n          validator = this.get('validator');\n\n    const { data } = this._getState();\n\n    const getErrorPath = (field, indexes) => [ field.id, ...Object.values(indexes || {}) ];\n\n    function validateFieldRecursively(errors, field, indexes) {\n      const { disabled, type, isRepeating } = field;\n      const { config: fieldConfig } = formFields.get(type);\n\n      // (1) Skip disabled fields\n      if (disabled) {\n        return;\n      }\n\n      // (2) Validate the field\n      const valuePath = pathRegistry.getValuePath(field, { indexes });\n      const valueData = get(data, valuePath);\n      const fieldErrors = validator.validateField(field, valueData);\n\n      if (fieldErrors.length) {\n        set(errors, getErrorPath(field, indexes), fieldErrors);\n      }\n\n      // (3) Process parents\n      if (!Array.isArray(field.components)) {\n        return;\n      }\n\n      // (4a) Recurse repeatable parents both across the indexes of repetition and the children\n      if (fieldConfig.repeatable && isRepeating) {\n\n        if (!Array.isArray(valueData)) {\n          return;\n        }\n\n        valueData.forEach((_, index) => {\n          field.components.forEach((component) => {\n            validateFieldRecursively(errors, component, { ...indexes, [field.id]: index });\n          });\n        });\n\n        return;\n      }\n\n      // (4b) Recurse non-repeatable parents only across the children\n      field.components.forEach((component) => validateFieldRecursively(errors, component, indexes));\n    }\n\n    const workingErrors = {};\n    validateFieldRecursively(workingErrors, formFieldRegistry.getForm());\n    const filteredErrors = this._applyConditions(workingErrors, data, { getFilterPath: getErrorPath, leafNodeDeletionOnly: true });\n    this._setState({ errors: filteredErrors });\n\n    return filteredErrors;\n  }\n\n  /**\n   * @param {Element|string} parentNode\n   */\n  attachTo(parentNode) {\n    if (!parentNode) {\n      throw new Error('parentNode required');\n    }\n\n    this.detach();\n\n    if (isString(parentNode)) {\n      parentNode = document.querySelector(parentNode);\n    }\n\n    const container = this._container;\n\n    parentNode.appendChild(container);\n\n    this._emit('attach');\n  }\n\n  detach() {\n    this._detach();\n  }\n\n  /**\n   * @private\n   *\n   * @param {boolean} [emit]\n   */\n  _detach(emit = true) {\n    const container = this._container,\n          parentNode = container.parentNode;\n\n    if (!parentNode) {\n      return;\n    }\n\n    if (emit) {\n      this._emit('detach');\n    }\n\n    parentNode.removeChild(container);\n  }\n\n  /**\n   * @param {FormProperty} property\n   * @param {any} value\n   */\n  setProperty(property, value) {\n    const properties = set(this._getState().properties, [ property ], value);\n\n    this._setState({ properties });\n  }\n\n  /**\n   * @param {FormEvent} type\n   * @param {Function} handler\n   */\n  off(type, handler) {\n    this.get('eventBus').off(type, handler);\n  }\n\n  /**\n   * @private\n   *\n   * @param {FormOptions} options\n   * @param {Element} container\n   *\n   * @returns {Injector}\n   */\n  _createInjector(options, container) {\n    const {\n      modules = this._getModules(),\n      additionalModules = [],\n      ...config\n    } = options;\n\n    const enrichedConfig = {\n      ...config,\n      renderer: {\n        container\n      }\n    };\n\n    return createInjector([\n      { config: [ 'value', enrichedConfig ] },\n      { form: [ 'value', this ] },\n      CoreModule,\n      ...modules,\n      ...additionalModules\n    ]);\n  }\n\n  /**\n   * @private\n   */\n  _emit(type, data) {\n    this.get('eventBus').fire(type, data);\n  }\n\n  /**\n   * @internal\n   *\n   * @param { { add?: boolean, field: any, indexes: object, remove?: number, value?: any } } update\n   */\n  _update(update) {\n    const {\n      field,\n      indexes,\n      value\n    } = update;\n\n    const {\n      data,\n      errors\n    } = this._getState();\n\n    const validator = this.get('validator'),\n          pathRegistry = this.get('pathRegistry');\n\n    const fieldErrors = validator.validateField(field, value);\n\n    const valuePath = pathRegistry.getValuePath(field, { indexes });\n\n    set(data, valuePath, value);\n\n    set(errors, [ field.id, ...Object.values(indexes || {}) ], fieldErrors.length ? fieldErrors : undefined);\n\n    this._setState({\n      data: clone(data),\n      errors: clone(errors)\n    });\n  }\n\n  /**\n   * @internal\n   */\n  _getState() {\n    return this._state;\n  }\n\n  /**\n   * @internal\n   */\n  _setState(state) {\n    this._state = {\n      ...this._state,\n      ...state\n    };\n\n    this._emit('changed', this._getState());\n  }\n\n  /**\n * @internal\n */\n  _getModules() {\n    return [\n      ExpressionLanguageModule,\n      MarkdownRendererModule,\n      ViewerCommandsModule,\n      RepeatRenderModule\n    ];\n  }\n\n  /**\n   * @internal\n   */\n  _onEvent(type, priority, handler) {\n    this.get('eventBus').on(type, priority, handler);\n  }\n\n  /**\n   * @internal\n   */\n  _getSubmitData() {\n    const formFieldRegistry = this.get('formFieldRegistry');\n    const formFields = this.get('formFields');\n    const pathRegistry = this.get('pathRegistry');\n    const formData = this._getState().data;\n\n    function collectSubmitDataRecursively(submitData, formField, indexes) {\n      const { disabled, type } = formField;\n      const { config: fieldConfig } = formFields.get(type);\n\n      // (1) Process keyed fields\n      if (!disabled && fieldConfig.keyed) {\n        const valuePath = pathRegistry.getValuePath(formField, { indexes });\n        const value = get(formData, valuePath);\n        set(submitData, valuePath, value);\n      }\n\n      // (2) Process parents\n      if (!Array.isArray(formField.components)) {\n        return;\n      }\n\n      // (3a) Recurse repeatable parents both across the indexes of repetition and the children\n      if (fieldConfig.repeatable && formField.isRepeating) {\n\n        const valueData = get(formData, pathRegistry.getValuePath(formField, { indexes }));\n\n        if (!Array.isArray(valueData)) {\n          return;\n        }\n\n        valueData.forEach((_, index) => {\n          formField.components.forEach((component) => {\n            collectSubmitDataRecursively(submitData, component, { ...indexes, [formField.id]: index });\n          });\n        });\n\n        return;\n      }\n\n      // (3b) Recurse non-repeatable parents only across the children\n      formField.components.forEach((component) => collectSubmitDataRecursively(submitData, component, indexes));\n    }\n\n    const workingSubmitData = {};\n    collectSubmitDataRecursively(workingSubmitData, formFieldRegistry.getForm(), {});\n    return this._applyConditions(workingSubmitData, formData);\n  }\n\n  /**\n   * @internal\n   */\n  _applyConditions(toFilter, data, options = {}) {\n    const conditionChecker = this.get('conditionChecker');\n    return conditionChecker.applyConditions(toFilter, data, options);\n  }\n\n  /**\n   * @internal\n   */\n  _getInitializedFieldData(data, options = {}) {\n    const formFieldRegistry = this.get('formFieldRegistry');\n    const formFields = this.get('formFields');\n    const pathRegistry = this.get('pathRegistry');\n\n    function initializeFieldDataRecursively(initializedData, formField, indexes) {\n      const { defaultValue, type, isRepeating } = formField;\n      const { config: fieldConfig } = formFields.get(type);\n\n      const valuePath = pathRegistry.getValuePath(formField, { indexes });\n      let valueData = get(data, valuePath);\n\n      // (1) Process keyed fields\n      if (fieldConfig.keyed) {\n\n        // (a) Retrieve and sanitize data from input\n        if (!isUndefined(valueData) && fieldConfig.sanitizeValue) {\n          valueData = fieldConfig.sanitizeValue({ formField, data, value: valueData });\n        }\n\n        // (b) Initialize field value in output data\n        const initializedFieldValue = !isUndefined(valueData) ? valueData : (!isUndefined(defaultValue) ? defaultValue : fieldConfig.emptyValue);\n        set(initializedData, valuePath, initializedFieldValue);\n      }\n\n      // (2) Process parents\n      if (!Array.isArray(formField.components)) {\n        return;\n      }\n\n      if (fieldConfig.repeatable && isRepeating) {\n\n        // (a) Sanitize repeatable parents data if it is not an array\n        if (!valueData || !Array.isArray(valueData)) {\n          valueData = new Array(isUndefined(formField.defaultRepetitions) ? 1 : formField.defaultRepetitions).fill().map(_ => ({})) || [];\n        }\n\n        // (b) Ensure all elements of the array are objects\n        valueData = valueData.map((val) => isObject(val) ? val : {});\n\n        // (c) Initialize field value in output data\n        set(initializedData, valuePath, valueData);\n\n        // (d) If indexed ahead of time, recurse repeatable simply across the children\n        if (!isUndefined(indexes[formField.id])) {\n          formField.components.forEach(\n            (component) => initializeFieldDataRecursively(initializedData, component, { ...indexes })\n          );\n\n          return;\n        }\n\n        // (e1) Recurse repeatable parents both across the indexes of repetition and the children\n        valueData.forEach((_, index) => {\n          formField.components.forEach(\n            (component) => initializeFieldDataRecursively(initializedData, component, { ...indexes, [formField.id]: index })\n          );\n        });\n\n        return;\n      }\n\n      // (e2) Recurse non-repeatable parents only across the children\n      formField.components.forEach((component) => initializeFieldDataRecursively(initializedData, component, indexes));\n    }\n\n    // allows definition of a specific subfield to generate the data for\n    const container = options.container || formFieldRegistry.getForm();\n    const indexes = options.indexes || {};\n    const basePath = pathRegistry.getValuePath(container, { indexes }) || [];\n\n    // if indexing ahead of time, we must add this index to the data path at the end\n    const path = !isUndefined(indexes[container.id]) ? [ ...basePath, indexes[container.id] ] : basePath;\n\n    const workingData = clone(data);\n    initializeFieldDataRecursively(workingData, container, indexes);\n    return get(workingData, path, {});\n  }\n\n}\n","import { Form } from './Form';\r\n\r\nexport { FormFieldRegistry, FormLayouter, Importer, FieldFactory, PathRegistry } from './core';\r\nexport * from './render';\r\nexport * from './util';\r\nexport * from './features';\r\n\r\nconst schemaVersion = 15;\r\n\r\nexport {\r\n  Form,\r\n  schemaVersion\r\n};\r\n\r\n/**\r\n * @typedef { import('./types').CreateFormOptions } CreateFormOptions\r\n */\r\n\r\n/**\r\n * Create a form.\r\n *\r\n * @param {CreateFormOptions} options\r\n *\r\n * @return {Promise<Form>}\r\n */\r\nexport function createForm(options) {\r\n  const {\r\n    data,\r\n    schema,\r\n    ...formOptions\r\n  } = options;\r\n\r\n  const form = new Form(formOptions);\r\n\r\n  return form.importSchema(schema, data).then(function() {\r\n    return form;\r\n  });\r\n}"],"mappings":"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AAS,CAAC,QAAQ,CAAC;AAErB,MAAMC,gBAAgB,CAAC;EAE5BlmC,WAAWA,CAAA,EAAG;IACZ,IAAI,CAACmmC,UAAU,GAAG,IAAIH,QAAQ,CAACI,SAAS,EAAE;EAC5C;;EAEA;AACF;AACA;AACA;AACA;AACA;AACA;EACErL,MAAMA,CAACD,QAAQ,EAAE;IACf,OAAO,IAAI,CAACqL,UAAU,CAACE,QAAQ,CAACvL,QAAQ,CAAC;EAC3C;AACF;AAEAoL,gBAAgB,CAACplC,OAAO,GAAG,EAAE;ACrBtB,MAAMwlC,sBAAsB,GAAG;EACpCP,QAAQ,EAAE,CAAE,kBAAkB,CAAE;EAChClL,gBAAgB,EAAE,CAAE,MAAM,EAAEqL,gBAAgB;AAC9C;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACe,SAASK,YAAYA,CAACtmC,QAAQ,EAAE+E,QAAQ,EAAE;EAEvD;AACF;AACA;AACA;AACA;EACE,IAAI,CAACwhC,WAAW,GAAG,EAAE;;EAErB;AACF;AACA;AACA;AACA;EACE,IAAI,CAACC,MAAM,GAAG,EAAE;;EAEhB;AACF;AACA;AACA;AACA;EACE,IAAI,CAACC,SAAS,GAAG,CAAC,CAAC;;EAEnB;AACF;AACA;AACA;AACA;EACE,IAAI,CAACC,iBAAi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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}